<UserControl x:Class="GuessMyMessClient.View.Lobby.FriendsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:GuessMyMessClient.View.Lobby"
             mc:Ignorable="d"
             xmlns:language="clr-namespace:GuessMyMessClient.Properties.Langs"
             xmlns:vm="clr-namespace:GuessMyMessClient.ViewModel.Lobby"
             d:DataContext="{d:DesignInstance Type=vm:FriendsViewModel, IsDesignTimeCreatable=True}"
             d:DesignHeight="500" d:DesignWidth="350">

    <UserControl.Resources>

        <Style x:Key="CartoonTabItem" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid Margin="0,0,5,0" VerticalAlignment="Bottom">
                            <Border x:Name="Shadow" CornerRadius="15" Background="#FFA000" Margin="0,3,0,0" Opacity="0.8" Visibility="Collapsed"/>
                            <Border x:Name="Border" Background="#F5F5F5" BorderBrush="#CFD8DC" BorderThickness="2" CornerRadius="15" Padding="15,8" Margin="0,3,0,0">
                                <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header" TextElement.FontFamily="Arial Rounded MT Bold" TextElement.FontSize="14" TextElement.FontWeight="Bold"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#FFFDE7"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#FFC107"/>
                                <Setter Property="Foreground" Value="#FF424242"/>
                                <Setter TargetName="Border" Property="Margin" Value="0,0,0,3"/>
                                <Setter TargetName="Shadow" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="False">
                                <Setter TargetName="Border" Property="Background" Value="#EEEEEE"/>
                                <Setter Property="Foreground" Value="Gray"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SmallGreenButton" TargetType="Button">
            <Setter Property="Background" Value="#FF2ECC71"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Arial Rounded MT Bold"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid RenderTransformOrigin="0.5,0.5">
                            <Border x:Name="shadow" CornerRadius="10" Background="#FF219150" Margin="0,3,0,0"/>
                            <Border x:Name="face" CornerRadius="10" Background="{TemplateBinding Background}" Margin="0,0,0,3">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="8,0"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="face" Property="Background" Value="#FF40D47E"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="face" Property="Margin" Value="0,3,0,0"/>
                                <Setter TargetName="shadow" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SmallRedButton" TargetType="Button">
            <Setter Property="Background" Value="#FFEF5350"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Arial Rounded MT Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid RenderTransformOrigin="0.5,0.5">
                            <Border x:Name="shadow" CornerRadius="10" Background="#C62828" Margin="0,3,0,0"/>
                            <Border x:Name="face" CornerRadius="10" Background="{TemplateBinding Background}" Margin="0,0,0,3">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="8,0"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="face" Property="Background" Value="#FFFF867C"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="face" Property="Margin" Value="0,3,0,0"/>
                                <Setter TargetName="shadow" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="InviteButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FFFFC107"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Arial Rounded MT Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="45"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid RenderTransformOrigin="0.5,0.5">
                            <Border x:Name="shadow" CornerRadius="12" Background="#FFA000" Margin="0,4,0,0"/>
                            <Border x:Name="face" CornerRadius="12" Background="{TemplateBinding Background}" Margin="0,0,0,4">
                                <Viewbox Stretch="Uniform" Margin="15,5">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Viewbox>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="face" Property="Background" Value="#FFFFD54F"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="face" Property="Margin" Value="0,4,0,0"/>
                                <Setter TargetName="shadow" Property="Visibility" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </UserControl.Resources>

    <Border Background="White" BorderBrush="#FF42A5F5" BorderThickness="3" CornerRadius="20" Padding="15">
        <Border.Effect>
            <DropShadowEffect ShadowDepth="5" Color="Black" Opacity="0.4" BlurRadius="20"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" VerticalAlignment="Top" Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox Grid.Column="0" Style="{StaticResource SearchTextBoxStyle}"
                         Tag="{x:Static language:Lang.socialTfSearchPlayers}"
                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Grid.Column="1" Style="{StaticResource BlueIconButton}" 
                        Command="{Binding SearchCommand}" ToolTip="{x:Static language:Lang.socialBtnSearch}">
                    <Image Source="/Resources/Images/search.png" Height="20" RenderOptions.BitmapScalingMode="HighQuality"/>
                </Button>
            </Grid>

            <ListBox Grid.Row="1" ItemsSource="{Binding SearchResults}" 
                     Margin="0,0,0,10" BorderThickness="0" Background="Transparent"
                     MaxHeight="120"
                     HorizontalContentAlignment="Stretch"
                     Visibility="{Binding SearchResults.Count, Converter={StaticResource CountToVisibilityConverter}}">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border Background="#F5F5F5" CornerRadius="10" Padding="8" Margin="0,2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{Binding Username}" VerticalAlignment="Center" FontFamily="Arial Rounded MT Bold" FontWeight="Bold" Foreground="#555"/>
                                <Button Grid.Column="1" Content="{x:Static language:Lang.socialBtnAddFriend}" 
                                        Style="{StaticResource SmallGreenButton}" Width="80"
                                        Command="{Binding DataContext.SendFriendRequestCommand, RelativeSource={RelativeSource AncestorType=ListBox}}"
                                        CommandParameter="{Binding}"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <TabControl Grid.Row="2" BorderThickness="0" Background="Transparent" Margin="0,5,0,0">
                <TabItem Header="{x:Static language:Lang.socialLbFriends}" Style="{StaticResource CartoonTabItem}">
                    <ListBox ItemsSource="{Binding Friends}" BorderThickness="0" Background="Transparent" Margin="0,10,0,0" HorizontalContentAlignment="Stretch">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#FAFAFA" BorderBrush="#EEEEEE" BorderThickness="1" CornerRadius="12" Padding="10" Margin="0,3">
                                    <StackPanel Orientation="Horizontal">
                                        <Border Width="14" Height="14" CornerRadius="7" 
                                                Background="{Binding IsOnline, Converter={StaticResource BoolToGreenRedConverter}}"
                                                BorderBrush="White" BorderThickness="2">
                                            <Border.Effect>
                                                <DropShadowEffect ShadowDepth="0" Color="Gray" Opacity="0.3" BlurRadius="3"/>
                                            </Border.Effect>
                                        </Border>
                                        <TextBlock Text="{Binding Username}" Margin="10,0,0,0" VerticalAlignment="Center" FontFamily="Arial Rounded MT Bold" FontSize="14" Foreground="#333"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </TabItem>

                <TabItem Header="{x:Static language:Lang.socialLbRequests}" Style="{StaticResource CartoonTabItem}">
                    <ListBox ItemsSource="{Binding FriendRequests}" BorderThickness="0" Background="Transparent" Margin="0,10,0,0" HorizontalContentAlignment="Stretch">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#E3F2FD" CornerRadius="12" Padding="10" Margin="0,3">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="{Binding RequesterUsername}" VerticalAlignment="Center" FontFamily="Arial Rounded MT Bold" FontWeight="Bold" Foreground="#1565C0"/>
                                        <Button Grid.Column="1" Content="✔" ToolTip="Accept" FontSize="14" Style="{StaticResource SmallGreenButton}" Width="40" Command="{Binding AcceptCommand}" Margin="5,0"/>
                                        <Button Grid.Column="2" Content="✕" ToolTip="Decline" FontSize="12" Style="{StaticResource SmallRedButton}" Width="40" Command="{Binding DeclineCommand}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </TabItem>
            </TabControl>

            <Button Grid.Row="3" Style="{StaticResource InviteButtonStyle}" 
                    Command="{Binding InviteByEmailCommand}" 
                    VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Margin="0,10,0,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Image Source="/Resources/Images/mail.png" Height="20" Margin="0,0,10,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                    <TextBlock Text="{x:Static language:Lang.socialBtnEmailInivite}" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
        </Grid>
    </Border>
</UserControl>