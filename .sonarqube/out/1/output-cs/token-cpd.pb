⁄
íC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\Properties\AssemblyInfo.cs
[

 
assembly

 	
:

	 

AssemblyTitle

 
(

 
$str

 ,
)

, -
]

- .
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
]" #
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str .
). /
]/ 0
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
["" 
assembly"" 	
:""	 

	ThemeInfo"" 
("" &
ResourceDictionaryLocation## 
.## 
None## #
,### $&
ResourceDictionaryLocation&& 
.&& 
SourceAssembly&& -
))) 
])) 
[33 
assembly33 	
:33	 

AssemblyVersion33 
(33 
$str33 $
)33$ %
]33% &
[44 
assembly44 	
:44	 

AssemblyFileVersion44 
(44 
$str44 (
)44( )
]44) *Ö
´C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\WaitingRoom\WaitingRoomPublicMatchView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
WaitingRoom! ,
{ 
public 

partial 
class &
WaitingRoomPublicMatchView 3
:4 5
Window6 <
{ 
public &
WaitingRoomPublicMatchView )
() *
)* +
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
Closed 
+= 
WaitingRoom_Closed -
;- .
} 	
private 
void 
WaitingRoom_Closed '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
if   
(   
this   
.   
DataContext    
is  ! #$
WaitingRoomViewModelBase  $ <
vm  = ?
)  ? @
{!! 
vm"" 
."" 
CleanUp"" 
("" 
)"" 
;"" 
}## 
this$$ 
.$$ 
Closed$$ 
-=$$ 
WaitingRoom_Closed$$ -
;$$- .
}%% 	
private'' 
void'' 
Button_Click'' !
(''! "
object''" (
sender'') /
,''/ 0
RoutedEventArgs''1 @
e''A B
)''B C
{(( 	
}** 	
}++ 
},, ±
ØC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\WaitingRoom\WaitingRoomPublicMatchHostView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
WaitingRoom! ,
{ 
public 

partial 
class *
WaitingRoomPublicMatchHostView 7
:8 9
Window: @
{ 
public *
WaitingRoomPublicMatchHostView -
(- .
). /
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
Closed 
+= 
WaitingRoom_Closed -
;- .
} 	
private 
void 
WaitingRoom_Closed '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
if   
(   
this   
.   
DataContext    
is  ! #$
WaitingRoomViewModelBase  $ <
vm  = ?
)  ? @
{!! 
vm"" 
."" 
CleanUp"" 
("" 
)"" 
;"" 
}## 
this$$ 
.$$ 
Closed$$ 
-=$$ 
WaitingRoom_Closed$$ -
;$$- .
}%% 	
}&& 
}'' ®
¨C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\WaitingRoom\WaitingRoomPrivateMatchView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
WaitingRoom! ,
{ 
public 

partial 
class '
WaitingRoomPrivateMatchView 4
:5 6
Window7 =
{ 
public '
WaitingRoomPrivateMatchView *
(* +
)+ ,
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
Closed 
+= 
WaitingRoom_Closed -
;- .
} 	
private 
void 
WaitingRoom_Closed '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
if   
(   
this   
.   
DataContext    
is  ! #$
WaitingRoomViewModelBase  $ <
vm  = ?
)  ? @
{!! 
vm"" 
."" 
CleanUp"" 
("" 
)"" 
;"" 
}## 
this$$ 
.$$ 
Closed$$ 
-=$$ 
WaitingRoom_Closed$$ -
;$$- .
}%% 	
}&& 
}'' ¥
∞C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\WaitingRoom\WaitingRoomPrivateMatchHostView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
WaitingRoom! ,
{ 
public 

partial 
class +
WaitingRoomPrivateMatchHostView 8
:9 :
Window; A
{ 
public +
WaitingRoomPrivateMatchHostView .
(. /
)/ 0
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
Closed 
+= 
WaitingRoom_Closed -
;- .
} 	
private 
void 
WaitingRoom_Closed '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
if   
(   
this   
.   
DataContext    
is  ! #$
WaitingRoomViewModelBase  $ <
vm  = ?
)  ? @
{!! 
vm"" 
."" 
CleanUp"" 
("" 
)"" 
;"" 
}## 
this$$ 
.$$ 
Closed$$ 
-=$$ 
WaitingRoom_Closed$$ -
;$$- .
}%% 	
}&& 
}'' ¥
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Match\WordSelectionView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Match! &
{ 
public 

partial 
class 
WordSelectionView *
:+ ,
Window- 3
{ 
public 
WordSelectionView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new ""
WordSelectionViewModel# 9
(9 :
): ;
;; <
} 	
} 
} ï
†C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Match\WaitingForGuessesView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Match! &
{ 
public 

partial 
class !
WaitingForGuessesView .
:/ 0
Window1 7
{ 
public !
WaitingForGuessesView $
($ %
)% &
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} Ú
õC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Match\GuessTheWordView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Match! &
{ 
public 

partial 
class 
GuessTheWordView )
:* +
Window, 2
{ 
public 
GuessTheWordView 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
TextBox_TextChanged (
(( )
object) /
sender0 6
,6 7 
TextChangedEventArgs8 L
eM N
)N O
{ 	
} 	
}   
}!! ®
ôC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Match\EndOfMatchView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Match! &
{ 
public 

partial 
class 
EndOfMatchView '
:( )
Window* 0
{ 
public 
EndOfMatchView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "
EndOfMatchViewModel# 6
(6 7
)7 8
;8 9
} 	
} 
} â
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Match\DrawingScreenView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Match! &
{ 
public 

partial 
class 
DrawingScreenView *
:+ ,
Window- 3
{ 
public 
DrawingScreenView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} â
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Match\AnswersScreenView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Match! &
{ 
public 

partial 
class 
AnswersScreenView *
:+ ,
Window- 3
{ 
public 
AnswersScreenView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} ƒ
§C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\MatchSettings\MatchSettingsView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
MatchSettings! .
{ 
public 

partial 
class 
MatchSettingsView *
:+ ,
Window- 3
{ 
public 
MatchSettingsView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new ""
MatchSettingsViewModel# 9
(9 :
): ;
;; <
} 	
} 
} ˚
òC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Matches\MatchesView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Matches! (
{ 
public 

partial 
class 
MatchesView $
:% &
Window' -
{ 
public 
MatchesView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} ¢
ÉC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\App.xaml.cs
	namespace 	
GuessMyMessClient
 
{		 
public

 

partial

 
class

 
App

 
:

 
Application

 *
{ 
public 
App 
( 
) 
{ 	
Log 
. 
Logger 
= 
new 
LoggerConfiguration 0
(0 1
)1 2
. 
MinimumLevel 
. 
Debug #
(# $
)$ %
. 
WriteTo 
. 
File 
( 
$str 4
,4 5
rollingInterval #
:# $
RollingInterval% 4
.4 5
Day5 8
,8 9
outputTemplate "
:" #
$str$ w
)w x
. 
CreateLogger 
( 
) 
;  
Log 
. 
Information 
( 
$str A
)A B
;B C
this 
. (
DispatcherUnhandledException -
+=. 0,
 App_DispatcherUnhandledException1 Q
;Q R
} 	
	protected 
override 
void 
	OnStartup  )
() *
StartupEventArgs* :
e; <
)< =
{ 	
CultureInfo 
cultureInfo #
=$ %
new& )
CultureInfo* 5
(5 6
$str6 =
)= >
;> ?
Thread 
. 
CurrentThread  
.  !
CurrentUICulture! 1
=2 3
cultureInfo4 ?
;? @
Thread 
. 
CurrentThread  
.  !
CurrentCulture! /
=0 1
cultureInfo2 =
;= >
base   
.   
	OnStartup   
(   
e   
)   
;   
ServiceLocator!! 
.!! 

Navigation!! %
=!!& '
new!!( + 
WpfNavigationService!!, @
(!!@ A
)!!A B
;!!B C
}"" 	
private$$ 
void$$ ,
 App_DispatcherUnhandledException$$ 5
($$5 6
object$$6 <
sender$$= C
,$$C D
System$$E K
.$$K L
Windows$$L S
.$$S T
	Threading$$T ]
.$$] ^2
%DispatcherUnhandledExceptionEventArgs	$$^ É
e
$$Ñ Ö
)
$$Ö Ü
{%% 	
Log&& 
.&& 
Fatal&& 
(&& 
e&& 
.&& 
	Exception&& !
,&&! "
$str&&# R
)&&R S
;&&S T
e'' 
.'' 
Handled'' 
='' 
true'' 
;'' 
Log)) 
.)) 
CloseAndFlush)) 
()) 
))) 
;))  
Current** 
.** 
Shutdown** 
(** 
)** 
;** 
}++ 	
	protected-- 
override-- 
void-- 
OnExit--  &
(--& '
ExitEventArgs--' 4
e--5 6
)--6 7
{.. 	
Log// 
.// 
Information// 
(// 
$str// :
)//: ;
;//; <
Log00 
.00 
CloseAndFlush00 
(00 
)00 
;00  
base11 
.11 
OnExit11 
(11 
e11 
)11 
;11 
}22 	
}33 
}44 à
óC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\HomePages\MainView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
	HomePages! *
{ 
public 

partial 
class 
MainView !
:" #
Window$ *
{ 
public 
MainView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "
MainViewModel# 0
(0 1
)1 2
;2 3
this 
. 
Loaded 
+= 
Main_Loaded &
;& '
} 	
private 
void 
Main_Loaded  
(  !
object! '
sender( .
,. /
RoutedEventArgs0 ?
e@ A
)A B
{ 	
this   
.   
WindowState   
=   
WindowState   *
.  * +
	Maximized  + 4
;  4 5
this!! 
.!! 
WindowStyle!! 
=!! 
WindowStyle!! *
.!!* +
None!!+ /
;!!/ 0
this"" 
."" 

ResizeMode"" 
="" 

ResizeMode"" (
.""( )
NoResize"") 1
;""1 2
}## 	
	protected$$ 
override$$ 
void$$ !
OnMouseLeftButtonDown$$  5
($$5 6 
MouseButtonEventArgs$$6 J
e$$K L
)$$L M
{%% 	
base&& 
.&& !
OnMouseLeftButtonDown&& &
(&&& '
e&&' (
)&&( )
;&&) *
if'' 
('' 
e'' 
.'' 
ButtonState'' 
==''  
MouseButtonState''! 1
.''1 2
Pressed''2 9
)''9 :
{(( 
DragMove)) 
()) 
))) 
;)) 
}** 
}++ 	
},, 
}-- ∞
õC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\SelectAvatarView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
{ 
public 

partial 
class 
SelectAvatarView )
:* +
Window, 2
{ 
public 
SelectAvatarView 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "!
SelectAvatarViewModel# 8
(8 9
)9 :
;: ;
} 	
} 
} ¯
∞C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\WaitingRoom\WaitingRoomPublicMatchViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
WaitingRoom& 1
{ 
public 

class +
WaitingRoomPublicMatchViewModel 0
:1 2$
WaitingRoomViewModelBase3 K
{ 
public +
WaitingRoomPublicMatchViewModel .
(. /
LobbyClientManager/ A
lobbyManagerB N
,N O
SessionManagerP ^
sessionManager_ m
)m n
:		 
base		 
(		 
lobbyManager		 
,		  
sessionManager		! /
)		/ 0
{

 	
} 	
} 
} ô
¥C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\WaitingRoom\WaitingRoomPublicMatchHostViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
WaitingRoom& 1
{ 
public 

class /
#WaitingRoomPublicMatchHostViewModel 4
:5 6$
WaitingRoomViewModelBase7 O
{		 
public

 
ICommand

 
StartGameCommand

 (
{

) *
get

+ .
;

. /
private

0 7
set

8 ;
;

; <
}

= >
public /
#WaitingRoomPublicMatchHostViewModel 2
(2 3
LobbyClientManager3 E
lobbyManagerF R
,R S
SessionManagerT b
sessionManagerc q
)q r
: 
base 
( 
lobbyManager 
,  
sessionManager! /
)/ 0
{ 	
} 	
	protected 
override 
void 
InitializeCommands  2
(2 3
)3 4
{ 	
base 
. 
InitializeCommands #
(# $
)$ %
;% &
StartGameCommand 
= 
new "
RelayCommand# /
(/ 0
	StartGame0 9
,9 :
CanStartGame; G
)G H
;H I
} 	
private 
bool 
CanStartGame !
(! "
object" (
	parameter) 2
)2 3
{ 	
return 
IsHost 
; 
} 	
private 
void 
	StartGame 
( 
object %
	parameter& /
)/ 0
{ 	
_lobbyManager 
. 
RequestStartGame *
(* +
)+ ,
;, -
} 	
	protected!! 
override!! 
void!! 
OnLobbyStateUpdated!!  3
(!!3 4
LobbyStateDto!!4 A
state!!B G
)!!G H
{"" 	
bool## 
wasHostBeforeUpdate## $
=##% &
this##' +
.##+ ,
IsHost##, 2
;##2 3
base%% 
.%% 
OnLobbyStateUpdated%% $
(%%$ %
state%%% *
)%%* +
;%%+ ,
if'' 
('' 
wasHostBeforeUpdate'' #
!=''$ &
this''' +
.''+ ,
IsHost'', 2
)''2 3
{(( 
Application)) 
.)) 
Current)) #
?))# $
.))$ %

Dispatcher))% /
.))/ 0
Invoke))0 6
())6 7
())7 8
)))8 9
=>)): <
{** 
CommandManager++ "
.++" #&
InvalidateRequerySuggested++# =
(++= >
)++> ?
;++? @
},, 
),, 
;,, 
}-- 
}.. 	
}// 
}00 ˚
±C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\WaitingRoom\WaitingRoomPrivateMatchViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
WaitingRoom& 1
{ 
public 

class ,
 WaitingRoomPrivateMatchViewModel 1
:2 3$
WaitingRoomViewModelBase4 L
{ 
public ,
 WaitingRoomPrivateMatchViewModel /
(/ 0
LobbyClientManager0 B
lobbyManagerC O
,O P
SessionManagerQ _
sessionManager` n
)n o
:		 
base		 
(		 
lobbyManager		 
,		  
sessionManager		! /
)		/ 0
{

 	
} 	
} 
} ú
µC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\WaitingRoom\WaitingRoomPrivateMatchHostViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
WaitingRoom& 1
{ 
public 

class 0
$WaitingRoomPrivateMatchHostViewModel 5
:6 7$
WaitingRoomViewModelBase8 P
{		 
public

 
ICommand

 
StartGameCommand

 (
{

) *
get

+ .
;

. /
private

0 7
set

8 ;
;

; <
}

= >
public 0
$WaitingRoomPrivateMatchHostViewModel 3
(3 4
LobbyClientManager4 F
lobbyManagerG S
,S T
SessionManagerU c
sessionManagerd r
)r s
: 
base 
( 
lobbyManager 
,  
sessionManager! /
)/ 0
{ 	
} 	
	protected 
override 
void 
InitializeCommands  2
(2 3
)3 4
{ 	
base 
. 
InitializeCommands #
(# $
)$ %
;% &
StartGameCommand 
= 
new "
RelayCommand# /
(/ 0
	StartGame0 9
,9 :
CanStartGame; G
)G H
;H I
} 	
private 
bool 
CanStartGame !
(! "
object" (
	parameter) 2
)2 3
{ 	
return 
IsHost 
; 
} 	
private 
void 
	StartGame 
( 
object %
	parameter& /
)/ 0
{ 	
_lobbyManager 
. 
RequestStartGame *
(* +
)+ ,
;, -
} 	
	protected!! 
override!! 
void!! 
OnLobbyStateUpdated!!  3
(!!3 4
LobbyStateDto!!4 A
state!!B G
)!!G H
{"" 	
bool## 
wasHostBeforeUpdate## $
=##% &
this##' +
.##+ ,
IsHost##, 2
;##2 3
base%% 
.%% 
OnLobbyStateUpdated%% $
(%%$ %
state%%% *
)%%* +
;%%+ ,
if'' 
('' 
wasHostBeforeUpdate'' #
!=''$ &
this''' +
.''+ ,
IsHost'', 2
)''2 3
{(( 
Application)) 
.)) 
Current)) #
?))# $
.))$ %

Dispatcher))% /
.))/ 0
Invoke))0 6
())6 7
())7 8
)))8 9
=>)): <
{** 
CommandManager++ "
.++" #&
InvalidateRequerySuggested++# =
(++= >
)++> ?
;++? @
},, 
),, 
;,, 
}-- 
}.. 	
}// 
}00 ¸
ñC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\ProfileView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
{ 
public 

partial 
class 
ProfileView $
:% &
UserControl' 2
{ 
public 
ProfileView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} ˚

îC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\LobbyView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
{ 
public 

partial 
class 
	LobbyView "
:# $
Window% +
{ 
public 
	LobbyView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "
LobbyViewModel# 1
(1 2
)2 3
;3 4
} 	
	protected 
override 
void !
OnMouseLeftButtonDown  5
(5 6 
MouseButtonEventArgs6 J
eK L
)L M
{ 	
base 
. !
OnMouseLeftButtonDown &
(& '
e' (
)( )
;) *
if   
(   
e   
.   
ButtonState   
==    
MouseButtonState  ! 1
.  1 2
Pressed  2 9
)  9 :
{!! 
DragMove"" 
("" 
)"" 
;"" 
}## 
}$$ 	
}%% 
}&& ¸
ñC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\FriendsView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
{ 
public 

partial 
class 
FriendsView $
:% &
UserControl' 2
{ 
public 
FriendsView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} é
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\DirectMessageView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
{ 
public 

partial 
class 
DirectMessageView *
:+ ,
UserControl- 8
{ 
public 
DirectMessageView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} «
™C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\Dialogs\VerifyChangesByCodeView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
.& '
Dialogs' .
{ 
public 

partial 
class #
VerifyChangesByCodeView 0
:1 2
Window3 9
{ 
public #
VerifyChangesByCodeView &
(& '
)' (
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} ô

£C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\Dialogs\VerifyByCodeView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
.& '
Dialogs' .
{ 
public 

partial 
class 
VerifyByCodeView )
:* +
Window, 2
{ 
public 
VerifyByCodeView 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
	protected 
override 
void !
OnMouseLeftButtonDown  5
(5 6 
MouseButtonEventArgs6 J
eK L
)L M
{ 	
base 
. !
OnMouseLeftButtonDown &
(& '
e' (
)( )
;) *
if   
(   
e   
.   
ButtonState   
==    
MouseButtonState  ! 1
.  1 2
Pressed  2 9
)  9 :
{!! 
DragMove"" 
("" 
)"" 
;"" 
}## 
}$$ 	
}%% 
}&& ‡
§C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\Dialogs\InviteByEmailView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
.& '
Dialogs' .
{ 
public 

partial 
class 
InviteByEmailView *
:+ ,
Window- 3
{ 
public 
InviteByEmailView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new ""
InviteByEmailViewModel# 9
(9 :
): ;
;; <
} 	
} 
} ∏
•C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\Dialogs\ChangePasswordView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
.& '
Dialogs' .
{ 
public 

partial 
class 
ChangePasswordView +
:, -
Window. 4
{ 
public 
ChangePasswordView !
(! "
)" #
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} Ø
¢C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\Dialogs\ChangeEmailView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
.& '
Dialogs' .
{ 
public 

partial 
class 
ChangeEmailView (
:) *
Window+ 1
{ 
public 
ChangeEmailView 
( 
)  
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} é
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\Lobby\ConfigurationView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
Lobby! &
{ 
public 

partial 
class 
ConfigurationView *
:+ ,
UserControl- 8
{ 
public 
ConfigurationView  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
} 
} ¢
öC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\HomePages\WelcomeView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
	HomePages! *
{ 
public 

partial 
class 
WelcomeView $
:% &
Window' -
{ 
public 
WelcomeView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "
WelcomeViewModel# 3
(3 4
)4 5
;5 6
this 
. 
Loaded 
+= 
WelcomeView_Loaded -
;- .
} 	
private 
void 
WelcomeView_Loaded '
(' (
object( .
sender/ 5
,5 6
RoutedEventArgs7 F
eG H
)H I
{ 	
this   
.   
WindowState   
=   
WindowState   *
.  * +
	Maximized  + 4
;  4 5
this!! 
.!! 
WindowStyle!! 
=!! 
WindowStyle!! *
.!!* +
None!!+ /
;!!/ 0
this"" 
."" 

ResizeMode"" 
="" 

ResizeMode"" (
.""( )
NoResize"") 1
;""1 2
}## 	
	protected&& 
override&& 
void&& !
OnMouseLeftButtonDown&&  5
(&&5 6 
MouseButtonEventArgs&&6 J
e&&K L
)&&L M
{'' 	
base(( 
.(( !
OnMouseLeftButtonDown(( &
(((& '
e((' (
)((( )
;(() *
if)) 
()) 
e)) 
.)) 
ButtonState)) 
==))  
MouseButtonState))! 1
.))1 2
Pressed))2 9
)))9 :
{** 
DragMove++ 
(++ 
)++ 
;++ 
},, 
}-- 	
}.. 
}// É
òC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\HomePages\LoginView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
	HomePages! *
{ 
public 

partial 
class 
	LoginView "
:# $
Window% +
{ 
public 
	LoginView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "
LoginViewModel# 1
(1 2
)2 3
;3 4
} 	
	protected 
override 
void !
OnMouseLeftButtonDown  5
(5 6 
MouseButtonEventArgs6 J
eK L
)L M
{ 	
base 
. !
OnMouseLeftButtonDown &
(& '
e' (
)( )
;) *
if   
(   
e   
.   
ButtonState   
==    
MouseButtonState  ! 1
.  1 2
Pressed  2 9
)  9 :
{!! 
DragMove"" 
("" 
)"" 
;"" 
}## 
}$$ 	
}%% 
}&& á
ôC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\View\HomePages\SignUpView.xaml.cs
	namespace 	
GuessMyMessClient
 
. 
View  
.  !
	HomePages! *
{ 
public 

partial 
class 

SignUpView #
:$ %
Window& ,
{ 
public 

SignUpView 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
this 
. 
DataContext 
= 
new "
SignUpViewModel# 2
(2 3
)3 4
;4 5
} 	
	protected 
override 
void !
OnMouseLeftButtonDown  5
(5 6 
MouseButtonEventArgs6 J
eK L
)L M
{ 	
base 
. !
OnMouseLeftButtonDown &
(& '
e' (
)( )
;) *
if   
(   
e   
.   
ButtonState   
==    
MouseButtonState  ! 1
.  1 2
Pressed  2 9
)  9 :
{!! 
DragMove"" 
("" 
)"" 
;"" 
}## 
}$$ 	
}%% 
}&& Ë‡
©C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\WaitingRoom\WaitingRoomViewModelBase.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
WaitingRoom& 1
{ 
public 

abstract 
class $
WaitingRoomViewModelBase 2
:3 4
ViewModelBase5 B
{ 
	protected 
readonly 
LobbyClientManager -
_lobbyManager. ;
;; <
	protected 
readonly 
SessionManager )
_sessionManager* 9
;9 :
	protected 
DispatcherTimer !
_countdownTimer" 1
;1 2
private 
int 
_isNavigatingBack %
=& '
$num( )
;) *
private 
string 

_matchName !
;! "
public 
string 
	MatchName 
{ 	
get 
=> 

_matchName 
; 
set 
=> 
SetProperty 
( 
ref "

_matchName# -
,- .
value/ 4
)4 5
;5 6
} 	
private 
string 
_hostUsername $
;$ %
public 
string 
HostUsername "
{   	
get!! 
=>!! 
_hostUsername!!  
;!!  !
set"" 
=>"" 
SetProperty"" 
("" 
ref"" "
_hostUsername""# 0
,""0 1
value""2 7
)""7 8
;""8 9
}## 	
private%% 
string%% 
_difficulty%% "
;%%" #
public&& 
string&& 

Difficulty&&  
{'' 	
get(( 
=>(( 
_difficulty(( 
;(( 
set)) 
=>)) 
SetProperty)) 
()) 
ref)) "
_difficulty))# .
,)). /
value))0 5
)))5 6
;))6 7
}** 	
private,, 
string,, 
_playerCountDisplay,, *
;,,* +
public-- 
string-- 
PlayerCountDisplay-- (
{.. 	
get// 
=>// 
_playerCountDisplay// &
;//& '
set00 
=>00 
SetProperty00 
(00 
ref00 "
_playerCountDisplay00# 6
,006 7
value008 =
)00= >
;00> ?
}11 	
private33 
string33 

_matchCode33 !
;33! "
public44 
string44 
	MatchCode44 
{55 	
get66 
=>66 

_matchCode66 
;66 
set77 
=>77 
SetProperty77 
(77 
ref77 "

_matchCode77# -
,77- .
value77/ 4
)774 5
;775 6
}88 	
private:: 

Visibility::  
_matchCodeVisibility:: /
=::0 1

Visibility::2 <
.::< =
	Collapsed::= F
;::F G
public;; 

Visibility;; 
MatchCodeVisibility;; -
{<< 	
get== 
=>==  
_matchCodeVisibility== '
;==' (
set>> 
=>>> 
SetProperty>> 
(>> 
ref>> " 
_matchCodeVisibility>># 7
,>>7 8
value>>9 >
)>>> ?
;>>? @
}?? 	
publicAA  
ObservableCollectionAA #
<AA# $
PlayerViewModelAA$ 3
>AA3 4
PlayersAA5 <
{AA= >
getAA? B
;AAB C
}AAD E
=AAF G
newAAH K 
ObservableCollectionAAL `
<AA` a
PlayerViewModelAAa p
>AAp q
(AAq r
)AAr s
;AAs t
publicBB  
ObservableCollectionBB #
<BB# $
ChatMessageDisplayBB$ 6
>BB6 7
ChatMessagesBB8 D
{BBE F
getBBG J
;BBJ K
}BBL M
=BBN O
newBBP S 
ObservableCollectionBBT h
<BBh i
ChatMessageDisplayBBi {
>BB{ |
(BB| }
)BB} ~
;BB~ 
privateDD 
intDD 
_countdownValueDD #
;DD# $
publicEE 
intEE 
CountdownValueEE !
{FF 	
getGG 
=>GG 
_countdownValueGG "
;GG" #
setHH 
=>HH 
SetPropertyHH 
(HH 
refHH "
_countdownValueHH# 2
,HH2 3
valueHH4 9
)HH9 :
;HH: ;
}II 	
privateKK 

VisibilityKK  
_countdownVisibilityKK /
=KK0 1

VisibilityKK2 <
.KK< =
	CollapsedKK= F
;KKF G
publicLL 

VisibilityLL 
CountdownVisibilityLL -
{MM 	
getNN 
=>NN  
_countdownVisibilityNN '
;NN' (
setOO 
=>OO 
SetPropertyOO 
(OO 
refOO " 
_countdownVisibilityOO# 7
,OO7 8
valueOO9 >
)OO> ?
;OO? @
}PP 	
publicRR 
boolRR 
IsHostRR 
=>RR 
_sessionManagerRR -
.RR- .
CurrentUsernameRR. =
!=RR> @
nullRRA E
&&RRF H
_sessionManagerRRI X
.RRX Y
CurrentUsernameRRY h
.RRh i
EqualsRRi o
(RRo p
HostUsernameRRp |
,RR| }
StringComparison	RR~ é
.
RRé è
OrdinalIgnoreCase
RRè †
)
RR† °
;
RR° ¢
publicTT 
ICommandTT 
LeaveCommandTT $
{TT% &
getTT' *
;TT* +
	protectedTT, 5
setTT6 9
;TT9 :
}TT; <
publicUU 
ICommandUU 
SendMessageCommandUU *
{UU+ ,
getUU- 0
;UU0 1
	protectedUU2 ;
setUU< ?
;UU? @
}UUA B
publicVV 
ICommandVV 
KickPlayerCommandVV )
{VV* +
getVV, /
;VV/ 0
	protectedVV1 :
setVV; >
;VV> ?
}VV@ A
	protectedXX $
WaitingRoomViewModelBaseXX *
(XX* +
LobbyClientManagerXX+ =
lobbyManagerXX> J
,XXJ K
SessionManagerXXL Z
sessionManagerXX[ i
)XXi j
{YY 	
DebugZZ 
.ZZ 
	WriteLineZZ 
(ZZ 
$strZZ I
+ZZJ K
GetHashCodeZZL W
(ZZW X
)ZZX Y
)ZZY Z
;ZZZ [
_lobbyManager[[ 
=[[ 
lobbyManager[[ (
;[[( )
_sessionManager\\ 
=\\ 
sessionManager\\ ,
;\\, -
InitializeCommands]] 
(]] 
)]]  
;]]  !"
SubscribeToLobbyEvents^^ "
(^^" #
)^^# $
;^^$ %
}__ 	
	protectedaa 
virtualaa 
voidaa 
InitializeCommandsaa 1
(aa1 2
)aa2 3
{bb 	
LeaveCommandcc 
=cc 
newcc 
RelayCommandcc +
(cc+ ,

LeaveLobbycc, 6
)cc6 7
;cc7 8
SendMessageCommanddd 
=dd  
newdd! $
RelayCommanddd% 1
(dd1 2
(dd2 3
paramdd3 8
)dd8 9
=>dd: <
SendChatMessagedd= L
(ddL M
paramddM R
asddS U
stringddV \
)dd\ ]
)dd] ^
;dd^ _
KickPlayerCommandee 
=ee 
newee  #
RelayCommandee$ 0
(ee0 1
(ee1 2
paramee2 7
)ee7 8
=>ee9 ;

KickPlayeree< F
(eeF G
parameeG L
aseeM O
stringeeP V
)eeV W
)eeW X
;eeX Y
}ff 	
	protectedhh 
virtualhh 
voidhh "
SubscribeToLobbyEventshh 5
(hh5 6
)hh6 7
{ii 	
_lobbyManagerjj 
.jj 
LobbyStateUpdatedjj +
+=jj, .
OnLobbyStateUpdatedjj/ B
;jjB C
_lobbyManagerkk 
.kk  
LobbyMessageReceivedkk .
+=kk/ 1"
OnLobbyMessageReceivedkk2 H
;kkH I
_lobbyManagerll 
.ll 
Kickedll  
+=ll! #
OnKickedll$ ,
;ll, -
_lobbyManagermm 
.mm 
CountdownTickmm '
+=mm( *
OnCountdownTickmm+ :
;mm: ;
_lobbyManagernn 
.nn 
GameStartednn %
+=nn& (
OnGameStartednn) 6
;nn6 7
_lobbyManageroo 
.oo 
ConnectionLostoo (
+=oo) +
OnConnectionLostoo, <
;oo< =
}pp 	
	protectedrr 
virtualrr 
voidrr 
OnLobbyStateUpdatedrr 2
(rr2 3
LobbyStateDtorr3 @
staterrA F
)rrF G
{ss 	
	MatchNamett 
=tt 
statett 
.tt 
	MatchNamett '
;tt' (
HostUsernameuu 
=uu 
stateuu  
.uu  !
HostUsernameuu! -
;uu- .

Difficultyvv 
=vv 
statevv 
.vv 

Difficultyvv )
;vv) *
PlayerCountDisplayww 
=ww  
$"ww! #
{ww# $
stateww$ )
.ww) *
CurrentPlayersww* 8
}ww8 9
$strww9 :
{ww: ;
stateww; @
.ww@ A

MaxPlayerswwA K
}wwK L
"wwL M
;wwM N
	MatchCodexx 
=xx 
statexx 
.xx 
	MatchCodexx '
;xx' (
MatchCodeVisibilityyy 
=yy  !
stringyy" (
.yy( )
IsNullOrEmptyyy) 6
(yy6 7
stateyy7 <
.yy< =
	MatchCodeyy= F
)yyF G
?yyH I

VisibilityyyJ T
.yyT U
	CollapsedyyU ^
:yy_ `

Visibilityyya k
.yyk l
Visibleyyl s
;yys t
Players{{ 
.{{ 
Clear{{ 
({{ 
){{ 
;{{ 
bool|| 
amIHost|| 
=|| 
_sessionManager|| *
.||* +
CurrentUsername||+ :
?||: ;
.||; <
Equals||< B
(||B C
HostUsername||C O
,||O P
StringComparison||Q a
.||a b
OrdinalIgnoreCase||b s
)||s t
??||u w
false||x }
;||} ~
foreach}} 
(}} 
var}} 
username}} !
in}}" $
state}}% *
.}}* +
PlayerUsernames}}+ :
.}}: ;
OrderBy}}; B
(}}B C
u}}C D
=>}}E G
u}}H I
)}}I J
)}}J K
{~~ 
var 
playerVM 
= 
new "
PlayerViewModel# 2
{3 4
Username5 =
=> ?
username@ H
}I J
;J K
if
ÄÄ 
(
ÄÄ 
amIHost
ÄÄ 
&&
ÄÄ 
!
ÄÄ  
username
ÄÄ  (
.
ÄÄ( )
Equals
ÄÄ) /
(
ÄÄ/ 0
_sessionManager
ÄÄ0 ?
.
ÄÄ? @
CurrentUsername
ÄÄ@ O
,
ÄÄO P
StringComparison
ÄÄQ a
.
ÄÄa b
OrdinalIgnoreCase
ÄÄb s
)
ÄÄs t
)
ÄÄt u
{
ÅÅ 
playerVM
ÇÇ 
.
ÇÇ "
KickButtonVisibility
ÇÇ 1
=
ÇÇ2 3

Visibility
ÇÇ4 >
.
ÇÇ> ?
Visible
ÇÇ? F
;
ÇÇF G
playerVM
ÉÉ 
.
ÉÉ 
KickCommand
ÉÉ (
=
ÉÉ) *
KickPlayerCommand
ÉÉ+ <
;
ÉÉ< =
}
ÑÑ 
Players
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
playerVM
ÖÖ $
)
ÖÖ$ %
;
ÖÖ% &
}
ÜÜ 
OnPropertyChanged
áá 
(
áá 
nameof
áá $
(
áá$ %
IsHost
áá% +
)
áá+ ,
)
áá, -
;
áá- .
}
àà 	
	protected
ää 
virtual
ää 
void
ää $
OnLobbyMessageReceived
ää 5
(
ää5 6
ChatMessageDto
ää6 D
message
ääE L
)
ääL M
{
ãã 	
string
åå 
translatedMessage
åå $
=
åå% &!
TranslateMessageKey
åå' :
(
åå: ;
message
åå; B
.
ååB C
MessageContent
ååC Q
)
ååQ R
;
ååR S
string
çç 
	formatted
çç 
=
çç 
$"
çç !
$str
çç! "
{
çç" #
message
çç# *
.
çç* +
SenderUsername
çç+ 9
}
çç9 :
$str
çç: =
{
çç= >
translatedMessage
çç> O
}
ççO P
"
ççP Q
;
ççQ R
ChatMessages
éé 
.
éé 
Add
éé 
(
éé 
new
éé   
ChatMessageDisplay
éé! 3
{
éé4 5
FormattedMessage
éé6 F
=
ééG H
	formatted
ééI R
}
ééS T
)
ééT U
;
ééU V
const
èè 
int
èè 
maxMessages
èè !
=
èè" #
$num
èè$ '
;
èè' (
if
êê 
(
êê 
ChatMessages
êê 
.
êê 
Count
êê "
>
êê# $
maxMessages
êê% 0
)
êê0 1
{
ëë 
ChatMessages
íí 
.
íí 
RemoveAt
íí %
(
íí% &
$num
íí& '
)
íí' (
;
íí( )
}
ìì 
}
îî 	
	protected
ññ 
virtual
ññ 
void
ññ 
OnKicked
ññ '
(
ññ' (
string
ññ( .
reason
ññ/ 5
)
ññ5 6
{
óó 	
if
òò 
(
òò 
System
òò 
.
òò 
	Threading
òò  
.
òò  !
Interlocked
òò! ,
.
òò, -
CompareExchange
òò- <
(
òò< =
ref
òò= @
_isNavigatingBack
òòA R
,
òòR S
$num
òòT U
,
òòU V
$num
òòW X
)
òòX Y
!=
òòZ \
$num
òò] ^
)
òò^ _
return
ôô 
;
ôô 

MessageBox
õõ 
.
õõ 
Show
õõ 
(
õõ 
$"
õõ 
{
õõ 
Lang
õõ #
.
õõ# $"
waitingRoomMsgKicked
õõ$ 8
}
õõ8 9
$str
õõ9 ;
{
õõ; <
reason
õõ< B
}
õõB C
"
õõC D
,
õõD E
Lang
õõF J
.
õõJ K
alertInfoTitle
õõK Y
,
õõY Z
MessageBoxButton
õõ[ k
.
õõk l
OK
õõl n
,
õõn o
MessageBoxImage
õõp 
.õõ Ä
WarningõõÄ á
)õõá à
;õõà â%
NavigateBackToLobbyView
úú #
(
úú# $
)
úú$ %
;
úú% &
CleanUp
ùù 
(
ùù 
)
ùù 
;
ùù 
}
ûû 	
	protected
†† 
virtual
†† 
void
†† 
OnCountdownTick
†† .
(
††. /
int
††/ 2
secondsRemaining
††3 C
)
††C D
{
°° 	
CountdownValue
¢¢ 
=
¢¢ 
secondsRemaining
¢¢ -
;
¢¢- .!
CountdownVisibility
££ 
=
££  !

Visibility
££" ,
.
££, -
Visible
££- 4
;
££4 5
}
§§ 	
	protected
¶¶ 
virtual
¶¶ 
void
¶¶ 
OnGameStarted
¶¶ ,
(
¶¶, -
)
¶¶- .
{
ßß 	
int
®® 
originalValue
®® 
=
®® 
System
®®  &
.
®®& '
	Threading
®®' 0
.
®®0 1
Interlocked
®®1 <
.
®®< =
CompareExchange
®®= L
(
®®L M
ref
®®M P
_isNavigatingBack
®®Q b
,
®®b c
$num
®®d e
,
®®e f
$num
®®g h
)
®®h i
;
®®i j
if
©© 
(
©© 
originalValue
©© 
!=
©©  
$num
©©! "
)
©©" #
return
™™ 
;
™™ !
CountdownVisibility
¨¨ 
=
¨¨  !

Visibility
¨¨" ,
.
¨¨, -
	Collapsed
¨¨- 6
;
¨¨6 7
string
ÆÆ 
username
ÆÆ 
=
ÆÆ 
_sessionManager
ÆÆ -
.
ÆÆ- .
CurrentUsername
ÆÆ. =
;
ÆÆ= >
string
ØØ 
matchId
ØØ 
=
ØØ 
_lobbyManager
ØØ *
.
ØØ* +
CurrentMatchId
ØØ+ 9
;
ØØ9 :
if
±± 
(
±± 
string
±± 
.
±± 
IsNullOrEmpty
±± $
(
±±$ %
username
±±% -
)
±±- .
||
±±/ 1
string
±±2 8
.
±±8 9
IsNullOrEmpty
±±9 F
(
±±F G
matchId
±±G N
)
±±N O
)
±±O P
{
≤≤ 

MessageBox
≥≥ 
.
≥≥ 
Show
≥≥ 
(
≥≥  
Lang
≥≥  $
.
≥≥$ %*
alertActivationCompleteTitle
≥≥% A
,
≥≥A B
Lang
≥≥C G
.
≥≥G H
alertErrorTitle
≥≥H W
,
≥≥W X
MessageBoxButton
≥≥Y i
.
≥≥i j
OK
≥≥j l
,
≥≥l m
MessageBoxImage
≥≥n }
.
≥≥} ~
Error≥≥~ É
)≥≥É Ñ
;≥≥Ñ Ö%
NavigateBackToLobbyView
¥¥ '
(
¥¥' (
)
¥¥( )
;
¥¥) *
CleanUp
µµ 
(
µµ 
)
µµ 
;
µµ 
return
∂∂ 
;
∂∂ 
}
∑∑ 
GameClientManager
ππ 
.
ππ 
Instance
ππ &
.
ππ& '
Connect
ππ' .
(
ππ. /
username
ππ/ 7
,
ππ7 8
matchId
ππ9 @
)
ππ@ A
;
ππA B
Application
ªª 
.
ªª 
Current
ªª 
.
ªª  

Dispatcher
ªª  *
.
ªª* +
Invoke
ªª+ 1
(
ªª1 2
(
ªª2 3
)
ªª3 4
=>
ªª5 7
{
ºº 
var
ΩΩ 
wordSelectionView
ΩΩ %
=
ΩΩ& '
new
ΩΩ( +
WordSelectionView
ΩΩ, =
(
ΩΩ= >
)
ΩΩ> ?
;
ΩΩ? @
wordSelectionView
ææ !
.
ææ! "
Show
ææ" &
(
ææ& '
)
ææ' (
;
ææ( )
Window
¿¿ 
currentWindow
¿¿ $
=
¿¿% &
Application
¿¿' 2
.
¿¿2 3
Current
¿¿3 :
.
¿¿: ;
Windows
¿¿; B
.
¿¿B C
OfType
¿¿C I
<
¿¿I J
Window
¿¿J P
>
¿¿P Q
(
¿¿Q R
)
¿¿R S
.
¿¿S T
SingleOrDefault
¿¿T c
(
¿¿c d
w
¿¿d e
=>
¿¿f h
w
¿¿i j
.
¿¿j k
DataContext
¿¿k v
==
¿¿w y
this
¿¿z ~
)
¿¿~ 
;¿¿ Ä
currentWindow
¡¡ 
?
¡¡ 
.
¡¡ 
Close
¡¡ $
(
¡¡$ %
)
¡¡% &
;
¡¡& '
}
¬¬ 
)
¬¬ 
;
¬¬ 
CleanUp
√√ 
(
√√ 
)
√√ 
;
√√ 
}
ƒƒ 	
	protected
∆∆ 
virtual
∆∆ 
void
∆∆ 
OnConnectionLost
∆∆ /
(
∆∆/ 0
)
∆∆0 1
{
«« 	
if
»» 
(
»» 
System
»» 
.
»» 
	Threading
»»  
.
»»  !
Interlocked
»»! ,
.
»», -
CompareExchange
»»- <
(
»»< =
ref
»»= @
_isNavigatingBack
»»A R
,
»»R S
$num
»»T U
,
»»U V
$num
»»W X
)
»»X Y
!=
»»Z \
$num
»»] ^
)
»»^ _
return
…… 
;
…… %
NavigateBackToLobbyView
ÀÀ #
(
ÀÀ# $
)
ÀÀ$ %
;
ÀÀ% &
CleanUp
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ 
}
ÕÕ 	
	protected
œœ 
virtual
œœ 
void
œœ 

LeaveLobby
œœ )
(
œœ) *
object
œœ* 0
	parameter
œœ1 :
=
œœ; <
null
œœ= A
)
œœA B
{
–– 	
if
—— 
(
—— 
System
—— 
.
—— 
	Threading
——  
.
——  !
Interlocked
——! ,
.
——, -
CompareExchange
——- <
(
——< =
ref
——= @
_isNavigatingBack
——A R
,
——R S
$num
——T U
,
——U V
$num
——W X
)
——X Y
!=
——Z \
$num
——] ^
)
——^ _
return
““ 
;
““ 
_lobbyManager
‘‘ 
.
‘‘ 

Disconnect
‘‘ $
(
‘‘$ %
)
‘‘% &
;
‘‘& '%
NavigateBackToLobbyView
’’ #
(
’’# $
)
’’$ %
;
’’% &
CleanUp
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 	
	protected
ŸŸ 
virtual
ŸŸ 
void
ŸŸ 
SendChatMessage
ŸŸ .
(
ŸŸ. /
string
ŸŸ/ 5

messageKey
ŸŸ6 @
)
ŸŸ@ A
{
⁄⁄ 	
if
€€ 
(
€€ 
!
€€ 
string
€€ 
.
€€ 
IsNullOrEmpty
€€ %
(
€€% &

messageKey
€€& 0
)
€€0 1
)
€€1 2
{
‹‹ 
_lobbyManager
›› 
.
›› 
SendChatMessage
›› -
(
››- .

messageKey
››. 8
)
››8 9
;
››9 :
}
ﬁﬁ 
}
ﬂﬂ 	
	protected
·· 
virtual
·· 
void
·· 

KickPlayer
·· )
(
··) *
string
··* 0
usernameToKick
··1 ?
)
··? @
{
‚‚ 	
if
„„ 
(
„„ 
!
„„ 
string
„„ 
.
„„ 
IsNullOrEmpty
„„ %
(
„„% &
usernameToKick
„„& 4
)
„„4 5
&&
„„6 8
IsHost
„„9 ?
)
„„? @
{
‰‰ 
var
ÂÂ 
result
ÂÂ 
=
ÂÂ 

MessageBox
ÂÂ '
.
ÂÂ' (
Show
ÂÂ( ,
(
ÂÂ, -
string
ÂÂ- 3
.
ÂÂ3 4
Format
ÂÂ4 :
(
ÂÂ: ;
Lang
ÂÂ; ?
.
ÂÂ? @'
waitingRoomMsgConfirmKick
ÂÂ@ Y
,
ÂÂY Z
usernameToKick
ÂÂ[ i
)
ÂÂi j
,
ÂÂj k
Lang
ÊÊ- 1
.
ÊÊ1 2$
alertConfirmationTitle
ÊÊ2 H
,
ÊÊH I
MessageBoxButton
ÊÊJ Z
.
ÊÊZ [
YesNo
ÊÊ[ `
,
ÊÊ` a
MessageBoxImage
ÊÊb q
.
ÊÊq r
Question
ÊÊr z
)
ÊÊz {
;
ÊÊ{ |
if
ÁÁ 
(
ÁÁ 
result
ÁÁ 
==
ÁÁ 
MessageBoxResult
ÁÁ .
.
ÁÁ. /
Yes
ÁÁ/ 2
)
ÁÁ2 3
{
ËË 
_lobbyManager
ÈÈ !
.
ÈÈ! "
RequestKickPlayer
ÈÈ" 3
(
ÈÈ3 4
usernameToKick
ÈÈ4 B
)
ÈÈB C
;
ÈÈC D
}
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
	protected
ÓÓ 
static
ÓÓ 
string
ÓÓ !
TranslateMessageKey
ÓÓ  3
(
ÓÓ3 4
string
ÓÓ4 :
key
ÓÓ; >
)
ÓÓ> ?
{
ÔÔ 	
var
 
resource
 
=
 
Lang
 
.
  
ResourceManager
  /
.
/ 0
	GetString
0 9
(
9 :
key
: =
)
= >
;
> ?
return
ÒÒ 
string
ÒÒ 
.
ÒÒ 
IsNullOrEmpty
ÒÒ '
(
ÒÒ' (
resource
ÒÒ( 0
)
ÒÒ0 1
?
ÒÒ2 3
key
ÒÒ4 7
:
ÒÒ8 9
resource
ÒÒ: B
;
ÒÒB C
}
ÚÚ 	
	protected
ÙÙ 
virtual
ÙÙ 
void
ÙÙ %
NavigateBackToLobbyView
ÙÙ 6
(
ÙÙ6 7
)
ÙÙ7 8
{
ıı 	
Application
ˆˆ 
.
ˆˆ 
Current
ˆˆ 
.
ˆˆ  

Dispatcher
ˆˆ  *
.
ˆˆ* +
Invoke
ˆˆ+ 1
(
ˆˆ1 2
(
ˆˆ2 3
)
ˆˆ3 4
=>
ˆˆ5 7
{
˜˜ 
Window
¯¯ 
currentWindow
¯¯ $
=
¯¯% &
Application
¯¯' 2
.
¯¯2 3
Current
¯¯3 :
.
¯¯: ;
Windows
¯¯; B
.
¯¯B C
OfType
¯¯C I
<
¯¯I J
Window
¯¯J P
>
¯¯P Q
(
¯¯Q R
)
¯¯R S
.
¯¯S T
SingleOrDefault
¯¯T c
(
¯¯c d
w
¯¯d e
=>
¯¯f h
w
¯¯i j
.
¯¯j k
DataContext
¯¯k v
==
¯¯w y
this
¯¯z ~
)
¯¯~ 
;¯¯ Ä
var
˙˙ 
	lobbyView
˙˙ 
=
˙˙ 
new
˙˙  #
	LobbyView
˙˙$ -
(
˙˙- .
)
˙˙. /
;
˙˙/ 0
	lobbyView
˚˚ 
.
˚˚ 
Show
˚˚ 
(
˚˚ 
)
˚˚  
;
˚˚  !
Console
¸¸ 
.
¸¸ 
	WriteLine
¸¸ !
(
¸¸! "
$str
¸¸" F
)
¸¸F G
;
¸¸G H
currentWindow
˛˛ 
?
˛˛ 
.
˛˛ 
Close
˛˛ $
(
˛˛$ %
)
˛˛% &
;
˛˛& '
}
ˇˇ 
)
ˇˇ 
;
ˇˇ 
}
ÄÄ 	
public
ÇÇ 
virtual
ÇÇ 
void
ÇÇ 
CleanUp
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
{
ÉÉ 	(
UnsubscribeFromLobbyEvents
ÑÑ &
(
ÑÑ& '
)
ÑÑ' (
;
ÑÑ( )
_countdownTimer
ÖÖ 
?
ÖÖ 
.
ÖÖ 
Stop
ÖÖ !
(
ÖÖ! "
)
ÖÖ" #
;
ÖÖ# $
_countdownTimer
ÜÜ 
=
ÜÜ 
null
ÜÜ "
;
ÜÜ" #
Console
áá 
.
áá 
	WriteLine
áá 
(
áá 
$str
áá A
)
ááA B
;
ááB C
}
àà 	
	protected
ää 
virtual
ää 
void
ää (
UnsubscribeFromLobbyEvents
ää 9
(
ää9 :
)
ää: ;
{
ãã 	
_lobbyManager
åå 
.
åå 
LobbyStateUpdated
åå +
-=
åå, .!
OnLobbyStateUpdated
åå/ B
;
ååB C
_lobbyManager
çç 
.
çç "
LobbyMessageReceived
çç .
-=
çç/ 1$
OnLobbyMessageReceived
çç2 H
;
ççH I
_lobbyManager
éé 
.
éé 
Kicked
éé  
-=
éé! #
OnKicked
éé$ ,
;
éé, -
_lobbyManager
èè 
.
èè 
CountdownTick
èè '
-=
èè( *
OnCountdownTick
èè+ :
;
èè: ;
_lobbyManager
êê 
.
êê 
GameStarted
êê %
-=
êê& (
OnGameStarted
êê) 6
;
êê6 7
_lobbyManager
ëë 
.
ëë 
ConnectionLost
ëë (
-=
ëë) +
OnConnectionLost
ëë, <
;
ëë< =
Console
íí 
.
íí 
	WriteLine
íí 
(
íí 
$str
íí N
)
ííN O
;
ííO P
}
ìì 	
}
îî 
public
ññ 

class
ññ 
PlayerViewModel
ññ  
:
ññ! "
ViewModelBase
ññ# 0
{
óó 
private
òò 
string
òò 
	_username
òò  
;
òò  !
public
ôô 
string
ôô 
Username
ôô 
{
öö 	
get
õõ 
=>
õõ 
	_username
õõ 
;
õõ 
set
úú 
=>
úú 
SetProperty
úú 
(
úú 
ref
úú "
	_username
úú# ,
,
úú, -
value
úú. 3
)
úú3 4
;
úú4 5
}
ùù 	
private
üü 

Visibility
üü #
_kickButtonVisibility
üü 0
=
üü1 2

Visibility
üü3 =
.
üü= >
	Collapsed
üü> G
;
üüG H
public
†† 

Visibility
†† "
KickButtonVisibility
†† .
{
°° 	
get
¢¢ 
=>
¢¢ #
_kickButtonVisibility
¢¢ (
;
¢¢( )
set
££ 
=>
££ 
SetProperty
££ 
(
££ 
ref
££ "#
_kickButtonVisibility
££# 8
,
££8 9
value
££: ?
)
££? @
;
££@ A
}
§§ 	
public
¶¶ 
ICommand
¶¶ 
KickCommand
¶¶ #
{
¶¶$ %
get
¶¶& )
;
¶¶) *
set
¶¶+ .
;
¶¶. /
}
¶¶0 1
}
ßß 
}®® ∏
íC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\ViewModelBase.cs
	namespace		 	
GuessMyMessClient		
 
.		 
	ViewModel		 %
{

 
public 

abstract 
class 
ViewModelBase '
:( )"
INotifyPropertyChanged* @
{ 
public 
event '
PropertyChangedEventHandler 0
PropertyChanged1 @
;@ A
	protected 
void 
OnPropertyChanged (
(( )
[) *
CallerMemberName* :
]: ;
string< B
propertyNameC O
=P Q
nullR V
)V W
{ 	
PropertyChanged 
? 
. 
Invoke #
(# $
this$ (
,( )
new* -$
PropertyChangedEventArgs. F
(F G
propertyNameG S
)S T
)T U
;U V
} 	
	protected 
bool 
SetProperty "
<" #
T# $
>$ %
(% &
ref& )
T* +
field, 1
,1 2
T3 4
value5 :
,: ;
[< =
CallerMemberName= M
]M N
stringO U
propertyNameV b
=c d
nulle i
)i j
{ 	
if 
( 
EqualityComparer  
<  !
T! "
>" #
.# $
Default$ +
.+ ,
Equals, 2
(2 3
field3 8
,8 9
value: ?
)? @
)@ A
{ 
return 
false 
; 
} 
field 
= 
value 
; 
OnPropertyChanged 
( 
propertyName *
)* +
;+ ,
return 
true 
; 
} 	
} 
}   È
õC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\ServiceLocator.cs
	namespace		 	
GuessMyMessClient		
 
.		 
	ViewModel		 %
.		% &
Support		& -
{

 
public 

static 
class 
ServiceLocator &
{ 
public 
static 
INavigationService (

Navigation) 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
} 
} ≥<
ûC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\PasswordBoxHelper.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Support& -
{ 
public 

static 
class 
PasswordBoxHelper )
{ 
public		 
static		 
readonly		 
DependencyProperty		 1
PasswordProperty		2 B
=		C D
DependencyProperty

 
.

 
RegisterAttached

 /
(

/ 0
$str

0 :
,

: ;
typeof

< B
(

B C
string

C I
)

I J
,

J K
typeof

L R
(

R S
PasswordBoxHelper

S d
)

d e
,

e f
new %
FrameworkPropertyMetadata -
(- .
string. 4
.4 5
Empty5 :
,: ;%
OnPasswordPropertyChanged< U
)U V
)V W
;W X
public 
static 
readonly 
DependencyProperty 1
AttachProperty2 @
=A B
DependencyProperty 
. 
RegisterAttached /
(/ 0
$str0 8
,8 9
typeof: @
(@ A
boolA E
)E F
,F G
typeofH N
(N O
PasswordBoxHelperO `
)` a
,a b
new 
PropertyMetadata $
($ %
false% *
,* +
Attach, 2
)2 3
)3 4
;4 5
private 
static 
readonly 
DependencyProperty  2
IsUpdatingProperty3 E
=F G
DependencyProperty 
. 
RegisterAttached /
(/ 0
$str0 <
,< =
typeof> D
(D E
boolE I
)I J
,J K
typeofL R
(R S
PasswordBoxHelperS d
)d e
)e f
;f g
public 
static 
void 
	SetAttach $
($ %
DependencyObject% 5
dp6 8
,8 9
bool: >
value? D
)D E
{ 	
dp 
. 
SetValue 
( 
AttachProperty &
,& '
value( -
)- .
;. /
} 	
public 
static 
bool 
	GetAttach $
($ %
DependencyObject% 5
dp6 8
)8 9
{ 	
return 
( 
bool 
) 
dp 
. 
GetValue $
($ %
AttachProperty% 3
)3 4
;4 5
} 	
public 
static 
string 
GetPassword (
(( )
DependencyObject) 9
dp: <
)< =
{ 	
return   
(   
string   
)   
dp   
.   
GetValue   &
(  & '
PasswordProperty  ' 7
)  7 8
;  8 9
}!! 	
public## 
static## 
void## 
SetPassword## &
(##& '
DependencyObject##' 7
dp##8 :
,##: ;
string##< B
value##C H
)##H I
{$$ 	
dp%% 
.%% 
SetValue%% 
(%% 
PasswordProperty%% (
,%%( )
value%%* /
)%%/ 0
;%%0 1
}&& 	
private(( 
static(( 
bool(( 
GetIsUpdating(( )
((() *
DependencyObject((* :
dp((; =
)((= >
{)) 	
return** 
(** 
bool** 
)** 
dp** 
.** 
GetValue** $
(**$ %
IsUpdatingProperty**% 7
)**7 8
;**8 9
}++ 	
private-- 
static-- 
void-- 
SetIsUpdating-- )
(--) *
DependencyObject--* :
dp--; =
,--= >
bool--? C
value--D I
)--I J
{.. 	
dp// 
.// 
SetValue// 
(// 
IsUpdatingProperty// *
,//* +
value//, 1
)//1 2
;//2 3
}00 	
private22 
static22 
void22 %
OnPasswordPropertyChanged22 5
(225 6
DependencyObject226 F
sender22G M
,22M N.
"DependencyPropertyChangedEventArgs22O q
e22r s
)22s t
{33 	
if44 
(44 
!44 
(44 
sender44 
is44 
PasswordBox44 '
passwordBox44( 3
)443 4
)444 5
{55 
return66 
;66 
}77 
passwordBox99 
.99 
PasswordChanged99 '
-=99( *
PasswordChanged99+ :
;99: ;
if;; 
(;; 
!;; 
GetIsUpdating;; 
(;; 
passwordBox;; *
);;* +
);;+ ,
{<< 
passwordBox== 
.== 
Password== $
===% &
(==' (
string==( .
)==. /
e==/ 0
.==0 1
NewValue==1 9
;==9 :
}>> 
passwordBox?? 
.?? 
PasswordChanged?? '
+=??( *
PasswordChanged??+ :
;??: ;
}@@ 	
privateBB 
staticBB 
voidBB 
AttachBB "
(BB" #
DependencyObjectBB# 3
senderBB4 :
,BB: ;.
"DependencyPropertyChangedEventArgsBB< ^
eBB_ `
)BB` a
{CC 	
ifDD 
(DD 
!DD 
(DD 
senderDD 
isDD 
PasswordBoxDD '
passwordBoxDD( 3
)DD3 4
)DD4 5
{EE 
returnFF 
;FF 
}GG 
ifII 
(II 
(II 
boolII 
)II 
eII 
.II 
OldValueII  
)II  !
{JJ 
passwordBoxKK 
.KK 
PasswordChangedKK +
-=KK, .
PasswordChangedKK/ >
;KK> ?
}LL 
ifNN 
(NN 
(NN 
boolNN 
)NN 
eNN 
.NN 
NewValueNN  
)NN  !
{OO 
passwordBoxPP 
.PP 
PasswordChangedPP +
+=PP, .
PasswordChangedPP/ >
;PP> ?
}QQ 
}RR 	
privateTT 
staticTT 
voidTT 
PasswordChangedTT +
(TT+ ,
objectTT, 2
senderTT3 9
,TT9 :
RoutedEventArgsTT; J
eTTK L
)TTL M
{UU 	
ifVV 
(VV 
!VV 
(VV 
senderVV 
isVV 
PasswordBoxVV '
passwordBoxVV( 3
)VV3 4
)VV4 5
{WW 
returnXX 
;XX 
}YY 
SetIsUpdating[[ 
([[ 
passwordBox[[ %
,[[% &
true[[' +
)[[+ ,
;[[, -
SetPassword\\ 
(\\ 
passwordBox\\ #
,\\# $
passwordBox\\% 0
.\\0 1
Password\\1 9
)\\9 :
;\\: ;
SetIsUpdating]] 
(]] 
passwordBox]] %
,]]% &
false]]' ,
)]], -
;]]- .
}^^ 	
}__ 
}`` ˙?
¨C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\Navigation\WpfNavigationService.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Support& -
.- .

Navigation. 8
{ 
public 

class  
WpfNavigationService %
:& '
INavigationService( :
{ 
private 
Window 
_currentMatchWindow *
;* +
public 
void !
RegisterCurrentWindow )
() *
Window* 0
window1 7
)7 8
{ 	
_currentMatchWindow 
=  !
window" (
;( )
} 	
public 
void "
CloseCurrentGameWindow *
(* +
)+ ,
{ 	
if 
( 
_currentMatchWindow #
!=$ &
null' +
)+ ,
{ 
Application 
. 
Current #
?# $
.$ %

Dispatcher% /
./ 0
Invoke0 6
(6 7
(7 8
)8 9
=>: <
{ 
_currentMatchWindow '
.' (
Close( -
(- .
). /
;/ 0
_currentMatchWindow '
=( )
null* .
;. /
} 
) 
; 
} 
}   	
public"" 
void"" #
NavigateToDrawingScreen"" +
(""+ ,
string"", 2
word""3 7
)""7 8
{## 	
Application$$ 
.$$ 
Current$$ 
.$$  

Dispatcher$$  *
.$$* +
Invoke$$+ 1
($$1 2
($$2 3
)$$3 4
=>$$5 7
{%% "
CloseCurrentGameWindow&& &
(&&& '
)&&' (
;&&( )
var(( 
vm(( 
=(( 
new(( "
DrawingScreenViewModel(( 3
(((3 4
word((4 8
)((8 9
;((9 :
var)) 
view)) 
=)) 
new)) 
DrawingScreenView)) 0
{))1 2
DataContext))3 >
=))? @
vm))A C
}))D E
;))E F
view++ 
.++ 
Show++ 
(++ 
)++ 
;++ 
_currentMatchWindow,, #
=,,$ %
view,,& *
;,,* +
}-- 
)-- 
;-- 
}.. 	
public00 
void00 
NavigateToGuess00 #
(00# $

DrawingDto00$ .
drawing00/ 6
)006 7
{11 	
Application22 
.22 
Current22 
.22  

Dispatcher22  *
.22* +
Invoke22+ 1
(221 2
(222 3
)223 4
=>225 7
{33 "
CloseCurrentGameWindow44 &
(44& '
)44' (
;44( )
var66 
vm66 
=66 
new66 !
GuessTheWordViewModel66 2
(662 3
drawing663 :
)66: ;
;66; <
var77 
view77 
=77 
new77 
GuessTheWordView77 /
{770 1
DataContext772 =
=77> ?
vm77@ B
}77C D
;77D E
view99 
.99 
Show99 
(99 
)99 
;99 
_currentMatchWindow:: #
=::$ %
view::& *
;::* +
};; 
);; 
;;; 
}<< 	
public>> 
void>> 
NavigateToAnswers>> %
(>>% &

DrawingDto>>& 0
[>>0 1
]>>1 2
drawings>>3 ;
,>>; <
GuessDto>>= E
[>>E F
]>>F G
guesses>>H O
,>>O P
PlayerScoreDto>>Q _
[>>_ `
]>>` a
scores>>b h
)>>h i
{?? 	
Application@@ 
.@@ 
Current@@ 
.@@  

Dispatcher@@  *
.@@* +
Invoke@@+ 1
(@@1 2
(@@2 3
)@@3 4
=>@@5 7
{AA "
CloseCurrentGameWindowBB &
(BB& '
)BB' (
;BB( )
varDD 
drawingsListDD  
=DD! "
drawingsDD# +
?DD+ ,
.DD, -
ToListDD- 3
(DD3 4
)DD4 5
??DD6 8
newDD9 <
ListDD= A
<DDA B

DrawingDtoDDB L
>DDL M
(DDM N
)DDN O
;DDO P
varEE 
guessesListEE 
=EE  !
guessesEE" )
?EE) *
.EE* +
ToListEE+ 1
(EE1 2
)EE2 3
??EE4 6
newEE7 :
ListEE; ?
<EE? @
GuessDtoEE@ H
>EEH I
(EEI J
)EEJ K
;EEK L
varFF 

scoresListFF 
=FF  
scoresFF! '
?FF' (
.FF( )
ToListFF) /
(FF/ 0
)FF0 1
??FF2 4
newFF5 8
ListFF9 =
<FF= >
PlayerScoreDtoFF> L
>FFL M
(FFM N
)FFN O
;FFO P
varHH 
vmHH 
=HH 
newHH "
AnswersScreenViewModelHH 3
(HH3 4
drawingsListHH4 @
,HH@ A
guessesListHHB M
,HHM N

scoresListHHO Y
)HHY Z
;HHZ [
varII 
viewII 
=II 
newII 
AnswersScreenViewII 0
{II1 2
DataContextII3 >
=II? @
vmIIA C
}IID E
;IIE F
viewKK 
.KK 
ShowKK 
(KK 
)KK 
;KK 
_currentMatchWindowLL #
=LL$ %
viewLL& *
;LL* +
}MM 
)MM 
;MM 
}NN 	
publicPP 
voidPP 
NavigateToNextGuessPP '
(PP' (

DrawingDtoPP( 2
nextDrawingPP3 >
)PP> ?
{QQ 	
NavigateToGuessRR 
(RR 
nextDrawingRR '
)RR' (
;RR( )
}SS 	
publicUU 
voidUU  
NavigateToEndOfMatchUU (
(UU( )
PlayerScoreDtoUU) 7
[UU7 8
]UU8 9
finalScoresUU: E
)UUE F
{VV 	
ApplicationWW 
.WW 
CurrentWW 
.WW  

DispatcherWW  *
.WW* +
InvokeWW+ 1
(WW1 2
(WW2 3
)WW3 4
=>WW5 7
{XX "
CloseCurrentGameWindowYY &
(YY& '
)YY' (
;YY( )
var[[ 

scoresList[[ 
=[[  
finalScores[[! ,
?[[, -
.[[- .
ToList[[. 4
([[4 5
)[[5 6
??[[7 9
new[[: =
List[[> B
<[[B C
PlayerScoreDto[[C Q
>[[Q R
([[R S
)[[S T
;[[T U
}bb 
)bb 
;bb 
}cc 	
publicee 
voidee '
NavigateToWaitingForGuessesee /
(ee/ 0
stringee0 6
wordee7 ;
)ee; <
{ff 	
Applicationgg 
.gg 
Currentgg 
.gg  

Dispatchergg  *
.gg* +
Invokegg+ 1
(gg1 2
(gg2 3
)gg3 4
=>gg5 7
{hh "
CloseCurrentGameWindowii &
(ii& '
)ii' (
;ii( )
varkk 
vmkk 
=kk 
newkk &
WaitingForGuessesViewModelkk 7
(kk7 8
wordkk8 <
)kk< =
;kk= >
varll 
viewll 
=ll 
newll !
WaitingForGuessesViewll 4
{ll5 6
DataContextll7 B
=llC D
vmllE G
}llH I
;llI J
viewnn 
.nn 
Shownn 
(nn 
)nn 
;nn 
_currentMatchWindowoo #
=oo$ %
viewoo& *
;oo* +
}pp 
)pp 
;pp 
}qq 	
}rr 
}ss Œ
™C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\Navigation\INavigationService.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Support& -
.- .

Navigation. 8
{		 
public

 

	interface

 
INavigationService

 '
{ 
void !
RegisterCurrentWindow "
(" #
System# )
.) *
Windows* 1
.1 2
Window2 8
window9 ?
)? @
;@ A
void #
NavigateToDrawingScreen $
($ %
string% +
word, 0
)0 1
;1 2
void 
NavigateToGuess 
( 

DrawingDto '
drawing( /
)/ 0
;0 1
void 
NavigateToAnswers 
( 

DrawingDto )
[) *
]* +
drawings, 4
,4 5
GuessDto6 >
[> ?
]? @
guessesA H
,H I
PlayerScoreDtoJ X
[X Y
]Y Z
scores[ a
)a b
;b c
void 
NavigateToNextGuess  
(  !

DrawingDto! +
nextDrawing, 7
)7 8
;8 9
void  
NavigateToEndOfMatch !
(! "
PlayerScoreDto" 0
[0 1
]1 2
finalScores3 >
)> ?
;? @
void '
NavigateToWaitingForGuesses (
(( )
string) /
word0 4
)4 5
;5 6
void "
CloseCurrentGameWindow #
(# $
)$ %
;% &
} 
} ÚY
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\InkCanvasBinder.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Support& -
{ 
public 

static 
class 
InkCanvasBinder '
{		 
public

 
static

 
readonly

 
DependencyProperty

 1
EraserSizeProperty

2 D
=

E F
DependencyProperty 
. 
RegisterAttached /
(/ 0
$str 
, 
typeof 
( 
double 
) 
, 
typeof 
( 
InkCanvasBinder &
)& '
,' (
new 
PropertyMetadata $
($ %
$num% (
,( )
OnEraserSizeChanged* =
)= >
)> ?
;? @
public 
static 
double 
GetEraserSize *
(* +
DependencyObject+ ;
obj< ?
)? @
{ 	
return 
( 
double 
) 
obj 
. 
GetValue '
(' (
EraserSizeProperty( :
): ;
;; <
} 	
public 
static 
void 
SetEraserSize (
(( )
DependencyObject) 9
obj: =
,= >
double? E
valueF K
)K L
{ 	
obj 
. 
SetValue 
( 
EraserSizeProperty +
,+ ,
value- 2
)2 3
;3 4
} 	
private 
static 
void 
OnEraserSizeChanged /
(/ 0
DependencyObject0 @
dA B
,B C.
"DependencyPropertyChangedEventArgsD f
eg h
)h i
{ 	
if 
( 
d 
is 
	InkCanvas 
	inkCanvas (
&&) +
(, -
double- 3
)3 4
e4 5
.5 6
NewValue6 >
>? @
$numA B
)B C
{ 
double 
newSize 
=  
(! "
double" (
)( )
e) *
.* +
NewValue+ 3
;3 4
	inkCanvas   
.   
EraserShape   %
=  & '
new  ( +
EllipseStylusShape  , >
(  > ?
newSize  ? F
,  F G
newSize  H O
)  O P
;  P Q
}!! 
}"" 	
public$$ 
static$$ 
readonly$$ 
DependencyProperty$$ 1%
MouseStartCommandProperty$$2 K
=$$L M
DependencyProperty%% 
.%% 
RegisterAttached%% /
(%%/ 0
$str&& #
,&&# $
typeof'' 
('' 
ICommand'' 
)''  
,''  !
typeof(( 
((( 
InkCanvasBinder(( &
)((& '
,((' (
new)) 
PropertyMetadata)) $
())$ %
null))% )
,))) *!
OnMouseCommandChanged))+ @
)))@ A
)))A B
;))B C
public++ 
static++ 
ICommand++  
GetMouseStartCommand++ 3
(++3 4
DependencyObject++4 D
obj++E H
)++H I
=>++J L
(++M N
ICommand++N V
)++V W
obj++W Z
.++Z [
GetValue++[ c
(++c d%
MouseStartCommandProperty++d }
)++} ~
;++~ 
public,, 
static,, 
void,,  
SetMouseStartCommand,, /
(,,/ 0
DependencyObject,,0 @
obj,,A D
,,,D E
ICommand,,F N
value,,O T
),,T U
=>,,V X
obj,,Y \
.,,\ ]
SetValue,,] e
(,,e f%
MouseStartCommandProperty,,f 
,	,, Ä
value
,,Å Ü
)
,,Ü á
;
,,á à
public.. 
static.. 
readonly.. 
DependencyProperty.. 1$
MouseMoveCommandProperty..2 J
=..K L
DependencyProperty// 
.// 
RegisterAttached// /
(/// 0
$str00 "
,00" #
typeof11 
(11 
ICommand11 
)11  
,11  !
typeof22 
(22 
InkCanvasBinder22 &
)22& '
,22' (
new33 
PropertyMetadata33 $
(33$ %
null33% )
,33) *!
OnMouseCommandChanged33+ @
)33@ A
)33A B
;33B C
public55 
static55 
ICommand55 
GetMouseMoveCommand55 2
(552 3
DependencyObject553 C
obj55D G
)55G H
=>55I K
(55L M
ICommand55M U
)55U V
obj55V Y
.55Y Z
GetValue55Z b
(55b c$
MouseMoveCommandProperty55c {
)55{ |
;55| }
public66 
static66 
void66 
SetMouseMoveCommand66 .
(66. /
DependencyObject66/ ?
obj66@ C
,66C D
ICommand66E M
value66N S
)66S T
=>66U W
obj66X [
.66[ \
SetValue66\ d
(66d e$
MouseMoveCommandProperty66e }
,66} ~
value	66 Ñ
)
66Ñ Ö
;
66Ö Ü
public88 
static88 
readonly88 
DependencyProperty88 1#
MouseEndCommandProperty882 I
=88J K
DependencyProperty99 
.99 
RegisterAttached99 /
(99/ 0
$str:: !
,::! "
typeof;; 
(;; 
ICommand;; 
);;  
,;;  !
typeof<< 
(<< 
InkCanvasBinder<< &
)<<& '
,<<' (
new== 
PropertyMetadata== $
(==$ %
null==% )
,==) *!
OnMouseCommandChanged==+ @
)==@ A
)==A B
;==B C
public?? 
static?? 
ICommand?? 
GetMouseEndCommand?? 1
(??1 2
DependencyObject??2 B
obj??C F
)??F G
=>??H J
(??K L
ICommand??L T
)??T U
obj??U X
.??X Y
GetValue??Y a
(??a b#
MouseEndCommandProperty??b y
)??y z
;??z {
public@@ 
static@@ 
void@@ 
SetMouseEndCommand@@ -
(@@- .
DependencyObject@@. >
obj@@? B
,@@B C
ICommand@@D L
value@@M R
)@@R S
=>@@T V
obj@@W Z
.@@Z [
SetValue@@[ c
(@@c d#
MouseEndCommandProperty@@d {
,@@{ |
value	@@} Ç
)
@@Ç É
;
@@É Ñ
privateBB 
staticBB 
voidBB !
OnMouseCommandChangedBB 1
(BB1 2
DependencyObjectBB2 B
dBBC D
,BBD E.
"DependencyPropertyChangedEventArgsBBF h
eBBi j
)BBj k
{CC 	
ifDD 
(DD 
dDD 
isDD 
	InkCanvasDD 
	inkCanvasDD (
)DD( )
{EE 
	inkCanvasFF 
.FF &
PreviewMouseLeftButtonDownFF 4
-=FF5 7
InkCanvas_MouseDownFF8 K
;FFK L
	inkCanvasGG 
.GG 
PreviewMouseMoveGG *
-=GG+ -
InkCanvas_MouseMoveGG. A
;GGA B
	inkCanvasHH 
.HH $
PreviewMouseLeftButtonUpHH 2
-=HH3 5
InkCanvas_MouseUpHH6 G
;HHG H
	inkCanvasJJ 
.JJ &
PreviewMouseLeftButtonDownJJ 4
+=JJ5 7
InkCanvas_MouseDownJJ8 K
;JJK L
	inkCanvasKK 
.KK 
PreviewMouseMoveKK *
+=KK+ -
InkCanvas_MouseMoveKK. A
;KKA B
	inkCanvasLL 
.LL $
PreviewMouseLeftButtonUpLL 2
+=LL3 5
InkCanvas_MouseUpLL6 G
;LLG H
}MM 
}NN 	
privatePP 
staticPP 
voidPP 
InkCanvas_MouseDownPP /
(PP/ 0
objectPP0 6
senderPP7 =
,PP= > 
MouseButtonEventArgsPP? S
ePPT U
)PPU V
{QQ 	
ifRR 
(RR 
senderRR 
isRR 
	InkCanvasRR #
	inkCanvasRR$ -
)RR- .
{SS 
varTT 
commandTT 
=TT  
GetMouseStartCommandTT 2
(TT2 3
	inkCanvasTT3 <
)TT< =
;TT= >
ifUU 
(UU 
commandUU 
!=UU 
nullUU #
&&UU$ &
commandUU' .
.UU. /

CanExecuteUU/ 9
(UU9 :
nullUU: >
)UU> ?
)UU? @
{VV 
commandWW 
.WW 
ExecuteWW #
(WW# $
eWW$ %
.WW% &
GetPositionWW& 1
(WW1 2
	inkCanvasWW2 ;
)WW; <
)WW< =
;WW= >
}XX 
}YY 
}ZZ 	
private\\ 
static\\ 
void\\ 
InkCanvas_MouseMove\\ /
(\\/ 0
object\\0 6
sender\\7 =
,\\= >
MouseEventArgs\\? M
e\\N O
)\\O P
{]] 	
if^^ 
(^^ 
sender^^ 
is^^ 
	InkCanvas^^ #
	inkCanvas^^$ -
)^^- .
{__ 
var`` 
command`` 
=`` 
GetMouseMoveCommand`` 1
(``1 2
	inkCanvas``2 ;
)``; <
;``< =
ifaa 
(aa 
commandaa 
!=aa 
nullaa #
&&aa$ &
eaa' (
.aa( )

LeftButtonaa) 3
==aa4 6
MouseButtonStateaa7 G
.aaG H
PressedaaH O
&&aaP R
commandaaS Z
.aaZ [

CanExecuteaa[ e
(aae f
nullaaf j
)aaj k
)aak l
{bb 
commandcc 
.cc 
Executecc #
(cc# $
ecc$ %
.cc% &
GetPositioncc& 1
(cc1 2
	inkCanvascc2 ;
)cc; <
)cc< =
;cc= >
}dd 
}ee 
}ff 	
privatehh 
statichh 
voidhh 
InkCanvas_MouseUphh -
(hh- .
objecthh. 4
senderhh5 ;
,hh; < 
MouseButtonEventArgshh= Q
ehhR S
)hhS T
{ii 	
ifjj 
(jj 
senderjj 
isjj 
	InkCanvasjj #
	inkCanvasjj$ -
)jj- .
{kk 
varll 
commandll 
=ll 
GetMouseEndCommandll 0
(ll0 1
	inkCanvasll1 :
)ll: ;
;ll; <
ifmm 
(mm 
commandmm 
!=mm 
nullmm #
&&mm$ &
commandmm' .
.mm. /

CanExecutemm/ 9
(mm9 :
nullmm: >
)mm> ?
)mm? @
{nn 
commandoo 
.oo 
Executeoo #
(oo# $
nulloo$ (
)oo( )
;oo) *
}pp 
}qq 
}rr 	
}ss 
}tt ä
≤C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\Converters\CountToVisibilityConverter.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
Support

& -
.

- .

Converters

. 8
{ 
public 

class &
CountToVisibilityConverter +
:, -
IValueConverter. =
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
CultureInfoO Z
culture[ b
)b c
{ 	
if 
( 
value 
is 
int 
count "
)" #
{ 
return 
count 
> 
$num  
?! "

Visibility# -
.- .
Visible. 5
:6 7

Visibility8 B
.B C
	CollapsedC L
;L M
} 
return 

Visibility 
. 
	Collapsed '
;' (
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
CultureInfoS ^
culture_ f
)f g
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} µ
ØC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\Converters\BoolToGreenRedConverter.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
Support

& -
.

- .

Converters

. 8
{ 
public 

class #
BoolToGreenRedConverter (
:) *
IValueConverter+ :
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
CultureInfoO Z
culture[ b
)b c
{ 	
if 
( 
value 
is 
bool 
isOnline &
)& '
{ 
return 
isOnline 
?  !
new" %
SolidColorBrush& 5
(5 6
Colors6 <
.< =
Green= B
)B C
:D E
newF I
SolidColorBrushJ Y
(Y Z
ColorsZ `
.` a
Reda d
)d e
;e f
} 
return 
new 
SolidColorBrush &
(& '
Colors' -
.- .
Gray. 2
)2 3
;3 4
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
CultureInfoS ^
culture_ f
)f g
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} ñ
¥C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\Converters\BooleanToVisibilityConverter.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
Support

& -
.

- .

Converters

. 8
{ 
public 

class (
BooleanToVisibilityConverter -
:. /
IValueConverter0 ?
{ 
public 
object 
Convert 
( 
object $
value% *
,* +
Type, 0

targetType1 ;
,; <
object= C
	parameterD M
,M N
CultureInfoO Z
culture[ b
)b c
{ 	
bool 
	isVisible 
= 
( 
value #
is$ &
bool' +
b, -
)- .
&&/ 1
b2 3
;3 4
string 
param 
= 
	parameter $
as% '
string( .
;. /
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
param& +
)+ ,
&&- /
(0 1
param1 6
.6 7
ToLower7 >
(> ?
)? @
==A C
$strD L
||M O
paramP U
.U V
ToLowerV ]
(] ^
)^ _
==` b
$strc m
)m n
)n o
{ 
	isVisible 
= 
! 
	isVisible &
;& '
} 
return 
	isVisible 
? 

Visibility )
.) *
Visible* 1
:2 3

Visibility4 >
.> ?
	Collapsed? H
;H I
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
CultureInfoS ^
culture_ f
)f g
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
}   ª
∞C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Support\Converters\BooleanNegationConverter.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Support& -
.- .

Converters. 8
{ 
public 

class $
BooleanNegationConverter )
:* +
IValueConverter, ;
{ 
public		 
object		 
Convert		 
(		 
object		 $
value		% *
,		* +
Type		, 0

targetType		1 ;
,		; <
object		= C
	parameter		D M
,		M N
CultureInfo		O Z
culture		[ b
)		b c
{

 	
if 
( 
value 
is 
bool 
b 
)  
{ 
return 
! 
b 
; 
} 
return 
false 
; 
} 	
public 
object 
ConvertBack !
(! "
object" (
value) .
,. /
Type0 4

targetType5 ?
,? @
objectA G
	parameterH Q
,Q R
CultureInfoS ^
culture_ f
)f g
{ 	
if 
( 
value 
is 
bool 
b 
)  
{ 
return 
! 
b 
; 
} 
return 
false 
; 
} 	
} 
} ﬂm
†C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Session\SocialClientManager.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
Session

& -
{ 
public 

class 
SocialClientManager $
:% &"
ISocialServiceCallback' =
{ 
private 
const 
string (
SOCIAL_SERVICE_ENDPOINT_NAME 9
=: ;
$str< Z
;Z [
private 
SocialServiceClient #
_client$ +
;+ ,
private 
static 
readonly 
Lazy  $
<$ %
SocialClientManager% 8
>8 9
	_instance: C
=D E
new 
Lazy 
< 
SocialClientManager (
>( )
() *
(* +
)+ ,
=>- /
new0 3
SocialClientManager4 G
(G H
)H I
)I J
;J K
public 
static 
SocialClientManager )
Instance* 2
=>3 5
	_instance6 ?
.? @
Value@ E
;E F
public 
SocialServiceClient "
Client# )
=>* ,
_client- 4
;4 5
public 
event 
Action 
< 
string "
>" #
OnFriendRequest$ 3
;3 4
public 
event 
Action 
< 
string "
," #
bool$ (
>( )
OnFriendResponse* :
;: ;
public 
event 
Action 
< 
string "
," #
string$ *
>* +!
OnFriendStatusChanged, A
;A B
public 
event 
Action 
< 
DirectMessageDto ,
>, -
OnMessageReceived. ?
;? @
private 
SocialClientManager #
(# $
)$ %
{& '
}( )
public 
void 

Initialize 
( 
)  
{ 	
if   
(   
_client   
!=   
null   
&&    "
_client  # *
.  * +
State  + 0
==  1 3
CommunicationState  4 F
.  F G
Opened  G M
)  M N
{!! 
Console"" 
."" 
	WriteLine"" !
(""! "
$str""" H
)""H I
;""I J
return## 
;## 
}$$ 
try&& 
{'' 
_client(( 
=(( 
new(( 
SocialServiceClient(( 1
(((1 2
new((2 5
InstanceContext((6 E
(((E F
this((F J
)((J K
,((K L(
SOCIAL_SERVICE_ENDPOINT_NAME((M i
)((i j
;((j k
_client)) 
.)) 
Open)) 
()) 
))) 
;)) 
if++ 
(++ 
_client++ 
.++ 
State++ !
==++" $
CommunicationState++% 7
.++7 8
Opened++8 >
)++> ?
{,, 
_client-- 
.-- 
Connect-- #
(--# $
SessionManager--$ 2
.--2 3
Instance--3 ;
.--; <
CurrentUsername--< K
)--K L
;--L M
Console.. 
... 
	WriteLine.. %
(..% &
$"..& (
$str..( Z
{..Z [
SessionManager..[ i
...i j
Instance..j r
...r s
CurrentUsername	..s Ç
}
..Ç É
$str
..É Ñ
"
..Ñ Ö
)
..Ö Ü
;
..Ü á
}// 
else00 
{11 
Console22 
.22 
	WriteLine22 %
(22% &
$"22& (
$str22( ]
{22] ^
_client22^ e
.22e f
State22f k
}22k l
"22l m
)22m n
;22n o
throw33 
new33 %
InvalidOperationException33 7
(337 8
$"338 :
$str33: a
{33a b
_client33b i
.33i j
State33j o
}33o p
"33p q
)33q r
;33r s
}44 
}66 
catch77 
(77 %
InvalidOperationException77 ,
ioEx77- 1
)771 2
{88 

MessageBox99 
.99 
Show99 
(99  
$"99  "
$str99" Y
{99Y Z(
SOCIAL_SERVICE_ENDPOINT_NAME99Z v
}99v w
$str	99w π
{
99π ∫
ioEx
99∫ æ
.
99æ ø
Message
99ø ∆
}
99∆ «
"
99« »
,
99» …
$str
99  Ê
,
99Ê Á
MessageBoxButton
99Ë ¯
.
99¯ ˘
OK
99˘ ˚
,
99˚ ¸
MessageBoxImage
99˝ å
.
99å ç
Error
99ç í
)
99í ì
;
99ì î
CloseClientSafely:: !
(::! "
)::" #
;::# $
};; 
catch<< 
(<< 
	Exception<< 
ex<< 
)<<  
{== 

MessageBox>> 
.>> 
Show>> 
(>>  
$">>  "
$str>>" L
{>>L M
ex>>M O
.>>O P
Message>>P W
}>>W X
">>X Y
,>>Y Z
$str>>[ n
,>>n o
MessageBoxButton	>>p Ä
.
>>Ä Å
OK
>>Å É
,
>>É Ñ
MessageBoxImage
>>Ö î
.
>>î ï
Error
>>ï ö
)
>>ö õ
;
>>õ ú
CloseClientSafely?? !
(??! "
)??" #
;??# $
}@@ 
}AA 	
publicCC 
voidCC 
CleanupCC 
(CC 
)CC 
{DD 	
ConsoleEE 
.EE 
	WriteLineEE 
(EE 
$strEE K
)EEK L
;EEL M
ifFF 
(FF 
_clientFF 
!=FF 
nullFF 
&&FF  "
_clientFF# *
.FF* +
StateFF+ 0
==FF1 3
CommunicationStateFF4 F
.FFF G
OpenedFFG M
)FFM N
{GG 
tryHH 
{II 
ConsoleJJ 
.JJ 
	WriteLineJJ %
(JJ% &
$"JJ& (
$strJJ( A
{JJA B
SessionManagerJJB P
.JJP Q
InstanceJJQ Y
.JJY Z
CurrentUsernameJJZ i
}JJi j
$strJJj m
"JJm n
)JJn o
;JJo p
ifKK 
(KK 
!KK 
stringKK 
.KK  
IsNullOrEmptyKK  -
(KK- .
SessionManagerKK. <
.KK< =
InstanceKK= E
.KKE F
CurrentUsernameKKF U
)KKU V
)KKV W
{LL 
_clientMM 
.MM  

DisconnectMM  *
(MM* +
SessionManagerMM+ 9
.MM9 :
InstanceMM: B
.MMB C
CurrentUsernameMMC R
)MMR S
;MMS T
ConsoleNN 
.NN  
	WriteLineNN  )
(NN) *
$strNN* \
)NN\ ]
;NN] ^
}OO 
elsePP 
{PP 
ConsolePP "
.PP" #
	WriteLinePP# ,
(PP, -
$strPP- _
)PP_ `
;PP` a
}PPb c
}QQ 
catchRR 
(RR "
CommunicationExceptionRR -
commExRR. 4
)RR4 5
{SS 
ConsoleTT 
.TT 
	WriteLineTT %
(TT% &
$"TT& (
$strTT( z
{TTz {
commEx	TT{ Å
.
TTÅ Ç
Message
TTÇ â
}
TTâ ä
"
TTä ã
)
TTã å
;
TTå ç
}UU 
catchVV 
(VV 
	ExceptionVV  
exVV! #
)VV# $
{WW 
ConsoleXX 
.XX 
	WriteLineXX %
(XX% &
$"XX& (
$strXX( M
{XXM N
exXXN P
.XXP Q
MessageXXQ X
}XXX Y
"XXY Z
)XXZ [
;XX[ \
}YY 
}ZZ 
else[[ 
{\\ 
Console]] 
.]] 
	WriteLine]] !
(]]! "
$"]]" $
$str]]$ ?
{]]? @
_client]]@ G
?]]G H
.]]H I
State]]I N
}]]N O
$str]]O f
"]]f g
)]]g h
;]]h i
}^^ 
CloseClientSafely`` 
(`` 
)`` 
;``  
Consoleaa 
.aa 
	WriteLineaa 
(aa 
$straa J
)aaJ K
;aaK L
}bb 	
privatedd 
voiddd 
CloseClientSafelydd &
(dd& '
)dd' (
{ee 	
ifff 
(ff 
_clientff 
==ff 
nullff 
)ff  
returnff! '
;ff' (
Consolegg 
.gg 
	WriteLinegg 
(gg 
$"gg  
$strgg  E
{ggE F
_clientggF M
.ggM N
StateggN S
}ggS T
"ggT U
)ggU V
;ggV W
tryhh 
{ii 
ifjj 
(jj 
_clientjj 
.jj 
Statejj !
!=jj" $
CommunicationStatejj% 7
.jj7 8
Faultedjj8 ?
&&jj@ B
_clientjjC J
.jjJ K
StatejjK P
!=jjQ S
CommunicationStatejjT f
.jjf g
Closedjjg m
)jjm n
{kk 
_clientll 
.ll 
Closell !
(ll! "
)ll" #
;ll# $
Consolemm 
.mm 
	WriteLinemm %
(mm% &
$strmm& J
)mmJ K
;mmK L
}nn 
elseoo 
{pp 
_clientqq 
.qq 
Abortqq !
(qq! "
)qq" #
;qq# $
Consolerr 
.rr 
	WriteLinerr %
(rr% &
$strrr& W
)rrW X
;rrX Y
}ss 
}tt 
catchuu 
(uu 
	Exceptionuu 
exuu 
)uu  
{vv 
Consoleww 
.ww 
	WriteLineww !
(ww! "
$"ww" $
$strww$ M
{wwM N
exwwN P
.wwP Q
MessagewwQ X
}wwX Y
$strwwY g
"wwg h
)wwh i
;wwi j
_clientxx 
.xx 
Abortxx 
(xx 
)xx 
;xx  
}yy 
finallyzz 
{{{ 
_client|| 
=|| 
null|| 
;|| 
}}} 
}~~ 	
public
ÅÅ 
void
ÅÅ !
NotifyFriendRequest
ÅÅ '
(
ÅÅ' (
string
ÅÅ( .
fromUsername
ÅÅ/ ;
)
ÅÅ; <
{
ÇÇ 	
Console
ÉÉ 
.
ÉÉ 
	WriteLine
ÉÉ 
(
ÉÉ 
$"
ÉÉ  
$str
ÉÉ  J
{
ÉÉJ K
fromUsername
ÉÉK W
}
ÉÉW X
"
ÉÉX Y
)
ÉÉY Z
;
ÉÉZ [
OnFriendRequest
ÑÑ 
?
ÑÑ 
.
ÑÑ 
Invoke
ÑÑ #
(
ÑÑ# $
fromUsername
ÑÑ$ 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÖÖ 	
public
áá 
void
áá "
NotifyFriendResponse
áá (
(
áá( )
string
áá) /
fromUsername
áá0 <
,
áá< =
bool
áá> B
accepted
ááC K
)
ááK L
{
àà 	
Console
ââ 
.
ââ 
	WriteLine
ââ 
(
ââ 
$"
ââ  
$str
ââ  K
{
ââK L
fromUsername
ââL X
}
ââX Y
$str
ââY e
{
ââe f
accepted
ââf n
}
âân o
"
ââo p
)
ââp q
;
ââq r
OnFriendResponse
ää 
?
ää 
.
ää 
Invoke
ää $
(
ää$ %
fromUsername
ää% 1
,
ää1 2
accepted
ää3 ;
)
ää; <
;
ää< =
}
ãã 	
public
çç 
void
çç '
NotifyFriendStatusChanged
çç -
(
çç- .
string
çç. 4
friendUsername
çç5 C
,
ççC D
string
ççE K
status
ççL R
)
ççR S
{
éé 	
Console
èè 
.
èè 
	WriteLine
èè 
(
èè 
$"
èè  
$str
èè  R
{
èèR S
friendUsername
èèS a
}
èèa b
$str
èèb l
{
èèl m
status
èèm s
}
èès t
"
èèt u
)
èèu v
;
èèv w#
OnFriendStatusChanged
êê !
?
êê! "
.
êê" #
Invoke
êê# )
(
êê) *
friendUsername
êê* 8
,
êê8 9
status
êê: @
)
êê@ A
;
êêA B
}
ëë 	
public
ìì 
void
ìì #
NotifyMessageReceived
ìì )
(
ìì) *
DirectMessageDto
ìì* :
message
ìì; B
)
ììB C
{
îî 	
Console
ïï 
.
ïï 
	WriteLine
ïï 
(
ïï 
$"
ïï  
$str
ïï  L
{
ïïL M
message
ïïM T
?
ïïT U
.
ïïU V
SenderUsername
ïïV d
}
ïïd e
"
ïïe f
)
ïïf g
;
ïïg h
if
ññ 
(
ññ 
message
ññ 
!=
ññ 
null
ññ 
)
ññ  
{
óó 
OnMessageReceived
òò !
?
òò! "
.
òò" #
Invoke
òò# )
(
òò) *
message
òò* 1
)
òò1 2
;
òò2 3
}
ôô 
else
öö 
{
õõ 
Console
úú 
.
úú 
	WriteLine
úú !
(
úú! "
$str
úú" Y
)
úúY Z
;
úúZ [
}
ùù 
}
ûû 	
}
üü 
}†† æ
õC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Session\SessionManager.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Session& -
{ 
public		 

class		 
SessionManager		 
:		  !
ViewModelBase		" /
{

 
private 
static 
SessionManager %
	_instance& /
;/ 0
public 
static 
SessionManager $
Instance% -
=>. 0
	_instance1 :
??; =
(> ?
	_instance? H
=I J
newK N
SessionManagerO ]
(] ^
)^ _
)_ `
;` a
private 
string 
_currentUsername '
;' (
public 
string 
CurrentUsername %
{ 	
get 
=> 
_currentUsername #
;# $
set 
{ 
_currentUsername "
=# $
value% *
;* +
OnPropertyChanged, =
(= >
)> ?
;? @
}A B
} 	
public 
bool 

IsLoggedIn 
=> !
!" #
string# )
.) *
IsNullOrEmpty* 7
(7 8
CurrentUsername8 G
)G H
;H I
private 
SessionManager 
( 
)  
{! "
}# $
public 
void 
StartSession  
(  !
string! '
username( 0
)0 1
{ 	
CurrentUsername 
= 
username &
;& '
} 	
public 
void 
CloseSession  
(  !
)! "
{ 	
CurrentUsername   
=   
null   "
;  " #
}!! 	
}"" 
}## ‰Æ
üC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Session\LobbyClientManager.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Session& -
{ 
public 

class 
LobbyClientManager #
:$ %!
ILobbyServiceCallback& ;
{		 
private

 
static

 
readonly

 
Lazy

  $
<

$ %
LobbyClientManager

% 7
>

7 8
_lazyInstance

9 F
=

G H
new 
Lazy 
< 
LobbyClientManager '
>' (
(( )
() *
)* +
=>, .
new/ 2
LobbyClientManager3 E
(E F
)F G
)G H
;H I
public 
static 
LobbyClientManager (
Instance) 1
=>2 4
_lazyInstance5 B
.B C
ValueC H
;H I
private 
LobbyClientManager "
(" #
)# $
{% &
}' (
private 
LobbyServiceClient "
_client# *
;* +
public 
string 
CurrentMatchId $
{% &
get' *
;* +
private, 3
set4 7
;7 8
}9 :
private 
string 
_currentUsername '
;' (
public 
event 
Action 
< 
LobbyStateDto )
>) *
LobbyStateUpdated+ <
;< =
public 
event 
Action 
< 
ChatMessageDto *
>* + 
LobbyMessageReceived, @
;@ A
public 
event 
Action 
< 
string "
>" #
Kicked$ *
;* +
public 
event 
Action 
< 
int 
>  
CountdownTick! .
;. /
public 
event 
Action 
GameStarted '
;' (
public 
event 
Action 
ConnectionLost *
;* +
public 
bool 
IsConnected 
=>  "
_client# *
!=+ -
null. 2
&&3 5
_client6 =
.= >
State> C
==D F
CommunicationStateG Y
.Y Z
OpenedZ `
;` a
public 
void 
Connect 
( 
string "
username# +
,+ ,
string- 3
matchId4 ;
); <
{ 	
try   
{!! 
if"" 
("" 
IsConnected"" 
)""  

Disconnect""! +
(""+ ,
)"", -
;""- .
_currentUsername##  
=##! "
username### +
;##+ ,
CurrentMatchId$$ 
=$$  
matchId$$! (
;$$( )
var%% 
instanceContext%% #
=%%$ %
new%%& )
InstanceContext%%* 9
(%%9 :
this%%: >
)%%> ?
;%%? @
_client&& 
=&& 
new&& 
LobbyServiceClient&& 0
(&&0 1
instanceContext&&1 @
)&&@ A
;&&A B
_client'' 
.'' 
Open'' 
('' 
)'' 
;'' 
_client(( 
.(( 
InnerChannel(( $
.(($ %
Faulted((% ,
+=((- /
Channel_Faulted((0 ?
;((? @
_client)) 
.)) 
InnerChannel)) $
.))$ %
Closed))% +
+=)), .
Channel_Closed))/ =
;))= >
_client** 
.** 
ConnectToLobby** &
(**& '
username**' /
,**/ 0
matchId**1 8
)**8 9
;**9 :
Console++ 
.++ 
	WriteLine++ !
(++! "
$"++" $
$str++$ C
{++C D
matchId++D K
}++K L
$str++L P
{++P Q
username++Q Y
}++Y Z
"++Z [
)++[ \
;++\ ]
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
Console// 
.// 
	WriteLine// !
(//! "
$"//" $
$str//$ G
{//G H
ex//H J
.//J K
Message//K R
}//R S
"//S T
)//T U
;//U V

MessageBox00 
.00 
Show00 
(00  
$"00  "
$str00" =
{00= >
ex00> @
.00@ A
Message00A H
}00H I
"00I J
,00J K
$str00L ^
,00^ _
MessageBoxButton00` p
.00p q
OK00q s
,00s t
MessageBoxImage	00u Ñ
.
00Ñ Ö
Error
00Ö ä
)
00ä ã
;
00ã å
CleanupConnection11 !
(11! "
)11" #
;11# $
ConnectionLost22 
?22 
.22  
Invoke22  &
(22& '
)22' (
;22( )
}33 
}44 	
public66 
void66 

Disconnect66 
(66 
)66  
{77 	
if88 
(88 
!88 
IsConnected88 
)88 
return88 $
;88$ %
try99 
{:: 
_client;; 
.;; 

LeaveLobby;; "
(;;" #
_currentUsername;;# 3
,;;3 4
CurrentMatchId;;5 C
);;C D
;;;D E
Console<< 
.<< 
	WriteLine<< !
(<<! "
$"<<" $
$str<<$ @
{<<@ A
_currentUsername<<A Q
}<<Q R
$str<<R X
{<<X Y
CurrentMatchId<<Y g
}<<g h
"<<h i
)<<i j
;<<j k
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
when>>! %
(>>& '
ex>>' )
is>>* ,"
CommunicationException>>- C
||>>D F
ex>>G I
is>>J L
TimeoutException>>M ]
)>>] ^
{?? 
Console@@ 
.@@ 
	WriteLine@@ !
(@@! "
$"@@" $
$str@@$ J
{@@J K
ex@@K M
.@@M N
Message@@N U
}@@U V
$str@@V k
"@@k l
)@@l m
;@@m n
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 
ConsoleDD 
.DD 
	WriteLineDD !
(DD! "
$"DD" $
$strDD$ H
{DDH I
exDDI K
.DDK L
MessageDDL S
}DDS T
"DDT U
)DDU V
;DDV W
}EE 
finallyFF 
{GG 
CleanupConnectionHH !
(HH! "
)HH" #
;HH# $
}II 
}JJ 	
privateLL 
voidLL 
CleanupConnectionLL &
(LL& '
)LL' (
{MM 	
ifNN 
(NN 
_clientNN 
!=NN 
nullNN 
)NN  
{OO 
tryPP 
{QQ 
_clientRR 
.RR 
InnerChannelRR (
.RR( )
FaultedRR) 0
-=RR1 3
Channel_FaultedRR4 C
;RRC D
_clientSS 
.SS 
InnerChannelSS (
.SS( )
ClosedSS) /
-=SS0 2
Channel_ClosedSS3 A
;SSA B
}TT 
catchUU 
(UU 
	ExceptionUU  
exUU! #
)UU# $
{VV 
ConsoleWW 
.WW 
	WriteLineWW %
(WW% &
$"WW& (
$strWW( Q
{WWQ R
exWWR T
.WWT U
MessageWWU \
}WW\ ]
"WW] ^
)WW^ _
;WW_ `
}XX 
tryYY 
{ZZ 
if[[ 
([[ 
_client[[ 
.[[  
State[[  %
!=[[& (
CommunicationState[[) ;
.[[; <
Faulted[[< C
)[[C D
{\\ 
_client]] 
.]]  
Close]]  %
(]]% &
)]]& '
;]]' (
}^^ 
else__ 
{`` 
_clientaa 
.aa  
Abortaa  %
(aa% &
)aa& '
;aa' (
}bb 
}cc 
catchdd 
(dd 
	Exceptiondd  
exdd! #
)dd# $
{ee 
Consoleff 
.ff 
	WriteLineff %
(ff% &
$"ff& (
$strff( L
{ffL M
exffM O
.ffO P
MessageffP W
}ffW X
"ffX Y
)ffY Z
;ffZ [
_clientgg 
.gg 
Abortgg !
(gg! "
)gg" #
;gg# $
}hh 
finallyii 
{jj 
_clientkk 
=kk 
nullkk "
;kk" #
CurrentMatchIdll "
=ll# $
nullll% )
;ll) *
_currentUsernamemm $
=mm% &
nullmm' +
;mm+ ,
}nn 
}oo 
Consolepp 
.pp 
	WriteLinepp 
(pp 
$strpp :
)pp: ;
;pp; <
}qq 	
publicss 
voidss 
SendChatMessagess #
(ss# $
stringss$ *

messageKeyss+ 5
)ss5 6
{tt 	
ifuu 
(uu 
!uu 
IsConnecteduu 
||uu 
stringuu  &
.uu& '
IsNullOrEmptyuu' 4
(uu4 5
_currentUsernameuu5 E
)uuE F
||uuG I
stringuuJ P
.uuP Q
IsNullOrEmptyuuQ ^
(uu^ _
CurrentMatchIduu_ m
)uum n
)uun o
returnuup v
;uuv w
tryvv 
{ww 
_clientxx 
.xx 
SendLobbyMessagexx (
(xx( )
_currentUsernamexx) 9
,xx9 :
CurrentMatchIdxx; I
,xxI J

messageKeyxxK U
)xxU V
;xxV W
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
Console|| 
.|| 
	WriteLine|| !
(||! "
$"||" $
$str||$ @
{||@ A
ex||A C
.||C D
Message||D K
}||K L
"||L M
)||M N
;||N O$
HandleCommunicationError}} (
(}}( )
)}}) *
;}}* +
}~~ 
} 	
public
ÅÅ 
void
ÅÅ 
RequestStartGame
ÅÅ $
(
ÅÅ$ %
)
ÅÅ% &
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
!
ÉÉ 
IsConnected
ÉÉ 
||
ÉÉ 
string
ÉÉ  &
.
ÉÉ& '
IsNullOrEmpty
ÉÉ' 4
(
ÉÉ4 5
_currentUsername
ÉÉ5 E
)
ÉÉE F
||
ÉÉG I
string
ÉÉJ P
.
ÉÉP Q
IsNullOrEmpty
ÉÉQ ^
(
ÉÉ^ _
CurrentMatchId
ÉÉ_ m
)
ÉÉm n
)
ÉÉn o
return
ÉÉp v
;
ÉÉv w
try
ÑÑ 
{
ÖÖ 
_client
ÜÜ 
.
ÜÜ 
	StartGame
ÜÜ !
(
ÜÜ! "
_currentUsername
ÜÜ" 2
,
ÜÜ2 3
CurrentMatchId
ÜÜ4 B
)
ÜÜB C
;
ÜÜC D
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
Console
ää 
.
ää 
	WriteLine
ää !
(
ää! "
$"
ää" $
$str
ää$ A
{
ääA B
ex
ääB D
.
ääD E
Message
ääE L
}
ääL M
"
ääM N
)
ääN O
;
ääO P&
HandleCommunicationError
ãã (
(
ãã( )
)
ãã) *
;
ãã* +
}
åå 
}
çç 	
public
èè 
void
èè 
RequestKickPlayer
èè %
(
èè% &
string
èè& ,
playerToKick
èè- 9
)
èè9 :
{
êê 	
if
ëë 
(
ëë 
!
ëë 
IsConnected
ëë 
||
ëë 
string
ëë  &
.
ëë& '
IsNullOrEmpty
ëë' 4
(
ëë4 5
_currentUsername
ëë5 E
)
ëëE F
||
ëëG I
string
ëëJ P
.
ëëP Q
IsNullOrEmpty
ëëQ ^
(
ëë^ _
CurrentMatchId
ëë_ m
)
ëëm n
||
ëëo q
string
ëër x
.
ëëx y
IsNullOrEmptyëëy Ü
(ëëÜ á
playerToKickëëá ì
)ëëì î
)ëëî ï
returnëëñ ú
;ëëú ù
try
íí 
{
ìì 
_client
îî 
.
îî 

KickPlayer
îî "
(
îî" #
_currentUsername
îî# 3
,
îî3 4
playerToKick
îî5 A
,
îîA B
CurrentMatchId
îîC Q
)
îîQ R
;
îîR S
}
ïï 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
óó 
Console
òò 
.
òò 
	WriteLine
òò !
(
òò! "
$"
òò" $
$str
òò$ 9
{
òò9 :
playerToKick
òò: F
}
òòF G
$str
òòG I
{
òòI J
ex
òòJ L
.
òòL M
Message
òòM T
}
òòT U
"
òòU V
)
òòV W
;
òòW X&
HandleCommunicationError
ôô (
(
ôô( )
)
ôô) *
;
ôô* +
}
öö 
}
õõ 	
public
ùù 
void
ùù 
UpdateLobbyState
ùù $
(
ùù$ %
LobbyStateDto
ùù% 2
lobbyStateDto
ùù3 @
)
ùù@ A
{
ûû 	
Application
üü 
.
üü 
Current
üü 
?
üü  
.
üü  !

Dispatcher
üü! +
.
üü+ ,
Invoke
üü, 2
(
üü2 3
(
üü3 4
)
üü4 5
=>
üü6 8
{
†† 
Console
°° 
.
°° 
	WriteLine
°° !
(
°°! "
$"
°°" $
$str
°°$ A
{
°°A B
lobbyStateDto
°°B O
.
°°O P
CurrentPlayers
°°P ^
}
°°^ _
$str
°°_ `
{
°°` a
lobbyStateDto
°°a n
.
°°n o

MaxPlayers
°°o y
}
°°y z
$str°°z É
"°°É Ñ
)°°Ñ Ö
;°°Ö Ü
LobbyStateUpdated
¢¢ !
?
¢¢! "
.
¢¢" #
Invoke
¢¢# )
(
¢¢) *
lobbyStateDto
¢¢* 7
)
¢¢7 8
;
¢¢8 9
}
££ 
)
££ 
;
££ 
}
§§ 	
public
¶¶ 
void
¶¶ !
ReceiveLobbyMessage
¶¶ '
(
¶¶' (
ChatMessageDto
¶¶( 6

messageDto
¶¶7 A
)
¶¶A B
{
ßß 	
Application
®® 
.
®® 
Current
®® 
?
®®  
.
®®  !

Dispatcher
®®! +
.
®®+ ,
Invoke
®®, 2
(
®®2 3
(
®®3 4
)
®®4 5
=>
®®6 8
{
©© 
Console
™™ 
.
™™ 
	WriteLine
™™ !
(
™™! "
$"
™™" $
$str
™™$ 4
{
™™4 5

messageDto
™™5 ?
.
™™? @
SenderUsername
™™@ N
}
™™N O
$str
™™O R
{
™™R S

messageDto
™™S ]
.
™™] ^
MessageContent
™™^ l
}
™™l m
"
™™m n
)
™™n o
;
™™o p"
LobbyMessageReceived
´´ $
?
´´$ %
.
´´% &
Invoke
´´& ,
(
´´, -

messageDto
´´- 7
)
´´7 8
;
´´8 9
}
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 	
public
ØØ 
void
ØØ 
KickedFromLobby
ØØ #
(
ØØ# $
string
ØØ$ *
reason
ØØ+ 1
)
ØØ1 2
{
∞∞ 	
Application
±± 
.
±± 
Current
±± 
?
±±  
.
±±  !

Dispatcher
±±! +
.
±±+ ,
Invoke
±±, 2
(
±±2 3
(
±±3 4
)
±±4 5
=>
±±6 8
{
≤≤ 
Console
≥≥ 
.
≥≥ 
	WriteLine
≥≥ !
(
≥≥! "
$"
≥≥" $
$str
≥≥$ 7
{
≥≥7 8
reason
≥≥8 >
}
≥≥> ?
"
≥≥? @
)
≥≥@ A
;
≥≥A B
Kicked
¥¥ 
?
¥¥ 
.
¥¥ 
Invoke
¥¥ 
(
¥¥ 
reason
¥¥ %
)
¥¥% &
;
¥¥& '
CleanupConnection
µµ !
(
µµ! "
)
µµ" #
;
µµ# $
}
∂∂ 
)
∂∂ 
;
∂∂ 
}
∑∑ 	
public
ππ 
void
ππ 
OnGameStarting
ππ "
(
ππ" #
int
ππ# &
countdownSeconds
ππ' 7
)
ππ7 8
{
∫∫ 	
Application
ªª 
.
ªª 
Current
ªª 
?
ªª  
.
ªª  !

Dispatcher
ªª! +
.
ªª+ ,
Invoke
ªª, 2
(
ªª2 3
(
ªª3 4
)
ªª4 5
=>
ªª6 8
{
ºº 
Console
ΩΩ 
.
ΩΩ 
	WriteLine
ΩΩ !
(
ΩΩ! "
$"
ΩΩ" $
$str
ΩΩ$ 5
{
ΩΩ5 6
countdownSeconds
ΩΩ6 F
}
ΩΩF G
$str
ΩΩG J
"
ΩΩJ K
)
ΩΩK L
;
ΩΩL M
CountdownTick
ææ 
?
ææ 
.
ææ 
Invoke
ææ %
(
ææ% &
countdownSeconds
ææ& 6
)
ææ6 7
;
ææ7 8
}
øø 
)
øø 
;
øø 
}
¿¿ 	
public
¬¬ 
void
¬¬ 
OnGameStarted
¬¬ !
(
¬¬! "
)
¬¬" #
{
√√ 	
Application
ƒƒ 
.
ƒƒ 
Current
ƒƒ 
?
ƒƒ  
.
ƒƒ  !

Dispatcher
ƒƒ! +
.
ƒƒ+ ,
Invoke
ƒƒ, 2
(
ƒƒ2 3
(
ƒƒ3 4
)
ƒƒ4 5
=>
ƒƒ6 8
{
≈≈ 
Console
∆∆ 
.
∆∆ 
	WriteLine
∆∆ !
(
∆∆! "
$str
∆∆" 1
)
∆∆1 2
;
∆∆2 3
GameStarted
«« 
?
«« 
.
«« 
Invoke
«« #
(
««# $
)
««$ %
;
««% &
}
»» 
)
»» 
;
»» 
}
…… 	
public
ÀÀ 
void
ÀÀ 
UpdateKickVote
ÀÀ "
(
ÀÀ" #
string
ÀÀ# )
targetUsername
ÀÀ* 8
,
ÀÀ8 9
int
ÀÀ: =
currentVotes
ÀÀ> J
,
ÀÀJ K
int
ÀÀL O
votesNeeded
ÀÀP [
)
ÀÀ[ \
{
ÃÃ 	
Application
ÕÕ 
.
ÕÕ 
Current
ÕÕ 
?
ÕÕ  
.
ÕÕ  !

Dispatcher
ÕÕ! +
.
ÕÕ+ ,
Invoke
ÕÕ, 2
(
ÕÕ2 3
(
ÕÕ3 4
)
ÕÕ4 5
=>
ÕÕ6 8
{
ŒŒ 
Console
œœ 
.
œœ 
	WriteLine
œœ !
(
œœ! "
$"
œœ" $
$str
œœ$ 9
{
œœ9 :
targetUsername
œœ: H
}
œœH I
$str
œœI K
{
œœK L
currentVotes
œœL X
}
œœX Y
$str
œœY Z
{
œœZ [
votesNeeded
œœ[ f
}
œœf g
"
œœg h
)
œœh i
;
œœi j
}
–– 
)
–– 
;
–– 
}
—— 	
private
”” 
void
”” 
Channel_Faulted
”” $
(
””$ %
object
””% +
sender
””, 2
,
””2 3
	EventArgs
””4 =
e
””> ?
)
””? @
{
‘‘ 	
Console
’’ 
.
’’ 
	WriteLine
’’ 
(
’’ 
$str
’’ 8
)
’’8 9
;
’’9 :&
HandleCommunicationError
÷÷ $
(
÷÷$ %
true
÷÷% )
)
÷÷) *
;
÷÷* +
}
◊◊ 	
private
ŸŸ 
void
ŸŸ 
Channel_Closed
ŸŸ #
(
ŸŸ# $
object
ŸŸ$ *
sender
ŸŸ+ 1
,
ŸŸ1 2
	EventArgs
ŸŸ3 <
e
ŸŸ= >
)
ŸŸ> ?
{
⁄⁄ 	
Console
€€ 
.
€€ 
	WriteLine
€€ 
(
€€ 
$str
€€ 7
)
€€7 8
;
€€8 9
if
‹‹ 
(
‹‹ 
_client
‹‹ 
!=
‹‹ 
null
‹‹ 
)
‹‹  
{
›› &
HandleCommunicationError
ﬁﬁ (
(
ﬁﬁ( )
true
ﬁﬁ) -
)
ﬁﬁ- .
;
ﬁﬁ. /
}
ﬂﬂ 
}
‡‡ 	
private
‚‚ 
void
‚‚ &
HandleCommunicationError
‚‚ -
(
‚‚- .
bool
‚‚. 2

unexpected
‚‚3 =
=
‚‚> ?
false
‚‚@ E
)
‚‚E F
{
„„ 	
Application
‰‰ 
.
‰‰ 
Current
‰‰ 
?
‰‰  
.
‰‰  !

Dispatcher
‰‰! +
.
‰‰+ ,
Invoke
‰‰, 2
(
‰‰2 3
(
‰‰3 4
)
‰‰4 5
=>
‰‰6 8
{
ÂÂ 
Console
ÊÊ 
.
ÊÊ 
	WriteLine
ÊÊ !
(
ÊÊ! "
$str
ÊÊ" A
)
ÊÊA B
;
ÊÊB C
CleanupConnection
ÁÁ !
(
ÁÁ! "
)
ÁÁ" #
;
ÁÁ# $
ConnectionLost
ËË 
?
ËË 
.
ËË  
Invoke
ËË  &
(
ËË& '
)
ËË' (
;
ËË( )
if
ÈÈ 
(
ÈÈ 

unexpected
ÈÈ 
)
ÈÈ 
{
ÍÍ 

MessageBox
ÎÎ 
.
ÎÎ 
Show
ÎÎ #
(
ÎÎ# $
$str
ÎÎ$ K
,
ÎÎK L
$str
ÎÎM _
,
ÎÎ_ `
MessageBoxButton
ÎÎa q
.
ÎÎq r
OK
ÎÎr t
,
ÎÎt u
MessageBoxImageÎÎv Ö
.ÎÎÖ Ü
WarningÎÎÜ ç
)ÎÎç é
;ÎÎé è
}
ÏÏ 
}
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÓÓ 	
}
ÔÔ 
public
 

class
  
ChatMessageDisplay
 #
{
ÒÒ 
public
ÚÚ 
string
ÚÚ 
FormattedMessage
ÚÚ &
{
ÚÚ' (
get
ÚÚ) ,
;
ÚÚ, -
set
ÚÚ. 1
;
ÚÚ1 2
}
ÚÚ3 4
}
ÛÛ 
}ÙÙ Ût
•C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Session\MatchmakingClientManager.cs
	namespace		 	
GuessMyMessClient		
 
.		 
	ViewModel		 %
.		% &
Session		& -
{

 
public 

class $
MatchmakingClientManager )
:* +'
IMatchmakingServiceCallback, G
{ 
public 
static $
MatchmakingClientManager .
Instance/ 7
{8 9
get: =
;= >
private? F
setG J
;J K
}L M
private $
MatchmakingServiceClient (
_client) 0
;0 1
private 
string 
_connectedUsername )
;) *
public 
event 
Action 
< 
string "
," #
string$ *
>* +!
OnMatchInviteReceived, A
;A B
public 
event 
Action 
< 
MatchInfoDto (
>( )
OnMatchUpdated* 8
;8 9
public 
event 
Action 
< 
string "
," #
OperationResultDto$ 6
>6 7%
OnMatchJoinedSuccessfully8 Q
;Q R
public 
event 
Action 
< 
string "
>" #
OnMatchmakingFailed$ 7
;7 8
public 
event 
Action 
< 
List  
<  !
MatchInfoDto! -
>- .
>. /&
OnPublicMatchesListUpdated0 J
;J K
private $
MatchmakingClientManager (
(( )
)) *
{ 	
} 	
public 
static 
void 

Initialize %
(% &
)& '
{ 	
if 
( 
Instance 
== 
null  
)  !
{ 
Instance   
=   
new   $
MatchmakingClientManager   7
(  7 8
)  8 9
;  9 :
}!! 
}"" 	
public$$ 
bool$$ 
Connect$$ 
($$ 
string$$ "
username$$# +
)$$+ ,
{%% 	
try&& 
{'' 

Disconnect(( 
((( 
)(( 
;(( 
InstanceContext** 
context**  '
=**( )
new*** -
InstanceContext**. =
(**= >
this**> B
)**B C
;**C D
_client++ 
=++ 
new++ $
MatchmakingServiceClient++ 6
(++6 7
context++7 >
)++> ?
;++? @
_client,, 
.,, 
Open,, 
(,, 
),, 
;,, 
_client-- 
.-- 
Connect-- 
(--  
username--  (
)--( )
;--) *
_connectedUsername.. "
=..# $
username..% -
;..- .
return// 
true// 
;// 
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 

MessageBox33 
.33 
Show33 
(33  
$"33  "
$str33" L
{33L M
ex33M O
.33O P
Message33P W
}33W X
"33X Y
)33Y Z
;33Z [
_client44 
?44 
.44 
Abort44 
(44 
)44  
;44  !
_client55 
=55 
null55 
;55 
return66 
false66 
;66 
}77 
}88 	
public:: 
void:: 

Disconnect:: 
(:: 
)::  
{;; 	
if<< 
(<< 
_client<< 
!=<< 
null<< 
)<<  
{== 
if>> 
(>> 
_client>> 
.>> 
State>> !
==>>" $
CommunicationState>>% 7
.>>7 8
Opened>>8 >
&&>>? A
!>>B C
string>>C I
.>>I J
IsNullOrEmpty>>J W
(>>W X
_connectedUsername>>X j
)>>j k
)>>k l
{?? 
try@@ 
{AA 
_clientBB 
.BB  

DisconnectBB  *
(BB* +
_connectedUsernameBB+ =
)BB= >
;BB> ?
}CC 
catchDD 
(DD 
	ExceptionDD $
exDD% '
)DD' (
{EE 
ConsoleFF 
.FF  
	WriteLineFF  )
(FF) *
$"FF* ,
$strFF, M
{FFM N
exFFN P
.FFP Q
MessageFFQ X
}FFX Y
"FFY Z
)FFZ [
;FF[ \
}GG 
}HH 
ifJJ 
(JJ 
_clientJJ 
.JJ 
StateJJ !
!=JJ" $
CommunicationStateJJ% 7
.JJ7 8
ClosedJJ8 >
)JJ> ?
{KK 
tryLL 
{MM 
_clientNN 
.NN  
CloseNN  %
(NN% &
)NN& '
;NN' (
}OO 
catchPP 
(PP 
	ExceptionPP $
exPP% '
)PP' (
{QQ 
ConsoleRR 
.RR  
	WriteLineRR  )
(RR) *
$"RR* ,
$strRR, L
{RRL M
exRRM O
.RRO P
MessageRRP W
}RRW X
"RRX Y
)RRY Z
;RRZ [
_clientSS 
.SS  
AbortSS  %
(SS% &
)SS& '
;SS' (
}TT 
}UU 
}VV 
_clientXX 
=XX 
nullXX 
;XX 
_connectedUsernameYY 
=YY  
nullYY! %
;YY% &
}ZZ 	
public\\ 
async\\ 
Task\\ 
<\\ 
OperationResultDto\\ ,
>\\, -
CreateMatchAsync\\. >
(\\> ?
LobbySettingsDto\\? O
settings\\P X
)\\X Y
{]] 	
if^^ 
(^^ 
_client^^ 
==^^ 
null^^ 
||^^  "
_client^^# *
.^^* +
State^^+ 0
!=^^1 3
CommunicationState^^4 F
.^^F G
Opened^^G M
)^^M N
return__ 
new__ 
OperationResultDto__ -
{__. /
Success__0 7
=__8 9
false__: ?
,__? @
Message__A H
=__I J
$str__K f
}__g h
;__h i
tryaa 
{bb 
returncc 
awaitcc 
_clientcc $
.cc$ %
CreateMatchAsynccc% 5
(cc5 6
_connectedUsernamecc6 H
,ccH I
settingsccJ R
)ccR S
;ccS T
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
returngg 
newgg 
OperationResultDtogg -
{gg. /
Successgg0 7
=gg8 9
falsegg: ?
,gg? @
MessageggA H
=ggI J
$"ggK M
$strggM c
{ggc d
exggd f
.ggf g
Messageggg n
}ggn o
"ggo p
}ggq r
;ggr s
}hh 
}ii 	
publickk 
asynckk 
Taskkk 
<kk 
Listkk 
<kk 
MatchInfoDtokk +
>kk+ ,
>kk, -!
GetPublicMatchesAsynckk. C
(kkC D
)kkD E
{ll 	
ifmm 
(mm 
_clientmm 
==mm 
nullmm 
||mm  "
_clientmm# *
.mm* +
Statemm+ 0
!=mm1 3
CommunicationStatemm4 F
.mmF G
OpenedmmG M
)mmM N
returnnn 
newnn 
Listnn 
<nn  
MatchInfoDtonn  ,
>nn, -
(nn- .
)nn. /
;nn/ 0
trypp 
{qq 
varrr 
matchesArrayrr  
=rr! "
awaitrr# (
_clientrr) 0
.rr0 1!
GetPublicMatchesAsyncrr1 F
(rrF G
)rrG H
;rrH I
returnss 
matchesArrayss #
?ss# $
.ss$ %
ToListss% +
(ss+ ,
)ss, -
??ss. 0
newss1 4
Listss5 9
<ss9 :
MatchInfoDtoss: F
>ssF G
(ssG H
)ssH I
;ssI J
}tt 
catchuu 
(uu 
	Exceptionuu 
exuu 
)uu  
{vv 

MessageBoxww 
.ww 
Showww 
(ww  
$"ww  "
$strww" @
{ww@ A
exwwA C
.wwC D
MessagewwD K
}wwK L
"wwL M
)wwM N
;wwN O
returnxx 
newxx 
Listxx 
<xx  
MatchInfoDtoxx  ,
>xx, -
(xx- .
)xx. /
;xx/ 0
}yy 
}zz 	
public|| 
async|| 
Task|| 
JoinPublicMatch|| )
(||) *
string||* 0
matchId||1 8
)||8 9
{}} 	
if~~ 
(~~ 
_client~~ 
==~~ 
null~~ 
||~~  "
_client~~# *
.~~* +
State~~+ 0
!=~~1 3
CommunicationState~~4 F
.~~F G
Opened~~G M
)~~M N
{ !
OnMatchmakingFailed
ÄÄ #
?
ÄÄ# $
.
ÄÄ$ %
Invoke
ÄÄ% +
(
ÄÄ+ ,
$str
ÄÄ, G
)
ÄÄG H
;
ÄÄH I
return
ÅÅ 
;
ÅÅ 
}
ÇÇ 
try
ÑÑ 
{
ÖÖ 
await
ÜÜ 
_client
ÜÜ 
.
ÜÜ "
JoinPublicMatchAsync
ÜÜ 2
(
ÜÜ2 3 
_connectedUsername
ÜÜ3 E
,
ÜÜE F
matchId
ÜÜG N
)
ÜÜN O
;
ÜÜO P
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ !
OnMatchmakingFailed
ää #
?
ää# $
.
ää$ %
Invoke
ää% +
(
ää+ ,
$"
ää, .
$str
ää. J
{
ääJ K
ex
ääK M
.
ääM N
Message
ääN U
}
ääU V
"
ääV W
)
ääW X
;
ääX Y
}
ãã 
}
åå 	
public
éé 
async
éé 
Task
éé 
<
éé  
OperationResultDto
éé ,
>
éé, -#
JoinPrivateMatchAsync
éé. C
(
ééC D
string
ééD J
	matchCode
ééK T
)
ééT U
{
èè 	
if
êê 
(
êê 
_client
êê 
==
êê 
null
êê 
||
êê  "
_client
êê# *
.
êê* +
State
êê+ 0
!=
êê1 3 
CommunicationState
êê4 F
.
êêF G
Opened
êêG M
)
êêM N
return
ëë 
new
ëë  
OperationResultDto
ëë -
{
ëë. /
Success
ëë0 7
=
ëë8 9
false
ëë: ?
,
ëë? @
Message
ëëA H
=
ëëI J
$str
ëëK f
}
ëëg h
;
ëëh i
try
ìì 
{
îî 
return
ïï 
await
ïï 
_client
ïï $
.
ïï$ %#
JoinPrivateMatchAsync
ïï% :
(
ïï: ; 
_connectedUsername
ïï; M
,
ïïM N
	matchCode
ïïO X
)
ïïX Y
;
ïïY Z
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
òò 
return
ôô 
new
ôô  
OperationResultDto
ôô -
{
öö 
Success
öö 
=
öö 
false
öö  %
,
öö% &
Message
öö' .
=
öö/ 0
$"
öö1 3
$str
öö3 P
{
ööP Q
ex
ööQ S
.
ööS T
Message
ööT [
}
öö[ \
"
öö\ ]
}
öö^ _
;
öö_ `
}
õõ 
}
úú 	
public
ûû 
void
ûû  
ReceiveMatchInvite
ûû &
(
ûû& '
string
ûû' -
fromUsername
ûû. :
,
ûû: ;
string
ûû< B
matchId
ûûC J
)
ûûJ K
{
üü 	#
OnMatchInviteReceived
†† !
?
††! "
.
††" #
Invoke
††# )
(
††) *
fromUsername
††* 6
,
††6 7
matchId
††8 ?
)
††? @
;
††@ A
}
°° 	
public
££ 
void
££ 
MatchUpdate
££ 
(
££  
MatchInfoDto
££  ,
	matchInfo
££- 6
)
££6 7
{
§§ 	
OnMatchUpdated
•• 
?
•• 
.
•• 
Invoke
•• "
(
••" #
	matchInfo
••# ,
)
••, -
;
••- .
}
¶¶ 	
public
®® 
void
®® 
MatchJoined
®® 
(
®®  
string
®®  &
matchId
®®' .
,
®®. / 
OperationResultDto
®®0 B
result
®®C I
)
®®I J
{
©© 	'
OnMatchJoinedSuccessfully
™™ %
?
™™% &
.
™™& '
Invoke
™™' -
(
™™- .
matchId
™™. 5
,
™™5 6
result
™™7 =
)
™™= >
;
™™> ?
}
´´ 	
public
≠≠ 
void
≠≠ 
MatchmakingFailed
≠≠ %
(
≠≠% &
string
≠≠& ,
reason
≠≠- 3
)
≠≠3 4
{
ÆÆ 	!
OnMatchmakingFailed
ØØ 
?
ØØ  
.
ØØ  !
Invoke
ØØ! '
(
ØØ' (
reason
ØØ( .
)
ØØ. /
;
ØØ/ 0
}
∞∞ 	
public
≤≤ 
void
≤≤ &
PublicMatchesListUpdated
≤≤ ,
(
≤≤, -
MatchInfoDto
≤≤- 9
[
≤≤9 :
]
≤≤: ;
publicMatches
≤≤< I
)
≤≤I J
{
≥≥ 	
var
¥¥ 
matchesList
¥¥ 
=
¥¥ 
publicMatches
¥¥ +
?
¥¥+ ,
.
¥¥, -
ToList
¥¥- 3
(
¥¥3 4
)
¥¥4 5
??
¥¥6 8
new
¥¥9 <
List
¥¥= A
<
¥¥A B
MatchInfoDto
¥¥B N
>
¥¥N O
(
¥¥O P
)
¥¥P Q
;
¥¥Q R
Application
∂∂ 
.
∂∂ 
Current
∂∂ 
?
∂∂  
.
∂∂  !

Dispatcher
∂∂! +
?
∂∂+ ,
.
∂∂, -
Invoke
∂∂- 3
(
∂∂3 4
(
∂∂4 5
)
∂∂5 6
=>
∂∂7 9
{
∂∂: ;(
OnPublicMatchesListUpdated
∂∂< V
?
∂∂V W
.
∂∂W X
Invoke
∂∂X ^
(
∂∂^ _
matchesList
∂∂_ j
)
∂∂j k
;
∂∂k l
}
∂∂m n
)
∂∂n o
;
∂∂o p
}
∑∑ 	
}
∏∏ 
}ππ ‹ç
ûC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Session\GameClientManager.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Session& -
{		 
public

 

class

 
GameClientManager

 "
:

# $ 
IGameServiceCallback

% 9
{ 
private 
static 
readonly 
Lazy  $
<$ %
GameClientManager% 6
>6 7
_lazyInstance8 E
=F G
new 
Lazy 
< 
GameClientManager &
>& '
(' (
(( )
)) *
=>+ -
new. 1
GameClientManager2 C
(C D
)D E
)E F
;F G
public 
static 
GameClientManager '
Instance( 0
=>1 3
_lazyInstance4 A
.A B
ValueB G
;G H
private 
GameClientManager !
(! "
)" #
{$ %
}& '
private 
GameServiceClient !
_client" )
;) *
private 
string 
_currentUsername '
;' (
private 
string 
_currentMatchId &
;& '
private 
const 
string 
EndpointName )
=* +
$str, H
;H I
public 
string 
GetCurrentUsername (
(( )
)) *
{ 	
return 
_currentUsername #
;# $
} 	
public 
bool 
IsConnected 
=>  "
_client# *
!=+ -
null. 2
&&3 5
_client6 =
.= >
State> C
==D F
CommunicationStateG Y
.Y Z
OpenedZ `
;` a
public 
event 
EventHandler !
<! "
RoundStartEventArgs" 5
>5 6

RoundStart7 A
;A B
public   
event   
EventHandler   !
<  ! "&
DrawingPhaseStartEventArgs  " <
>  < =
DrawingPhaseStart  > O
;  O P
public!! 
event!! 
EventHandler!! !
<!!! "'
GuessingPhaseStartEventArgs!!" =
>!!= >
GuessingPhaseStart!!? Q
;!!Q R
public"" 
event"" 
EventHandler"" !
<""! ""
PlayerGuessedEventArgs""" 8
>""8 9"
PlayerGuessedCorrectly"": P
;""P Q
public## 
event## 
EventHandler## !
<##! "
TimeUpdateEventArgs##" 5
>##5 6

TimeUpdate##7 A
;##A B
public$$ 
event$$ 
EventHandler$$ !
<$$! "
RoundEndEventArgs$$" 3
>$$3 4
RoundEnd$$5 =
;$$= >
public%% 
event%% 
EventHandler%% !
<%%! "
GameEndEventArgs%%" 2
>%%2 3
GameEnd%%4 ;
;%%; <
public&& 
event&& 
Action&& 
ConnectionLost&& *
;&&* +
public'' 
event'' 
EventHandler'' !
<''! ""
InGameMessageEventArgs''" 8
>''8 9!
InGameMessageReceived'': O
;''O P
public(( 
event(( 
EventHandler(( !
<((! "&
AnswersPhaseStartEventArgs((" <
>((< =
AnswersPhaseStart((> O
;((O P
public)) 
event)) 
EventHandler)) !
<))! "$
ShowNextDrawingEventArgs))" :
>)): ;
ShowNextDrawing))< K
;))K L
public++ 
void++ 
Connect++ 
(++ 
string++ "
username++# +
,+++ ,
string++- 3
matchId++4 ;
)++; <
{,, 	
try-- 
{.. 
if// 
(// 
IsConnected// 
)//  

Disconnect//! +
(//+ ,
)//, -
;//- .
_currentUsername11  
=11! "
username11# +
;11+ ,
_currentMatchId22 
=22  !
matchId22" )
;22) *
var44 
instanceContext44 #
=44$ %
new44& )
InstanceContext44* 9
(449 :
this44: >
)44> ?
;44? @
_client55 
=55 
new55 
GameServiceClient55 /
(55/ 0
instanceContext550 ?
,55? @
EndpointName55A M
)55M N
;55N O
_client66 
.66 
Open66 
(66 
)66 
;66 
_client88 
.88 
InnerChannel88 $
.88$ %
Faulted88% ,
+=88- /
Channel_Faulted880 ?
;88? @
_client99 
.99 
InnerChannel99 $
.99$ %
Closed99% +
+=99, .
Channel_Closed99/ =
;99= >
_client;; 
.;; 
Connect;; 
(;;  
_currentUsername;;  0
,;;0 1
_currentMatchId;;2 A
);;A B
;;;B C
Console<< 
.<< 
	WriteLine<< !
(<<! "
$"<<" $
$str<<$ D
{<<D E
username<<E M
}<<M N
$str<<N X
{<<X Y
matchId<<Y `
}<<` a
"<<a b
)<<b c
;<<c d
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
{?? 
Console@@ 
.@@ 
	WriteLine@@ !
(@@! "
$"@@" $
$str@@$ E
{@@E F
ex@@F H
.@@H I
Message@@I P
}@@P Q
"@@Q R
)@@R S
;@@S T

MessageBoxAA 
.AA 
ShowAA 
(AA  
$"AA  "
$strAA" H
{AAH I
exAAI K
.AAK L
MessageAAL S
}AAS T
"AAT U
,AAU V
$strAAW i
,AAi j
MessageBoxButtonAAk {
.AA{ |
OKAA| ~
,AA~ 
MessageBoxImage
AAÄ è
.
AAè ê
Error
AAê ï
)
AAï ñ
;
AAñ ó
CleanupConnectionBB !
(BB! "
)BB" #
;BB# $
ConnectionLostCC 
?CC 
.CC  
InvokeCC  &
(CC& '
)CC' (
;CC( )
}DD 
}EE 	
publicGG 
voidGG 

DisconnectGG 
(GG 
)GG  
{HH 	
ifII 
(II 
!II 
IsConnectedII 
)II 
returnII $
;II$ %
tryJJ 
{KK 
_clientLL 
.LL 

DisconnectLL "
(LL" #
_currentUsernameLL# 3
,LL3 4
_currentMatchIdLL5 D
)LLD E
;LLE F
ConsoleMM 
.MM 
	WriteLineMM !
(MM! "
$"MM" $
$strMM$ S
{MMS T
_currentUsernameMMT d
}MMd e
"MMe f
)MMf g
;MMg h
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
whenOO! %
(OO& '
exOO' )
isOO* ,"
CommunicationExceptionOO- C
||OOD F
exOOG I
isOOJ L
TimeoutExceptionOOM ]
)OO] ^
{PP 
ConsoleQQ 
.QQ 
	WriteLineQQ !
(QQ! "
$"QQ" $
$strQQ$ P
{QQP Q
exQQQ S
.QQS T
MessageQQT [
}QQ[ \
$strQQ\ r
"QQr s
)QQs t
;QQt u
}RR 
finallySS 
{TT 
CleanupConnectionUU !
(UU! "
)UU" #
;UU# $
}VV 
}WW 	
privateYY 
voidYY 
CleanupConnectionYY &
(YY& '
)YY' (
{ZZ 	
if[[ 
([[ 
_client[[ 
!=[[ 
null[[ 
)[[  
{\\ 
try]] 
{^^ 
_client__ 
.__ 
InnerChannel__ (
.__( )
Faulted__) 0
-=__1 3
Channel_Faulted__4 C
;__C D
_client`` 
.`` 
InnerChannel`` (
.``( )
Closed``) /
-=``0 2
Channel_Closed``3 A
;``A B
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
Consoledd 
.dd 
	WriteLinedd %
(dd% &
$"dd& (
$strdd( W
{ddW X
exddX Z
.ddZ [
Messagedd[ b
}ddb c
"ddc d
)ddd e
;dde f
}ee 
trygg 
{hh 
ifii 
(ii 
_clientii 
.ii  
Stateii  %
!=ii& (
CommunicationStateii) ;
.ii; <
Faultedii< C
)iiC D
_clientiiE L
.iiL M
CloseiiM R
(iiR S
)iiS T
;iiT U
elsejj 
_clientjj  
.jj  !
Abortjj! &
(jj& '
)jj' (
;jj( )
}kk 
catchll 
(ll 
	Exceptionll  
exll! #
)ll# $
{mm 
Consolenn 
.nn 
	WriteLinenn %
(nn% &
$"nn& (
$strnn( V
{nnV W
exnnW Y
.nnY Z
MessagennZ a
}nna b
"nnb c
)nnc d
;nnd e
_clientoo 
.oo 
Abortoo !
(oo! "
)oo" #
;oo# $
}pp 
finallyqq 
{rr 
_clientss 
=ss 
nullss "
;ss" #
_currentMatchIdtt #
=tt$ %
nulltt& *
;tt* +
_currentUsernameuu $
=uu% &
nulluu' +
;uu+ ,
}vv 
}ww 
Consolexx 
.xx 
	WriteLinexx 
(xx 
$strxx F
)xxF G
;xxG H
}yy 	
public{{ 
async{{ 
Task{{ 
<{{ 
WordDto{{ !
[{{! "
]{{" #
>{{# $
GetRandomWordsAsync{{% 8
({{8 9
){{9 :
{|| 	
if}} 
(}} 
!}} 
IsConnected}} 
)}} 
return}} $
null}}% )
;}}) *
try~~ 
{ 
return
ÄÄ 
await
ÄÄ 
_client
ÄÄ $
.
ÄÄ$ %!
GetRandomWordsAsync
ÄÄ% 8
(
ÄÄ8 9
)
ÄÄ9 :
;
ÄÄ: ;
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÉÉ 
Console
ÑÑ 
.
ÑÑ 
	WriteLine
ÑÑ !
(
ÑÑ! "
$"
ÑÑ" $
$str
ÑÑ$ B
{
ÑÑB C
ex
ÑÑC E
.
ÑÑE F
Message
ÑÑF M
}
ÑÑM N
"
ÑÑN O
)
ÑÑO P
;
ÑÑP Q&
HandleCommunicationError
ÖÖ (
(
ÖÖ( )
true
ÖÖ) -
)
ÖÖ- .
;
ÖÖ. /
return
ÜÜ 
null
ÜÜ 
;
ÜÜ 
}
áá 
}
àà 	
public
ää 
void
ää 

SelectWord
ää 
(
ää 
string
ää %
selectedWord
ää& 2
)
ää2 3
{
ãã 	
if
åå 
(
åå 
!
åå 
IsConnected
åå 
)
åå 
return
åå $
;
åå$ %
try
çç 
{
éé 
_client
èè 
.
èè 

SelectWord
èè "
(
èè" #
_currentUsername
èè# 3
,
èè3 4
_currentMatchId
èè5 D
,
èèD E
selectedWord
èèF R
)
èèR S
;
èèS T
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
íí 
Console
ìì 
.
ìì 
	WriteLine
ìì !
(
ìì! "
$"
ìì" $
$str
ìì$ 9
{
ìì9 :
ex
ìì: <
.
ìì< =
Message
ìì= D
}
ììD E
"
ììE F
)
ììF G
;
ììG H&
HandleCommunicationError
îî (
(
îî( )
true
îî) -
)
îî- .
;
îî. /
}
ïï 
}
ññ 	
public
òò 
void
òò 
SubmitDrawing
òò !
(
òò! "
byte
òò" &
[
òò& '
]
òò' (
drawingData
òò) 4
)
òò4 5
{
ôô 	
if
öö 
(
öö 
!
öö 
IsConnected
öö 
)
öö 
return
öö $
;
öö$ %
try
õõ 
{
úú 
_client
ùù 
.
ùù 
SubmitDrawing
ùù %
(
ùù% &
_currentUsername
ùù& 6
,
ùù6 7
_currentMatchId
ùù8 G
,
ùùG H
drawingData
ùùI T
)
ùùT U
;
ùùU V
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
†† 
Console
°° 
.
°° 
	WriteLine
°° !
(
°°! "
$"
°°" $
$str
°°$ <
{
°°< =
ex
°°= ?
.
°°? @
Message
°°@ G
}
°°G H
"
°°H I
)
°°I J
;
°°J K&
HandleCommunicationError
¢¢ (
(
¢¢( )
true
¢¢) -
)
¢¢- .
;
¢¢. /
}
££ 
}
§§ 	
public
¶¶ 
void
¶¶ 
SendInGameMessage
¶¶ %
(
¶¶% &
string
¶¶& ,
message
¶¶- 4
)
¶¶4 5
{
ßß 	
if
®® 
(
®® 
_client
®® 
!=
®® 
null
®® 
&&
®®  "
_client
®®# *
.
®®* +
State
®®+ 0
==
®®1 3 
CommunicationState
®®4 F
.
®®F G
Opened
®®G M
)
®®M N
{
©© 
try
™™ 
{
´´ 
_client
¨¨ 
.
¨¨ (
SendInGameChatMessageAsync
¨¨ 6
(
¨¨6 7
_currentUsername
¨¨7 G
,
¨¨G H
_currentMatchId
¨¨I X
,
¨¨X Y
message
¨¨Z a
)
¨¨a b
;
¨¨b c
}
≠≠ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ØØ 
Console
∞∞ 
.
∞∞ 
	WriteLine
∞∞ %
(
∞∞% &
$"
∞∞& (
$str
∞∞( ?
{
∞∞? @
ex
∞∞@ B
.
∞∞B C
Message
∞∞C J
}
∞∞J K
"
∞∞K L
)
∞∞L M
;
∞∞M N&
HandleCommunicationError
±± ,
(
±±, -
true
±±- 1
)
±±1 2
;
±±2 3
}
≤≤ 
}
≥≥ 
}
¥¥ 	
public
∂∂ 
void
∂∂ 
SubmitGuess
∂∂ 
(
∂∂  
string
∂∂  &
guess
∂∂' ,
,
∂∂, -
int
∂∂. 1
	drawingId
∂∂2 ;
)
∂∂; <
{
∑∑ 	
if
∏∏ 
(
∏∏ 
_client
∏∏ 
!=
∏∏ 
null
∏∏ 
&&
∏∏  "
_client
∏∏# *
.
∏∏* +
State
∏∏+ 0
==
∏∏1 3 
CommunicationState
∏∏4 F
.
∏∏F G
Opened
∏∏G M
)
∏∏M N
{
ππ 
try
∫∫ 
{
ªª 
_client
ºº 
.
ºº 
SubmitGuessAsync
ºº ,
(
ºº, -
_currentUsername
ºº- =
,
ºº= >
_currentMatchId
ºº? N
,
ººN O
	drawingId
ººP Y
,
ººY Z
guess
ºº[ `
)
ºº` a
;
ººa b
}
ΩΩ 
catch
ææ 
(
ææ 
	Exception
ææ  
ex
ææ! #
)
ææ# $
{
øø 
Console
¿¿ 
.
¿¿ 
	WriteLine
¿¿ %
(
¿¿% &
$"
¿¿& (
$str
¿¿( =
{
¿¿= >
ex
¿¿> @
.
¿¿@ A
Message
¿¿A H
}
¿¿H I
"
¿¿I J
)
¿¿J K
;
¿¿K L&
HandleCommunicationError
¡¡ ,
(
¡¡, -
true
¡¡- 1
)
¡¡1 2
;
¡¡2 3
}
¬¬ 
}
√√ 
}
ƒƒ 	
public
∆∆ 
void
∆∆ 
OnRoundStart
∆∆  
(
∆∆  !
int
∆∆! $
roundNumber
∆∆% 0
,
∆∆0 1
string
∆∆2 8
[
∆∆8 9
]
∆∆9 :
wordOptions
∆∆; F
)
∆∆F G
{
«« 	
Application
»» 
.
»» 
Current
»» 
?
»»  
.
»»  !

Dispatcher
»»! +
.
»»+ ,
Invoke
»», 2
(
»»2 3
(
»»3 4
)
»»4 5
=>
»»6 8
{
…… 
Console
   
.
   
	WriteLine
   !
(
  ! "
$"
  " $
$str
  $ C
{
  C D
roundNumber
  D O
}
  O P
"
  P Q
)
  Q R
;
  R S

RoundStart
ÀÀ 
?
ÀÀ 
.
ÀÀ 
Invoke
ÀÀ "
(
ÀÀ" #
this
ÀÀ# '
,
ÀÀ' (
new
ÀÀ) ,!
RoundStartEventArgs
ÀÀ- @
{
ÀÀA B
RoundNumber
ÀÀC N
=
ÀÀO P
roundNumber
ÀÀQ \
,
ÀÀ\ ]
WordOptions
ÀÀ^ i
=
ÀÀj k
wordOptions
ÀÀl w
}
ÀÀx y
)
ÀÀy z
;
ÀÀz {
}
ÃÃ 
)
ÃÃ 
;
ÃÃ 
}
ÕÕ 	
public
œœ 
void
œœ !
OnDrawingPhaseStart
œœ '
(
œœ' (
int
œœ( +
durationSeconds
œœ, ;
)
œœ; <
{
–– 	
Application
—— 
.
—— 
Current
—— 
?
——  
.
——  !

Dispatcher
——! +
.
——+ ,
Invoke
——, 2
(
——2 3
(
——3 4
)
——4 5
=>
——6 8
{
““ 
Console
”” 
.
”” 
	WriteLine
”” !
(
””! "
$"
””" $
$str
””$ D
{
””D E
durationSeconds
””E T
}
””T U
$str
””U V
"
””V W
)
””W X
;
””X Y
DrawingPhaseStart
‘‘ !
?
‘‘! "
.
‘‘" #
Invoke
‘‘# )
(
‘‘) *
this
‘‘* .
,
‘‘. /
new
‘‘0 3(
DrawingPhaseStartEventArgs
‘‘4 N
{
‘‘O P
DurationSeconds
‘‘Q `
=
‘‘a b
durationSeconds
‘‘c r
}
‘‘s t
)
‘‘t u
;
‘‘u v
}
’’ 
)
’’ 
;
’’ 
}
÷÷ 	
public
ÿÿ 
void
ÿÿ "
OnGuessingPhaseStart
ÿÿ (
(
ÿÿ( )

DrawingDto
ÿÿ) 3
drawing
ÿÿ4 ;
)
ÿÿ; <
{
ŸŸ 	
Application
⁄⁄ 
.
⁄⁄ 
Current
⁄⁄ 
?
⁄⁄  
.
⁄⁄  !

Dispatcher
⁄⁄! +
.
⁄⁄+ ,
Invoke
⁄⁄, 2
(
⁄⁄2 3
(
⁄⁄3 4
)
⁄⁄4 5
=>
⁄⁄6 8
{
€€ 
Console
‹‹ 
.
‹‹ 
	WriteLine
‹‹ !
(
‹‹! "
$"
‹‹" $
$str
‹‹$ P
{
‹‹P Q
drawing
‹‹Q X
.
‹‹X Y
OwnerUsername
‹‹Y f
}
‹‹f g
"
‹‹g h
)
‹‹h i
;
‹‹i j 
GuessingPhaseStart
›› "
?
››" #
.
››# $
Invoke
››$ *
(
››* +
this
››+ /
,
››/ 0
new
››1 4)
GuessingPhaseStartEventArgs
››5 P
{
››Q R
Drawing
››S Z
=
››[ \
drawing
››] d
}
››e f
)
››f g
;
››g h
}
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 	
public
·· 
void
·· &
OnPlayerGuessedCorrectly
·· ,
(
··, -
string
··- 3
username
··4 <
)
··< =
{
‚‚ 	
Application
„„ 
.
„„ 
Current
„„ 
?
„„  
.
„„  !

Dispatcher
„„! +
.
„„+ ,
Invoke
„„, 2
(
„„2 3
(
„„3 4
)
„„4 5
=>
„„6 8
{
‰‰ 
Console
ÂÂ 
.
ÂÂ 
	WriteLine
ÂÂ !
(
ÂÂ! "
$"
ÂÂ" $
$str
ÂÂ$ I
{
ÂÂI J
username
ÂÂJ R
}
ÂÂR S
"
ÂÂS T
)
ÂÂT U
;
ÂÂU V$
PlayerGuessedCorrectly
ÊÊ &
?
ÊÊ& '
.
ÊÊ' (
Invoke
ÊÊ( .
(
ÊÊ. /
this
ÊÊ/ 3
,
ÊÊ3 4
new
ÊÊ5 8$
PlayerGuessedEventArgs
ÊÊ9 O
{
ÊÊP Q
Username
ÊÊR Z
=
ÊÊ[ \
username
ÊÊ] e
}
ÊÊf g
)
ÊÊg h
;
ÊÊh i
}
ÁÁ 
)
ÁÁ 
;
ÁÁ 
}
ËË 	
public
ÍÍ 
void
ÍÍ 
OnTimeUpdate
ÍÍ  
(
ÍÍ  !
int
ÍÍ! $
remainingSeconds
ÍÍ% 5
)
ÍÍ5 6
{
ÎÎ 	
Application
ÏÏ 
.
ÏÏ 
Current
ÏÏ 
?
ÏÏ  
.
ÏÏ  !

Dispatcher
ÏÏ! +
.
ÏÏ+ ,
Invoke
ÏÏ, 2
(
ÏÏ2 3
(
ÏÏ3 4
)
ÏÏ4 5
=>
ÏÏ6 8
{
ÌÌ 

TimeUpdate
ÓÓ 
?
ÓÓ 
.
ÓÓ 
Invoke
ÓÓ "
(
ÓÓ" #
this
ÓÓ# '
,
ÓÓ' (
new
ÓÓ) ,!
TimeUpdateEventArgs
ÓÓ- @
{
ÓÓA B
RemainingSeconds
ÓÓC S
=
ÓÓT U
remainingSeconds
ÓÓV f
}
ÓÓg h
)
ÓÓh i
;
ÓÓi j
}
ÔÔ 
)
ÔÔ 
;
ÔÔ 
}
 	
public
ÚÚ 
void
ÚÚ 

OnRoundEnd
ÚÚ 
(
ÚÚ 
PlayerScoreDto
ÚÚ -
[
ÚÚ- .
]
ÚÚ. /
roundScores
ÚÚ0 ;
,
ÚÚ; <
string
ÚÚ= C
correctWord
ÚÚD O
)
ÚÚO P
{
ÛÛ 	
Application
ÙÙ 
.
ÙÙ 
Current
ÙÙ 
?
ÙÙ  
.
ÙÙ  !

Dispatcher
ÙÙ! +
.
ÙÙ+ ,
Invoke
ÙÙ, 2
(
ÙÙ2 3
(
ÙÙ3 4
)
ÙÙ4 5
=>
ÙÙ6 8
{
ıı 
Console
ˆˆ 
.
ˆˆ 
	WriteLine
ˆˆ !
(
ˆˆ! "
$"
ˆˆ" $
$str
ˆˆ$ H
{
ˆˆH I
correctWord
ˆˆI T
}
ˆˆT U
"
ˆˆU V
)
ˆˆV W
;
ˆˆW X
RoundEnd
˜˜ 
?
˜˜ 
.
˜˜ 
Invoke
˜˜  
(
˜˜  !
this
˜˜! %
,
˜˜% &
new
˜˜' *
RoundEndEventArgs
˜˜+ <
{
˜˜= >
RoundScores
˜˜? J
=
˜˜K L
roundScores
˜˜M X
,
˜˜X Y
CorrectWord
˜˜Z e
=
˜˜f g
correctWord
˜˜h s
}
˜˜t u
)
˜˜u v
;
˜˜v w
}
¯¯ 
)
¯¯ 
;
¯¯ 
}
˘˘ 	
public
˚˚ 
void
˚˚ 
	OnGameEnd
˚˚ 
(
˚˚ 
PlayerScoreDto
˚˚ ,
[
˚˚, -
]
˚˚- .
finalScores
˚˚/ :
)
˚˚: ;
{
¸¸ 	
Application
˝˝ 
.
˝˝ 
Current
˝˝ 
?
˝˝  
.
˝˝  !

Dispatcher
˝˝! +
.
˝˝+ ,
Invoke
˝˝, 2
(
˝˝2 3
(
˝˝3 4
)
˝˝4 5
=>
˝˝6 8
{
˛˛ 
Console
ˇˇ 
.
ˇˇ 
	WriteLine
ˇˇ !
(
ˇˇ! "
$str
ˇˇ" 7
)
ˇˇ7 8
;
ˇˇ8 9
GameEnd
ÄÄ 
?
ÄÄ 
.
ÄÄ 
Invoke
ÄÄ 
(
ÄÄ  
this
ÄÄ  $
,
ÄÄ$ %
new
ÄÄ& )
GameEndEventArgs
ÄÄ* :
{
ÄÄ; <
FinalScores
ÄÄ= H
=
ÄÄI J
finalScores
ÄÄK V
}
ÄÄW X
)
ÄÄX Y
;
ÄÄY Z
}
ÅÅ 
)
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
void
ÑÑ %
OnInGameMessageReceived
ÑÑ +
(
ÑÑ+ ,
string
ÑÑ, 2
sender
ÑÑ3 9
,
ÑÑ9 :
string
ÑÑ; A
message
ÑÑB I
)
ÑÑI J
{
ÖÖ 	
Application
ÜÜ 
.
ÜÜ 
Current
ÜÜ 
?
ÜÜ  
.
ÜÜ  !

Dispatcher
ÜÜ! +
.
ÜÜ+ ,
Invoke
ÜÜ, 2
(
ÜÜ2 3
(
ÜÜ3 4
)
ÜÜ4 5
=>
ÜÜ6 8
{
áá #
InGameMessageReceived
àà %
?
àà% &
.
àà& '
Invoke
àà' -
(
àà- .
this
àà. 2
,
àà2 3
new
àà4 7$
InGameMessageEventArgs
àà8 N
{
ààO P
Sender
ààQ W
=
ààX Y
sender
ààZ `
,
àà` a
Message
ààb i
=
ààj k
message
ààl s
}
ààt u
)
ààu v
;
ààv w
}
ââ 
)
ââ 
;
ââ 
}
ää 	
public
åå 
void
åå !
OnAnswersPhaseStart
åå '
(
åå' (

DrawingDto
åå( 2
[
åå2 3
]
åå3 4
allDrawings
åå5 @
,
åå@ A
GuessDto
ååB J
[
ååJ K
]
ååK L

allGuesses
ååM W
,
ååW X
PlayerScoreDto
ååY g
[
ååg h
]
ååh i
currentScores
ååj w
)
ååw x
{
çç 	
Application
éé 
.
éé 
Current
éé 
?
éé  
.
éé  !

Dispatcher
éé! +
.
éé+ ,
Invoke
éé, 2
(
éé2 3
(
éé3 4
)
éé4 5
=>
éé6 8
{
èè 
Console
êê 
.
êê 
	WriteLine
êê !
(
êê! "
$str
êê" W
)
êêW X
;
êêX Y
AnswersPhaseStart
ëë !
?
ëë! "
.
ëë" #
Invoke
ëë# )
(
ëë) *
this
ëë* .
,
ëë. /
new
ëë0 3(
AnswersPhaseStartEventArgs
ëë4 N
{
íí 
AllDrawings
ìì 
=
ìì  !
allDrawings
ìì" -
,
ìì- .

AllGuesses
îî 
=
îî  

allGuesses
îî! +
,
îî+ ,
	AllScores
ïï 
=
ïï 
currentScores
ïï  -
}
ññ 
)
ññ 
;
ññ 
}
óó 
)
óó 
;
óó 
}
òò 	
public
öö 
void
öö 
OnShowNextDrawing
öö %
(
öö% &

DrawingDto
öö& 0
nextDrawing
öö1 <
)
öö< =
{
õõ 	
Application
úú 
.
úú 
Current
úú 
?
úú  
.
úú  !

Dispatcher
úú! +
.
úú+ ,
Invoke
úú, 2
(
úú2 3
(
úú3 4
)
úú4 5
=>
úú6 8
{
ùù 
Console
ûû 
.
ûû 
	WriteLine
ûû !
(
ûû! "
$"
ûû" $
$str
ûû$ O
{
ûûO P
nextDrawing
ûûP [
.
ûû[ \
	DrawingId
ûû\ e
}
ûûe f
"
ûûf g
)
ûûg h
;
ûûh i
ShowNextDrawing
üü 
?
üü  
.
üü  !
Invoke
üü! '
(
üü' (
this
üü( ,
,
üü, -
new
üü. 1&
ShowNextDrawingEventArgs
üü2 J
{
üüK L
NextDrawing
üüM X
=
üüY Z
nextDrawing
üü[ f
}
üüg h
)
üüh i
;
üüi j
}
†† 
)
†† 
;
†† 
}
°° 	
private
££ 
void
££ 
Channel_Faulted
££ $
(
££$ %
object
££% +
sender
££, 2
,
££2 3
	EventArgs
££4 =
e
££> ?
)
££? @
{
§§ 	
Console
•• 
.
•• 
	WriteLine
•• 
(
•• 
$str
•• U
)
••U V
;
••V W&
HandleCommunicationError
¶¶ $
(
¶¶$ %
true
¶¶% )
)
¶¶) *
;
¶¶* +
}
ßß 	
private
©© 
void
©© 
Channel_Closed
©© #
(
©©# $
object
©©$ *
sender
©©+ 1
,
©©1 2
	EventArgs
©©3 <
e
©©= >
)
©©> ?
{
™™ 	
Console
´´ 
.
´´ 
	WriteLine
´´ 
(
´´ 
$str
´´ J
)
´´J K
;
´´K L
if
¨¨ 
(
¨¨ 
_client
¨¨ 
!=
¨¨ 
null
¨¨ 
)
¨¨  
{
≠≠ &
HandleCommunicationError
ÆÆ (
(
ÆÆ( )
true
ÆÆ) -
)
ÆÆ- .
;
ÆÆ. /
}
ØØ 
}
∞∞ 	
private
≤≤ 
void
≤≤ &
HandleCommunicationError
≤≤ -
(
≤≤- .
bool
≤≤. 2

unexpected
≤≤3 =
=
≤≤> ?
false
≤≤@ E
)
≤≤E F
{
≥≥ 	
Application
¥¥ 
.
¥¥ 
Current
¥¥ 
?
¥¥  
.
¥¥  !

Dispatcher
¥¥! +
.
¥¥+ ,
Invoke
¥¥, 2
(
¥¥2 3
(
¥¥3 4
)
¥¥4 5
=>
¥¥6 8
{
µµ 
Console
∂∂ 
.
∂∂ 
	WriteLine
∂∂ !
(
∂∂! "
$str
∂∂" T
)
∂∂T U
;
∂∂U V
CleanupConnection
∑∑ !
(
∑∑! "
)
∑∑" #
;
∑∑# $
ConnectionLost
∏∏ 
?
∏∏ 
.
∏∏  
Invoke
∏∏  &
(
∏∏& '
)
∏∏' (
;
∏∏( )
if
ππ 
(
ππ 

unexpected
ππ 
)
ππ 
{
∫∫ 

MessageBox
ªª 
.
ªª 
Show
ªª #
(
ªª# $
$str
ªª$ R
,
ªªR S
$str
ªªT f
,
ªªf g
MessageBoxButton
ªªh x
.
ªªx y
OK
ªªy {
,
ªª{ |
MessageBoxImageªª} å
.ªªå ç
Warningªªç î
)ªªî ï
;ªªï ñ
}
ºº 
}
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 	
}
øø 
public
¡¡ 

class
¡¡ !
RoundStartEventArgs
¡¡ $
:
¡¡% &
	EventArgs
¡¡' 0
{
¬¬ 
public
√√ 
int
√√ 
RoundNumber
√√ 
{
√√  
get
√√! $
;
√√$ %
set
√√& )
;
√√) *
}
√√+ ,
public
ƒƒ 
string
ƒƒ 
[
ƒƒ 
]
ƒƒ 
WordOptions
ƒƒ #
{
ƒƒ$ %
get
ƒƒ& )
;
ƒƒ) *
set
ƒƒ+ .
;
ƒƒ. /
}
ƒƒ0 1
}
≈≈ 
public
«« 

class
«« (
DrawingPhaseStartEventArgs
«« +
:
««, -
	EventArgs
««. 7
{
»» 
public
…… 
int
…… 
DurationSeconds
…… "
{
……# $
get
……% (
;
……( )
set
……* -
;
……- .
}
……/ 0
}
   
public
ÃÃ 

class
ÃÃ $
PlayerGuessedEventArgs
ÃÃ '
:
ÃÃ( )
	EventArgs
ÃÃ* 3
{
ÕÕ 
public
ŒŒ 
string
ŒŒ 
Username
ŒŒ 
{
ŒŒ  
get
ŒŒ! $
;
ŒŒ$ %
set
ŒŒ& )
;
ŒŒ) *
}
ŒŒ+ ,
}
œœ 
public
—— 

class
—— !
TimeUpdateEventArgs
—— $
:
——% &
	EventArgs
——' 0
{
““ 
public
”” 
int
”” 
RemainingSeconds
”” #
{
””$ %
get
””& )
;
””) *
set
””+ .
;
””. /
}
””0 1
}
‘‘ 
public
÷÷ 

class
÷÷ 
RoundEndEventArgs
÷÷ "
:
÷÷# $
	EventArgs
÷÷% .
{
◊◊ 
public
ÿÿ 
PlayerScoreDto
ÿÿ 
[
ÿÿ 
]
ÿÿ 
RoundScores
ÿÿ  +
{
ÿÿ, -
get
ÿÿ. 1
;
ÿÿ1 2
set
ÿÿ3 6
;
ÿÿ6 7
}
ÿÿ8 9
public
ŸŸ 
string
ŸŸ 
CorrectWord
ŸŸ !
{
ŸŸ" #
get
ŸŸ$ '
;
ŸŸ' (
set
ŸŸ) ,
;
ŸŸ, -
}
ŸŸ. /
}
⁄⁄ 
public
‹‹ 

class
‹‹ $
InGameMessageEventArgs
‹‹ '
:
‹‹( )
	EventArgs
‹‹* 3
{
›› 
public
ﬁﬁ 
string
ﬁﬁ 
Sender
ﬁﬁ 
{
ﬁﬁ 
get
ﬁﬁ "
;
ﬁﬁ" #
set
ﬁﬁ$ '
;
ﬁﬁ' (
}
ﬁﬁ) *
public
ﬂﬂ 
string
ﬂﬂ 
Message
ﬂﬂ 
{
ﬂﬂ 
get
ﬂﬂ  #
;
ﬂﬂ# $
set
ﬂﬂ% (
;
ﬂﬂ( )
}
ﬂﬂ* +
}
‡‡ 
public
‚‚ 

class
‚‚ (
AnswersPhaseStartEventArgs
‚‚ +
:
‚‚, -
	EventArgs
‚‚. 7
{
„„ 
public
‰‰ 

DrawingDto
‰‰ 
[
‰‰ 
]
‰‰ 
AllDrawings
‰‰ '
{
‰‰( )
get
‰‰* -
;
‰‰- .
set
‰‰/ 2
;
‰‰2 3
}
‰‰4 5
public
ÂÂ 
GuessDto
ÂÂ 
[
ÂÂ 
]
ÂÂ 

AllGuesses
ÂÂ $
{
ÂÂ% &
get
ÂÂ' *
;
ÂÂ* +
set
ÂÂ, /
;
ÂÂ/ 0
}
ÂÂ1 2
public
ÊÊ 
PlayerScoreDto
ÊÊ 
[
ÊÊ 
]
ÊÊ 
	AllScores
ÊÊ  )
{
ÊÊ* +
get
ÊÊ, /
;
ÊÊ/ 0
set
ÊÊ1 4
;
ÊÊ4 5
}
ÊÊ6 7
}
ÁÁ 
public
ÈÈ 

class
ÈÈ &
ShowNextDrawingEventArgs
ÈÈ )
:
ÈÈ* +
	EventArgs
ÈÈ, 5
{
ÍÍ 
public
ÎÎ 

DrawingDto
ÎÎ 
NextDrawing
ÎÎ %
{
ÎÎ& '
get
ÎÎ( +
;
ÎÎ+ ,
set
ÎÎ- 0
;
ÎÎ0 1
}
ÎÎ2 3
}
ÏÏ 
public
ÓÓ 

class
ÓÓ )
GuessingPhaseStartEventArgs
ÓÓ ,
:
ÓÓ- .
	EventArgs
ÓÓ/ 8
{
ÔÔ 
public
 

DrawingDto
 
Drawing
 !
{
" #
get
$ '
;
' (
set
) ,
;
, -
}
. /
}
ÒÒ 
public
ÛÛ 

class
ÛÛ 
GameEndEventArgs
ÛÛ !
:
ÛÛ" #
	EventArgs
ÛÛ$ -
{
ÙÙ 
public
ıı 
PlayerScoreDto
ıı 
[
ıı 
]
ıı 
FinalScores
ıı  +
{
ıı, -
get
ıı. 1
;
ıı1 2
set
ıı3 6
;
ıı6 7
}
ıı8 9
}
ˆˆ 
}˜˜ Ày
°C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Match\WordSelectionViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Match& +
{ 
internal 
class "
WordSelectionViewModel )
:* +
ViewModelBase, 9
{ 
private 
DispatcherTimer 
_countdownTimer  /
;/ 0
private 
bool  
_wordHasBeenSelected )
;) *
private 
string 
_word1 
; 
public 
string 
Word1 
{ 	
get 
{ 
return 
_word1 
;  
}! "
set 
{ 
_word1 
= 
value  
;  !
OnPropertyChanged" 3
(3 4
)4 5
;5 6
}7 8
} 	
private 
string 
_word2 
; 
public 
string 
Word2 
{ 	
get 
{ 
return 
_word2 
;  
}! "
set 
{ 
_word2 
= 
value  
;  !
OnPropertyChanged" 3
(3 4
)4 5
;5 6
}7 8
} 	
private   
string   
_word3   
;   
public!! 
string!! 
Word3!! 
{"" 	
get## 
{## 
return## 
_word3## 
;##  
}##! "
set$$ 
{$$ 
_word3$$ 
=$$ 
value$$  
;$$  !
OnPropertyChanged$$" 3
($$3 4
)$$4 5
;$$5 6
}$$7 8
}%% 	
private'' 
int'' 
_countdownTime'' "
;''" #
public(( 
int(( 
CountdownTime((  
{)) 	
get** 
{** 
return** 
_countdownTime** '
;**' (
}**) *
set++ 
{++ 
_countdownTime++  
=++! "
value++# (
;++( )
OnPropertyChanged++* ;
(++; <
)++< =
;++= >
}++? @
},, 	
public.. 
ICommand.. 
SelectWordCommand.. )
{..* +
get.., /
;../ 0
}..1 2
public// 
ICommand// 
CloseWindowCommand// *
{//+ ,
get//- 0
;//0 1
}//2 3
public00 
ICommand00 !
MaximizeWindowCommand00 -
{00. /
get000 3
;003 4
}005 6
public11 
ICommand11 !
MinimizeWindowCommand11 -
{11. /
get110 3
;113 4
}115 6
public33 "
WordSelectionViewModel33 %
(33% &
)33& '
{44 	 
_wordHasBeenSelected55  
=55! "
false55# (
;55( )
CountdownTime66 
=66 
$num66 
;66 
SelectWordCommand88 
=88 
new88  #
RelayCommand88$ 0
(880 1

SelectWord881 ;
,88; <
CanSelectWord88= J
)88J K
;88K L
CloseWindowCommand99 
=99  
new99! $
RelayCommand99% 1
(991 2
ExecuteCloseWindow992 D
)99D E
;99E F!
MaximizeWindowCommand:: !
=::" #
new::$ '
RelayCommand::( 4
(::4 5!
ExecuteMaximizeWindow::5 J
)::J K
;::K L!
MinimizeWindowCommand;; !
=;;" #
new;;$ '
RelayCommand;;( 4
(;;4 5!
ExecuteMinimizeWindow;;5 J
);;J K
;;;K L
GameClientManager== 
.== 
Instance== &
.==& '
ConnectionLost==' 5
+===6 8 
HandleConnectionLost==9 M
;==M N
_countdownTimer?? 
=?? 
new?? !
DispatcherTimer??" 1
(??1 2
)??2 3
;??3 4
_countdownTimer@@ 
.@@ 
Interval@@ $
=@@% &
TimeSpan@@' /
.@@/ 0
FromSeconds@@0 ;
(@@; <
$num@@< =
)@@= >
;@@> ?
_countdownTimerAA 
.AA 
TickAA  
+=AA! #
OnTimerTickAA$ /
;AA/ 0
	LoadWordsCC 
(CC 
)CC 
;CC 
}DD 	
privateFF 
boolFF 
CanSelectWordFF "
(FF" #
objectFF# )
	parameterFF* 3
)FF3 4
{GG 	
returnHH 
!HH  
_wordHasBeenSelectedHH (
&&HH) +
!II 
stringII 
.II 
IsNullOrEmptyII (
(II( )
	parameterII) 2
asII3 5
stringII6 <
)II< =
&&II> @
!JJ 
(JJ 
	parameterJJ 
asJJ !
stringJJ" (
)JJ( )
.JJ) *
ContainsJJ* 2
(JJ2 3
$strJJ3 <
)JJ< =
;JJ= >
}KK 	
privateMM 
asyncMM 
voidMM 
	LoadWordsMM $
(MM$ %
)MM% &
{NN 	
tryOO 
{PP 
WordDtoQQ 
[QQ 
]QQ 
wordsQQ 
=QQ  !
awaitQQ" '
GameClientManagerQQ( 9
.QQ9 :
InstanceQQ: B
.QQB C
GetRandomWordsAsyncQQC V
(QQV W
)QQW X
;QQX Y
ifSS 
(SS 
wordsSS 
!=SS 
nullSS !
&&SS" $
wordsSS% *
.SS* +
LengthSS+ 1
>=SS2 4
$numSS5 6
)SS6 7
{TT 
Word1UU 
=UU 
wordsUU !
[UU! "
$numUU" #
]UU# $
.UU$ %
WordKeyUU% ,
;UU, -
Word2VV 
=VV 
wordsVV !
[VV! "
$numVV" #
]VV# $
.VV$ %
WordKeyVV% ,
;VV, -
Word3WW 
=WW 
wordsWW !
[WW! "
$numWW" #
]WW# $
.WW$ %
WordKeyWW% ,
;WW, -
_countdownTimerYY #
.YY# $
StartYY$ )
(YY) *
)YY* +
;YY+ ,
}ZZ 
else[[ 
{\\ 

MessageBox]] 
.]] 
Show]] #
(]]# $
$str]]$ K
,]]K L
$str]]M T
,]]T U
MessageBoxButton]]V f
.]]f g
OK]]g i
,]]i j
MessageBoxImage]]k z
.]]z {
Warning	]]{ Ç
)
]]Ç É
;
]]É Ñ
}^^ 
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 

MessageBoxbb 
.bb 
Showbb 
(bb  
$"bb  "
$strbb" 7
{bb7 8
exbb8 :
.bb: ;
Messagebb; B
}bbB C
"bbC D
,bbD E
$strbbF X
,bbX Y
MessageBoxButtonbbZ j
.bbj k
OKbbk m
,bbm n
MessageBoxImagebbo ~
.bb~ 
Error	bb Ñ
)
bbÑ Ö
;
bbÖ Ü
}cc 
}dd 	
privateff 
voidff 
OnTimerTickff  
(ff  !
objectff! '
senderff( .
,ff. /
	EventArgsff0 9
eff: ;
)ff; <
{gg 	
CountdownTimehh 
--hh 
;hh 
ifjj 
(jj 
CountdownTimejj 
<=jj  
$numjj! "
)jj" #
{kk 
_countdownTimerll 
.ll  
Stopll  $
(ll$ %
)ll% &
;ll& '
ifnn 
(nn 
!nn 
stringnn 
.nn 
IsNullOrEmptynn )
(nn) *
Word1nn* /
)nn/ 0
)nn0 1
{oo 
HandleWordSelectionpp '
(pp' (
Word1pp( -
)pp- .
;pp. /
}qq 
elserr 
{ss 

MessageBoxtt 
.tt 
Showtt #
(tt# $
$strtt$ V
,ttV W
$strttX _
,tt_ `
MessageBoxButtontta q
.ttq r
OKttr t
,ttt u
MessageBoxImage	ttv Ö
.
ttÖ Ü
Error
ttÜ ã
)
ttã å
;
ttå ç 
HandleConnectionLostuu (
(uu( )
)uu) *
;uu* +
}vv 
}ww 
}xx 	
privatezz 
voidzz 

SelectWordzz 
(zz  
objectzz  &
	parameterzz' 0
)zz0 1
{{{ 	
_countdownTimer|| 
.|| 
Stop||  
(||  !
)||! "
;||" #
HandleWordSelection}} 
(}}  
	parameter}}  )
as}}* ,
string}}- 3
)}}3 4
;}}4 5
}~~ 	
private
ÄÄ 
void
ÄÄ !
HandleWordSelection
ÄÄ (
(
ÄÄ( )
string
ÄÄ) /
selectedWord
ÄÄ0 <
)
ÄÄ< =
{
ÅÅ 	
if
ÇÇ 
(
ÇÇ "
_wordHasBeenSelected
ÇÇ $
)
ÇÇ$ %
return
ÇÇ& ,
;
ÇÇ, -"
_wordHasBeenSelected
ÉÉ  
=
ÉÉ! "
true
ÉÉ# '
;
ÉÉ' (
_countdownTimer
ÖÖ 
?
ÖÖ 
.
ÖÖ 
Stop
ÖÖ !
(
ÖÖ! "
)
ÖÖ" #
;
ÖÖ# $
if
áá 
(
áá 
string
áá 
.
áá 
IsNullOrEmpty
áá $
(
áá$ %
selectedWord
áá% 1
)
áá1 2
)
áá2 3
return
áá4 :
;
áá: ;
try
ââ 
{
ää 
GameClientManager
ãã !
.
ãã! "
Instance
ãã" *
.
ãã* +

SelectWord
ãã+ 5
(
ãã5 6
selectedWord
ãã6 B
)
ããB C
;
ããC D
Window
çç 
currentWindow
çç $
=
çç% &
Application
çç' 2
.
çç2 3
Current
çç3 :
.
çç: ;
Windows
çç; B
.
éé 
OfType
éé 
<
éé 
WordSelectionView
éé -
>
éé- .
(
éé. /
)
éé/ 0
.
èè 
FirstOrDefault
èè #
(
èè# $
)
èè$ %
;
èè% &
if
ëë 
(
ëë 
currentWindow
ëë !
!=
ëë" $
null
ëë% )
)
ëë) *
{
íí 
ServiceLocator
ìì "
.
ìì" #

Navigation
ìì# -
.
ìì- .%
NavigateToDrawingScreen
ìì. E
(
ììE F
selectedWord
ììF R
)
ììR S
;
ììS T
currentWindow
îî !
.
îî! "
Close
îî" '
(
îî' (
)
îî( )
;
îî) *
}
ïï 
}
ññ 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
òò 

MessageBox
ôô 
.
ôô 
Show
ôô 
(
ôô  
$"
ôô  "
$str
ôô" 8
{
ôô8 9
ex
ôô9 ;
.
ôô; <
Message
ôô< C
}
ôôC D
"
ôôD E
,
ôôE F
$str
ôôG N
,
ôôN O
MessageBoxButton
ôôP `
.
ôô` a
OK
ôôa c
,
ôôc d
MessageBoxImage
ôôe t
.
ôôt u
Error
ôôu z
)
ôôz {
;
ôô{ |
}
öö 
}
õõ 	
private
ùù 
void
ùù "
HandleConnectionLost
ùù )
(
ùù) *
)
ùù* +
{
ûû 	
Application
üü 
.
üü 
Current
üü 
?
üü  
.
üü  !

Dispatcher
üü! +
.
üü+ ,
Invoke
üü, 2
(
üü2 3
(
üü3 4
)
üü4 5
=>
üü6 8
{
†† 
Cleanup
°° 
(
°° 
)
°° 
;
°° 

MessageBox
¢¢ 
.
¢¢ 
Show
¢¢ 
(
¢¢  
$str
¢¢  I
,
¢¢I J
$str
¢¢K ]
,
¢¢] ^
MessageBoxButton
¢¢_ o
.
¢¢o p
OK
¢¢p r
,
¢¢r s
MessageBoxImage¢¢t É
.¢¢É Ñ
Warning¢¢Ñ ã
)¢¢ã å
;¢¢å ç
Application
££ 
.
££ 
Current
££ #
.
££# $
Shutdown
££$ ,
(
££, -
)
££- .
;
££. /
}
§§ 
)
§§ 
;
§§ 
}
•• 	
private
ßß 
void
ßß 
Cleanup
ßß 
(
ßß 
)
ßß 
{
®® 	
if
©© 
(
©© 
_countdownTimer
©© 
!=
©©  "
null
©©# '
)
©©' (
{
™™ 
_countdownTimer
´´ 
.
´´  
Stop
´´  $
(
´´$ %
)
´´% &
;
´´& '
_countdownTimer
¨¨ 
.
¨¨  
Tick
¨¨  $
-=
¨¨% '
OnTimerTick
¨¨( 3
;
¨¨3 4
}
≠≠ 
GameClientManager
ØØ 
.
ØØ 
Instance
ØØ &
.
ØØ& '
ConnectionLost
ØØ' 5
-=
ØØ6 8"
HandleConnectionLost
ØØ9 M
;
ØØM N
}
∞∞ 	
private
≤≤ 
void
≤≤  
ExecuteCloseWindow
≤≤ '
(
≤≤' (
object
≤≤( .
	parameter
≤≤/ 8
)
≤≤8 9
{
≥≥ 	
if
¥¥ 
(
¥¥ 
	parameter
¥¥ 
is
¥¥ 
Window
¥¥ #
)
¥¥# $
{
µµ 
Cleanup
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂ 
GameClientManager
∑∑ !
.
∑∑! "
Instance
∑∑" *
.
∑∑* +

Disconnect
∑∑+ 5
(
∑∑5 6
)
∑∑6 7
;
∑∑7 8
Application
∏∏ 
.
∏∏ 
Current
∏∏ #
.
∏∏# $
Shutdown
∏∏$ ,
(
∏∏, -
)
∏∏- .
;
∏∏. /
}
ππ 
}
∫∫ 	
private
ºº 
void
ºº #
ExecuteMaximizeWindow
ºº *
(
ºº* +
object
ºº+ 1
	parameter
ºº2 ;
)
ºº; <
{
ΩΩ 	
if
ææ 
(
ææ 
	parameter
ææ 
is
ææ 
Window
ææ #
window
ææ$ *
)
ææ* +
{
øø 
window
¿¿ 
.
¿¿ 
WindowState
¿¿ "
=
¿¿# $
window
¿¿% +
.
¿¿+ ,
WindowState
¿¿, 7
==
¿¿8 :
WindowState
¿¿; F
.
¿¿F G
	Maximized
¿¿G P
?
¡¡ 
WindowState
¡¡ !
.
¡¡! "
Normal
¡¡" (
:
¬¬ 
WindowState
¬¬ !
.
¬¬! "
	Maximized
¬¬" +
;
¬¬+ ,
}
√√ 
}
ƒƒ 	
private
∆∆ 
void
∆∆ #
ExecuteMinimizeWindow
∆∆ *
(
∆∆* +
object
∆∆+ 1
	parameter
∆∆2 ;
)
∆∆; <
{
«« 	
if
»» 
(
»» 
	parameter
»» 
is
»» 
Window
»» #
window
»»$ *
)
»»* +
{
…… 
window
   
.
   
WindowState
   "
=
  # $
WindowState
  % 0
.
  0 1
	Minimized
  1 :
;
  : ;
}
ÀÀ 
}
ÃÃ 	
}
ÕÕ 
}ŒŒ “#
•C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Match\WaitingForGuessesViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Match& +
{ 
public 

class &
WaitingForGuessesViewModel +
:, -
ViewModelBase. ;
{		 
private

 
string

 
_word

 
;

 
public 
string 
Word 
{ 	
get 
=> 
_word 
; 
set 
{ 
_word 
= 
value 
;  
OnPropertyChanged! 2
(2 3
)3 4
;4 5
}6 7
} 	
public &
WaitingForGuessesViewModel )
() *
string* 0
word1 5
)5 6
{ 	
Word 
= 
word 
; 
GameClientManager 
. 
Instance &
.& '
ShowNextDrawing' 6
+=7 9%
OnShowNextDrawing_Handler: S
;S T
GameClientManager 
. 
Instance &
.& '
AnswersPhaseStart' 8
+=9 ;'
OnAnswersPhaseStart_Handler< W
;W X
GameClientManager 
. 
Instance &
.& '
ConnectionLost' 5
+=6 8$
OnConnectionLost_Handler9 Q
;Q R
} 	
private 
void %
OnShowNextDrawing_Handler .
(. /
object/ 5
sender6 <
,< =$
ShowNextDrawingEventArgs> V
eW X
)X Y
{ 	
string 

myUsername 
= 
GameClientManager  1
.1 2
Instance2 :
.: ;
GetCurrentUsername; M
(M N
)N O
;O P
if 
( 
e 
. 
NextDrawing 
. 
OwnerUsername +
==, .

myUsername/ 9
)9 :
{ 
ServiceLocator   
.   

Navigation   )
.  ) *'
NavigateToWaitingForGuesses  * E
(  E F
e  F G
.  G H
NextDrawing  H S
.  S T
WordKey  T [
)  [ \
;  \ ]
}!! 
else"" 
{## 
ServiceLocator$$ 
.$$ 

Navigation$$ )
.$$) *
NavigateToNextGuess$$* =
($$= >
e$$> ?
.$$? @
NextDrawing$$@ K
)$$K L
;$$L M
}%% 
}&& 	
private(( 
void(( '
OnAnswersPhaseStart_Handler(( 0
(((0 1
object((1 7
sender((8 >
,((> ?&
AnswersPhaseStartEventArgs((@ Z
e(([ \
)((\ ]
{)) 	
Cleanup** 
(** 
)** 
;** 
ServiceLocator++ 
.++ 

Navigation++ %
.++% &
NavigateToAnswers++& 7
(++7 8
e++8 9
.++9 :
AllDrawings++: E
,++E F
e++G H
.++H I

AllGuesses++I S
,++S T
e++U V
.++V W
	AllScores++W `
)++` a
;++a b
},, 	
private.. 
void.. $
OnConnectionLost_Handler.. -
(..- .
)... /
{// 	
Cleanup00 
(00 
)00 
;00 
ServiceLocator11 
.11 

Navigation11 %
.11% &"
CloseCurrentGameWindow11& <
(11< =
)11= >
;11> ?
}22 	
private44 
void44 
Cleanup44 
(44 
)44 
{55 	
GameClientManager66 
.66 
Instance66 &
.66& '
ShowNextDrawing66' 6
-=667 9%
OnShowNextDrawing_Handler66: S
;66S T
GameClientManager77 
.77 
Instance77 &
.77& '
AnswersPhaseStart77' 8
-=779 ;'
OnAnswersPhaseStart_Handler77< W
;77W X
GameClientManager88 
.88 
Instance88 &
.88& '
ConnectionLost88' 5
-=886 8$
OnConnectionLost_Handler889 Q
;88Q R
}99 	
}:: 
};; ö
ëC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\RelayCommand.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
{ 
public 

class 
RelayCommand 
: 
ICommand  (
{ 
private 
readonly 
Action 
<  
object  &
>& '
_execute( 0
;0 1
private		 
readonly		 
	Predicate		 "
<		" #
object		# )
>		) *
_canExecute		+ 6
;		6 7
public 
RelayCommand 
( 
Action "
<" #
object# )
>) *
execute+ 2
,2 3
	Predicate4 =
<= >
object> D
>D E

canExecuteF P
=Q R
nullS W
)W X
{ 	
_execute 
= 
execute 
?? !
throw" '
new( +!
ArgumentNullException, A
(A B
nameofB H
(H I
executeI P
)P Q
)Q R
;R S
_canExecute 
= 

canExecute $
;$ %
} 	
public 
event 
EventHandler !
CanExecuteChanged" 3
{ 	
add 
{ 
CommandManager 
. 
RequerySuggested /
+=0 2
value3 8
;8 9
} 
remove 
{ 
CommandManager 
. 
RequerySuggested /
-=0 2
value3 8
;8 9
} 
} 	
public 
bool 

CanExecute 
( 
object %
	parameter& /
)/ 0
{ 	
return 
_canExecute 
== !
null" &
||' )
_canExecute* 5
(5 6
	parameter6 ?
)? @
;@ A
}   	
public"" 
void"" 
Execute"" 
("" 
object"" "
	parameter""# ,
)"", -
{## 	
_execute$$ 
($$ 
	parameter$$ 
)$$ 
;$$  
}%% 	
}&& 
}'' Ûd
†C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Match\GuessTheWordViewModel.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
Match

& +
{ 
internal 
class !
GuessTheWordViewModel (
:) *
ViewModelBase+ 8
{ 
private 
StrokeCollection  
_drawingToGuess! 0
;0 1
public 
StrokeCollection 
DrawingToGuess  .
{ 	
get 
{ 
return 
_drawingToGuess (
;( )
}* +
set 
{ 
_drawingToGuess !
=" #
value$ )
;) *
OnPropertyChanged+ <
(< =
)= >
;> ?
}@ A
} 	
private 
string 

_userGuess !
;! "
public 
string 
	UserGuess 
{ 	
get 
{ 
return 

_userGuess #
;# $
}% &
set 
{ 

_userGuess 
= 
value "
;" #
OnPropertyChanged !
(! "
)" #
;# $
} 
} 	
private   
bool   

_guessSent   
;    
private!! 
readonly!! 
int!! 

_drawingId!! '
;!!' (
public## 
ICommand## 
ConfirmGuessCommand## +
{##, -
get##. 1
;##1 2
}##3 4
public$$ 
ICommand$$ 
CloseWindowCommand$$ *
{$$+ ,
get$$- 0
;$$0 1
}$$2 3
public%% 
ICommand%% !
MaximizeWindowCommand%% -
{%%. /
get%%0 3
;%%3 4
}%%5 6
public&& 
ICommand&& !
MinimizeWindowCommand&& -
{&&. /
get&&0 3
;&&3 4
}&&5 6
public(( !
GuessTheWordViewModel(( $
((($ %
)((% &
{)) 	

_guessSent** 
=** 
false** 
;** 
ConfirmGuessCommand++ 
=++  !
new++" %
RelayCommand++& 2
(++2 3
ExecuteConfirmGuess++3 F
,++F G"
CanExecuteConfirmGuess++H ^
)++^ _
;++_ `
CloseWindowCommand,, 
=,,  
new,,! $
RelayCommand,,% 1
(,,1 2
ExecuteCloseWindow,,2 D
),,D E
;,,E F!
MaximizeWindowCommand-- !
=--" #
new--$ '
RelayCommand--( 4
(--4 5!
ExecuteMaximizeWindow--5 J
)--J K
;--K L!
MinimizeWindowCommand.. !
=.." #
new..$ '
RelayCommand..( 4
(..4 5!
ExecuteMinimizeWindow..5 J
)..J K
;..K L
DrawingToGuess// 
=// 
new//  
StrokeCollection//! 1
(//1 2
)//2 3
;//3 4
	UserGuess00 
=00 
string00 
.00 
Empty00 $
;00$ %
}11 	
public33 !
GuessTheWordViewModel33 $
(33$ %

DrawingDto33% /
drawing330 7
)337 8
:339 :
this33; ?
(33? @
)33@ A
{44 	
if55 
(55 
drawing55 
==55 
null55 
)55  
{66 

MessageBox77 
.77 
Show77 
(77  
$str77  F
,77F G
$str77H O
,77O P
MessageBoxButton77Q a
.77a b
OK77b d
,77d e
MessageBoxImage77f u
.77u v
Error77v {
)77{ |
;77| }
return88 
;88 
}99 

_drawingId;; 
=;; 
drawing;;  
.;;  !
	DrawingId;;! *
;;;* + 
LoadDrawingFromBytes<<  
(<<  !
drawing<<! (
.<<( )
DrawingData<<) 4
)<<4 5
;<<5 6
GameClientManager>> 
.>> 
Instance>> &
.>>& '
ShowNextDrawing>>' 6
+=>>7 9%
OnShowNextDrawing_Handler>>: S
;>>S T
GameClientManager?? 
.?? 
Instance?? &
.??& '
AnswersPhaseStart??' 8
+=??9 ;'
OnAnswersPhaseStart_Handler??< W
;??W X
GameClientManager@@ 
.@@ 
Instance@@ &
.@@& '
ConnectionLost@@' 5
+=@@6 8$
OnConnectionLost_Handler@@9 Q
;@@Q R
}AA 	
privateCC 
voidCC  
LoadDrawingFromBytesCC )
(CC) *
byteCC* .
[CC. /
]CC/ 0
drawingDataCC1 <
)CC< =
{DD 	
ifEE 
(EE 
drawingDataEE 
==EE 
nullEE #
||EE$ &
drawingDataEE' 2
.EE2 3
LengthEE3 9
==EE: <
$numEE= >
)EE> ?
{FF 
DrawingToGuessGG 
=GG  
newGG! $
StrokeCollectionGG% 5
(GG5 6
)GG6 7
;GG7 8
returnHH 
;HH 
}II 
tryKK 
{LL 
usingMM 
(MM 
varMM 
msMM 
=MM 
newMM  #
MemoryStreamMM$ 0
(MM0 1
drawingDataMM1 <
)MM< =
)MM= >
{NN 
DrawingToGuessOO "
=OO# $
newOO% (
StrokeCollectionOO) 9
(OO9 :
msOO: <
)OO< =
;OO= >
}PP 
}QQ 
catchRR 
(RR 
	ExceptionRR 
exRR 
)RR  
{SS 

MessageBoxTT 
.TT 
ShowTT 
(TT  
$"TT  "
$strTT" B
{TTB C
exTTC E
.TTE F
MessageTTF M
}TTM N
"TTN O
)TTO P
;TTP Q
DrawingToGuessUU 
=UU  
newUU! $
StrokeCollectionUU% 5
(UU5 6
)UU6 7
;UU7 8
}VV 
}WW 	
privateYY 
boolYY "
CanExecuteConfirmGuessYY +
(YY+ ,
objectYY, 2
	parameterYY3 <
)YY< =
{ZZ 	
return[[ 
![[ 

_guessSent[[ 
&&[[ !
![[" #
string[[# )
.[[) *
IsNullOrWhiteSpace[[* <
([[< =
	UserGuess[[= F
)[[F G
;[[G H
}\\ 	
private^^ 
void^^ 
ExecuteConfirmGuess^^ (
(^^( )
object^^) /
	parameter^^0 9
)^^9 :
{__ 	

_guessSent`` 
=`` 
true`` 
;`` 
trybb 
{cc 
GameClientManagerdd !
.dd! "
Instancedd" *
.dd* +
SubmitGuessdd+ 6
(dd6 7
	UserGuessdd7 @
,dd@ A

_drawingIdddB L
)ddL M
;ddM N
	UserGuessee 
=ee 
$stree G
;eeG H
OnPropertyChangedff !
(ff! "
nameofff" (
(ff( )
	UserGuessff) 2
)ff2 3
)ff3 4
;ff4 5
}gg 
catchhh 
(hh 
	Exceptionhh 
exhh 
)hh  
{ii 

MessageBoxjj 
.jj 
Showjj 
(jj  
$"jj  "
$strjj" 8
{jj8 9
exjj9 ;
.jj; <
Messagejj< C
}jjC D
"jjD E
)jjE F
;jjF G

_guessSentkk 
=kk 
falsekk "
;kk" #
}ll 
}mm 	
privateoo 
voidoo %
OnShowNextDrawing_Handleroo .
(oo. /
objectoo/ 5
senderoo6 <
,oo< =$
ShowNextDrawingEventArgsoo> V
eooW X
)ooX Y
{pp 	
stringqq 

myUsernameqq 
=qq 
GameClientManagerqq  1
.qq1 2
Instanceqq2 :
.qq: ;
GetCurrentUsernameqq; M
(qqM N
)qqN O
;qqO P
ifrr 
(rr 
err 
.rr 
NextDrawingrr 
.rr 
OwnerUsernamerr +
==rr, .

myUsernamerr/ 9
)rr9 :
{ss 
ServiceLocatortt 
.tt 

Navigationtt )
.tt) *'
NavigateToWaitingForGuessestt* E
(ttE F
ettF G
.ttG H
NextDrawingttH S
.ttS T
WordKeyttT [
)tt[ \
;tt\ ]
}uu 
elsevv 
{ww 
ServiceLocatorxx 
.xx 

Navigationxx )
.xx) *
NavigateToNextGuessxx* =
(xx= >
exx> ?
.xx? @
NextDrawingxx@ K
)xxK L
;xxL M
}yy 
}zz 	
private|| 
void|| '
OnAnswersPhaseStart_Handler|| 0
(||0 1
object||1 7
sender||8 >
,||> ?&
AnswersPhaseStartEventArgs||@ Z
e||[ \
)||\ ]
{}} 	
Cleanup~~ 
(~~ 
)~~ 
;~~ 
ServiceLocator 
. 

Navigation %
.% &
NavigateToAnswers& 7
(7 8
e8 9
.9 :
AllDrawings: E
,E F
eG H
.H I

AllGuessesI S
,S T
eU V
.V W
	AllScoresW `
)` a
;a b
}
ÄÄ 	
private
ÇÇ 
void
ÇÇ &
OnConnectionLost_Handler
ÇÇ -
(
ÇÇ- .
)
ÇÇ. /
{
ÉÉ 	
Cleanup
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
ServiceLocator
ÖÖ 
.
ÖÖ 

Navigation
ÖÖ %
.
ÖÖ% &$
CloseCurrentGameWindow
ÖÖ& <
(
ÖÖ< =
)
ÖÖ= >
;
ÖÖ> ?
}
ÜÜ 	
private
àà 
void
àà 
Cleanup
àà 
(
àà 
)
àà 
{
ââ 	
GameClientManager
ää 
.
ää 
Instance
ää &
.
ää& '
ShowNextDrawing
ää' 6
-=
ää7 9'
OnShowNextDrawing_Handler
ää: S
;
ääS T
GameClientManager
ãã 
.
ãã 
Instance
ãã &
.
ãã& '
AnswersPhaseStart
ãã' 8
-=
ãã9 ;)
OnAnswersPhaseStart_Handler
ãã< W
;
ããW X
GameClientManager
åå 
.
åå 
Instance
åå &
.
åå& '
ConnectionLost
åå' 5
-=
åå6 8&
OnConnectionLost_Handler
åå9 Q
;
ååQ R
}
çç 	
private
èè 
void
èè  
ExecuteCloseWindow
èè '
(
èè' (
object
èè( .
	parameter
èè/ 8
)
èè8 9
{
êê 	
Cleanup
ëë 
(
ëë 
)
ëë 
;
ëë 
GameClientManager
íí 
.
íí 
Instance
íí &
.
íí& '

Disconnect
íí' 1
(
íí1 2
)
íí2 3
;
íí3 4
ServiceLocator
ìì 
.
ìì 

Navigation
ìì %
.
ìì% &$
CloseCurrentGameWindow
ìì& <
(
ìì< =
)
ìì= >
;
ìì> ?
}
îî 	
private
ññ 
static
ññ 
void
ññ #
ExecuteMaximizeWindow
ññ 1
(
ññ1 2
object
ññ2 8
	parameter
ññ9 B
)
ññB C
{
óó 	
if
òò 
(
òò 
	parameter
òò 
is
òò 
Window
òò #
window
òò$ *
)
òò* +
{
ôô 
window
öö 
.
öö 
WindowState
öö "
=
öö# $
window
öö% +
.
öö+ ,
WindowState
öö, 7
==
öö8 :
WindowState
öö; F
.
ööF G
	Maximized
ööG P
?
ööQ R
WindowState
ööS ^
.
öö^ _
Normal
öö_ e
:
ööf g
WindowState
ööh s
.
öös t
	Maximized
ööt }
;
öö} ~
}
õõ 
}
úú 	
private
ûû 
static
ûû 
void
ûû #
ExecuteMinimizeWindow
ûû 1
(
ûû1 2
object
ûû2 8
	parameter
ûû9 B
)
ûûB C
{
üü 	
if
†† 
(
†† 
	parameter
†† 
is
†† 
Window
†† #
window
††$ *
)
††* +
{
°° 
window
¢¢ 
.
¢¢ 
WindowState
¢¢ "
=
¢¢# $
WindowState
¢¢% 0
.
¢¢0 1
	Minimized
¢¢1 :
;
¢¢: ;
}
££ 
}
§§ 	
}
•• 
}¶¶ ¢
ûC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Match\EndOfMatchViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Match& +
{ 
public 

class 
EndOfMatchViewModel $
:% &
ViewModelBase' 4
{ 
private		 
string		 
_winnerName		 "
;		" #
public

 
string

 

WinnerName

  
{ 	
get 
=> 
_winnerName 
; 
set 
{ 
_winnerName 
= 
value  %
;% &
OnPropertyChanged' 8
(8 9
nameof9 ?
(? @

WinnerName@ J
)J K
)K L
;L M
}N O
} 	
private 
string !
_firstPlacePlayerName ,
;, -
public 
string  
FirstPlacePlayerName *
{ 	
get 
=> !
_firstPlacePlayerName (
;( )
set 
{ !
_firstPlacePlayerName '
=( )
value* /
;/ 0
OnPropertyChanged1 B
(B C
nameofC I
(I J 
FirstPlacePlayerNameJ ^
)^ _
)_ `
;` a
}b c
} 	
private 
string "
_secondPlacePlayerName -
;- .
public 
string !
SecondPlacePlayerName +
{ 	
get 
=> "
_secondPlacePlayerName )
;) *
set 
{ "
_secondPlacePlayerName (
=) *
value+ 0
;0 1
OnPropertyChanged2 C
(C D
nameofD J
(J K!
SecondPlacePlayerNameK `
)` a
)a b
;b c
}d e
} 	
private 
string !
_thirdPlacePlayerName ,
;, -
public 
string  
ThirdPlacePlayerName *
{   	
get!! 
=>!! !
_thirdPlacePlayerName!! (
;!!( )
set"" 
{"" !
_thirdPlacePlayerName"" '
=""( )
value""* /
;""/ 0
OnPropertyChanged""1 B
(""B C
nameof""C I
(""I J 
ThirdPlacePlayerName""J ^
)""^ _
)""_ `
;""` a
}""b c
}## 	
public%% 
ICommand%% 
ExitCommand%% #
{%%$ %
get%%& )
;%%) *
}%%+ ,
public'' 
EndOfMatchViewModel'' "
(''" #
)''# $
{(( 	
ExitCommand)) 
=)) 
new)) 
RelayCommand)) *
())* +
OnExit))+ 1
,))1 2
CanExit))3 :
))): ;
;)); <
}** 	
private,, 
void,, 
OnExit,, 
(,, 
object,, "
	parameter,,# ,
),,, -
{-- 	
}.. 	
private00 
bool00 
CanExit00 
(00 
object00 #
	parameter00$ -
)00- .
{11 	
return22 
true22 
;22 
}33 	
}55 
}66 ⁄˚
°C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Match\DrawingScreenViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Match& +
{ 
public 

enum 
DrawingTool 
{ 
Pencil 
, 
Eraser 
, 
Triangle 
, 
Circle 
, 
Square 
} 
internal 
class "
DrawingScreenViewModel )
:* +
ViewModelBase, 9
{ 
private 
string 
_wordToDraw "
;" #
public 
string 

WordToDraw  
{ 	
get 
{ 
return 
_wordToDraw $
;$ %
}& '
set   
{   
_wordToDraw   
=   
value    %
;  % &
OnPropertyChanged  ' 8
(  8 9
)  9 :
;  : ;
}  < =
}!! 	
private## 
StrokeCollection##  
_strokes##! )
;##) *
public$$ 
StrokeCollection$$ 
Strokes$$  '
{%% 	
get&& 
{&& 
return&& 
_strokes&& !
;&&! "
}&&# $
set'' 
{'' 
_strokes'' 
='' 
value'' "
;''" #
OnPropertyChanged''$ 5
(''5 6
)''6 7
;''7 8
}''9 :
}(( 	
private** 
DrawingAttributes** !
_inkAttributes**" 0
;**0 1
public++ 
DrawingAttributes++  
InkAttributes++! .
{,, 	
get-- 
{-- 
return-- 
_inkAttributes-- '
;--' (
}--) *
set.. 
{.. 
_inkAttributes..  
=..! "
value..# (
;..( )
OnPropertyChanged..* ;
(..; <
)..< =
;..= >
}..? @
}// 	
private11 
double11 
_brushThickness11 &
;11& '
public22 
double22 
BrushThickness22 $
{33 	
get44 
{44 
return44 
_brushThickness44 (
;44( )
}44* +
set55 
{66 
_brushThickness77 
=77  !
value77" '
;77' (
OnPropertyChanged88 !
(88! "
)88" #
;88# $
if99 
(99 
InkAttributes99 !
!=99" $
null99% )
)99) *
{:: 
InkAttributes;; !
.;;! "
Width;;" '
=;;( )
value;;* /
;;;/ 0
InkAttributes<< !
.<<! "
Height<<" (
=<<) *
value<<+ 0
;<<0 1
}== 
}>> 
}?? 	
privateAA  
InkCanvasEditingModeAA $
_editingModeAA% 1
;AA1 2
publicBB  
InkCanvasEditingModeBB #
EditingModeBB$ /
{CC 	
getDD 
{DD 
returnDD 
_editingModeDD %
;DD% &
}DD' (
setEE 
{EE 
_editingModeEE 
=EE  
valueEE! &
;EE& '
OnPropertyChangedEE( 9
(EE9 :
)EE: ;
;EE; <
}EE= >
}FF 	
privateHH 
ColorHH 
_currentColorHH #
;HH# $
privateII 
DrawingToolII 
_currentToolII (
;II( )
publicJJ 
DrawingToolJJ 
CurrentToolJJ &
{KK 	
getLL 
{LL 
returnLL 
_currentToolLL %
;LL% &
}LL' (
setMM 
{MM 
_currentToolMM 
=MM  
valueMM! &
;MM& '
OnPropertyChangedMM( 9
(MM9 :
)MM: ;
;MM; <
}MM= >
}NN 	
privatePP 
PointPP 
_startPointPP !
;PP! "
privateQQ 
StrokeQQ 
_currentShapeStrokeQQ *
;QQ* +
privateSS 
DispatcherTimerSS 
_countdownTimerSS  /
;SS/ 0
privateTT 
intTT 
_remainingTimeTT "
;TT" #
publicUU 
intUU 
RemainingTimeUU  
{VV 	
getWW 
{WW 
returnWW 
_remainingTimeWW '
;WW' (
}WW) *
setXX 
{XX 
_remainingTimeXX  
=XX! "
valueXX# (
;XX( )
OnPropertyChangedXX* ;
(XX; <
)XX< =
;XX= >
}XX? @
}YY 	
public[[ 
ICommand[[ 
SelectColorCommand[[ *
{[[+ ,
get[[- 0
;[[0 1
}[[2 3
public\\ 
ICommand\\ 
SelectToolCommand\\ )
{\\* +
get\\, /
;\\/ 0
}\\1 2
public]] 
ICommand]] 
CloseWindowCommand]] *
{]]+ ,
get]]- 0
;]]0 1
}]]2 3
public^^ 
ICommand^^ !
MaximizeWindowCommand^^ -
{^^. /
get^^0 3
;^^3 4
}^^5 6
public__ 
ICommand__ !
MinimizeWindowCommand__ -
{__. /
get__0 3
;__3 4
}__5 6
publicaa 
ICommandaa 
StartShapeCommandaa )
{aa* +
getaa, /
;aa/ 0
}aa1 2
publicbb 
ICommandbb 
UpdateShapeCommandbb *
{bb+ ,
getbb- 0
;bb0 1
}bb2 3
publiccc 
ICommandcc 
EndShapeCommandcc '
{cc( )
getcc* -
;cc- .
}cc/ 0
publicee "
DrawingScreenViewModelee %
(ee% &
)ee& '
{ff 	
CloseWindowCommandgg 
=gg  
newgg! $
RelayCommandgg% 1
(gg1 2
ExecuteCloseWindowgg2 D
)ggD E
;ggE F!
MaximizeWindowCommandhh !
=hh" #
newhh$ '
RelayCommandhh( 4
(hh4 5!
ExecuteMaximizeWindowhh5 J
)hhJ K
;hhK L!
MinimizeWindowCommandii !
=ii" #
newii$ '
RelayCommandii( 4
(ii4 5!
ExecuteMinimizeWindowii5 J
)iiJ K
;iiK L
SelectColorCommandjj 
=jj  
newjj! $
RelayCommandjj% 1
(jj1 2
ExecuteSelectColorjj2 D
)jjD E
;jjE F
SelectToolCommandkk 
=kk 
newkk  #
RelayCommandkk$ 0
(kk0 1
ExecuteSelectToolkk1 B
)kkB C
;kkC D
StartShapeCommandmm 
=mm 
newmm  #
RelayCommandmm$ 0
(mm0 1
parammm1 6
=>mm7 9

StartShapemm: D
(mmD E
(mmE F
PointmmF K
)mmK L
parammmL Q
)mmQ R
)mmR S
;mmS T
UpdateShapeCommandnn 
=nn  
newnn! $
RelayCommandnn% 1
(nn1 2
paramnn2 7
=>nn8 :
UpdateShapenn; F
(nnF G
(nnG H
PointnnH M
)nnM N
paramnnN S
)nnS T
)nnT U
;nnU V
EndShapeCommandoo 
=oo 
newoo !
RelayCommandoo" .
(oo. /
paramoo/ 4
=>oo5 7
EndShapeoo8 @
(oo@ A
)ooA B
)ooB C
;ooC D
Strokesqq 
=qq 
newqq 
StrokeCollectionqq *
(qq* +
)qq+ ,
;qq, -
InkAttributesrr 
=rr 
newrr 
DrawingAttributesrr  1
(rr1 2
)rr2 3
;rr3 4
_currentColorss 
=ss 
Colorsss "
.ss" #
Blackss# (
;ss( )
InkAttributestt 
.tt 
Colortt 
=tt  !
_currentColortt" /
;tt/ 0
InkAttributesuu 
.uu 
	StylusTipuu #
=uu$ %
	StylusTipuu& /
.uu/ 0
Ellipseuu0 7
;uu7 8
CurrentToolww 
=ww 
DrawingToolww %
.ww% &
Pencilww& ,
;ww, -
EditingModexx 
=xx  
InkCanvasEditingModexx .
.xx. /
Inkxx/ 2
;xx2 3
BrushThicknessyy 
=yy 
$numyy 
;yy 
InitializeTimer{{ 
({{ 
){{ 
;{{ !
SubscribeToGameEvents|| !
(||! "
)||" #
;||# $
}}} 	
public "
DrawingScreenViewModel %
(% &
string& ,
word- 1
)1 2
:3 4
this5 9
(9 :
): ;
{
ÄÄ 	

WordToDraw
ÅÅ 
=
ÅÅ 
word
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
private
ÑÑ 
void
ÑÑ 
InitializeTimer
ÑÑ $
(
ÑÑ$ %
)
ÑÑ% &
{
ÖÖ 	
RemainingTime
ÜÜ 
=
ÜÜ 
$num
ÜÜ 
;
ÜÜ 
_countdownTimer
áá 
=
áá 
new
áá !
DispatcherTimer
áá" 1
(
áá1 2
)
áá2 3
;
áá3 4
_countdownTimer
àà 
.
àà 
Interval
àà $
=
àà% &
TimeSpan
àà' /
.
àà/ 0
FromSeconds
àà0 ;
(
àà; <
$num
àà< =
)
àà= >
;
àà> ?
_countdownTimer
ââ 
.
ââ 
Tick
ââ  
+=
ââ! #!
CountdownTimer_Tick
ââ$ 7
;
ââ7 8
_countdownTimer
ää 
.
ää 
Start
ää !
(
ää! "
)
ää" #
;
ää# $
}
ãã 	
private
çç 
void
çç !
CountdownTimer_Tick
çç (
(
çç( )
object
çç) /
sender
çç0 6
,
çç6 7
	EventArgs
çç8 A
e
ççB C
)
ççC D
{
éé 	
RemainingTime
èè 
--
èè 
;
èè 
if
êê 
(
êê 
RemainingTime
êê 
<=
êê  
$num
êê! "
)
êê" #
{
ëë 
_countdownTimer
íí 
.
íí  
Stop
íí  $
(
íí$ %
)
íí% &
;
íí& '
OnTimerFinished
ìì 
(
ìì  
)
ìì  !
;
ìì! "
}
îî 
}
ïï 	
private
óó 
void
óó 
OnTimerFinished
óó $
(
óó$ %
)
óó% &
{
òò 	
EditingMode
ôô 
=
ôô "
InkCanvasEditingMode
ôô .
.
ôô. /
None
ôô/ 3
;
ôô3 4
SaveDrawing
öö 
(
öö 
)
öö 
;
öö 
Console
õõ 
.
õõ 
	WriteLine
õõ 
(
õõ 
$str
õõ H
)
õõH I
;
õõI J
}
úú 	
private
ûû 
void
ûû 
SaveDrawing
ûû  
(
ûû  !
)
ûû! "
{
üü 	
try
†† 
{
°° 
Console
¢¢ 
.
¢¢ 
	WriteLine
¢¢ !
(
¢¢! "
$str
¢¢" H
)
¢¢H I
;
¢¢I J
byte
££ 
[
££ 
]
££ 
drawingBytes
££ #
=
££$ %'
ConvertStrokesToByteArray
££& ?
(
££? @
)
££@ A
;
££A B
GameClientManager
§§ !
.
§§! "
Instance
§§" *
.
§§* +
SubmitDrawing
§§+ 8
(
§§8 9
drawingBytes
§§9 E
)
§§E F
;
§§F G
Console
•• 
.
•• 
	WriteLine
•• !
(
••! "
$str
••" L
)
••L M
;
••M N
EditingMode
¶¶ 
=
¶¶ "
InkCanvasEditingMode
¶¶ 2
.
¶¶2 3
None
¶¶3 7
;
¶¶7 8
}
ßß 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
©© 

MessageBox
™™ 
.
™™ 
Show
™™ 
(
™™  
$"
™™  "
$str
™™" P
{
™™P Q
ex
™™Q S
.
™™S T
Message
™™T [
}
™™[ \
"
™™\ ]
,
™™] ^
$str
™™_ f
,
™™f g
MessageBoxButton
™™h x
.
™™x y
OK
™™y {
,
™™{ |
MessageBoxImage™™} å
.™™å ç
Error™™ç í
)™™í ì
;™™ì î
}
´´ 
}
¨¨ 	
private
ÆÆ 
void
ÆÆ  
ExecuteSelectColor
ÆÆ '
(
ÆÆ' (
object
ÆÆ( .
	parameter
ÆÆ/ 8
)
ÆÆ8 9
{
ØØ 	
string
∞∞ 
colorString
∞∞ 
=
∞∞  
	parameter
∞∞! *
as
∞∞+ -
string
∞∞. 4
;
∞∞4 5
if
±± 
(
±± 
colorString
±± 
!=
±± 
null
±± #
)
±±# $
{
≤≤ 
_currentColor
≥≥ 
=
≥≥ 
(
≥≥  !
Color
≥≥! &
)
≥≥& '
ColorConverter
≥≥' 5
.
≥≥5 6
ConvertFromString
≥≥6 G
(
≥≥G H
colorString
≥≥H S
)
≥≥S T
;
≥≥T U
InkAttributes
¥¥ 
.
¥¥ 
Color
¥¥ #
=
¥¥$ %
_currentColor
¥¥& 3
;
¥¥3 4
if
∂∂ 
(
∂∂ 
CurrentTool
∂∂ 
==
∂∂  "
DrawingTool
∂∂# .
.
∂∂. /
Eraser
∂∂/ 5
)
∂∂5 6
{
∑∑ 
ExecuteSelectTool
∏∏ %
(
∏∏% &
$str
∏∏& .
)
∏∏. /
;
∏∏/ 0
}
ππ 
}
∫∫ 
}
ªª 	
private
ΩΩ 
void
ΩΩ 
ExecuteSelectTool
ΩΩ &
(
ΩΩ& '
object
ΩΩ' -
	parameter
ΩΩ. 7
)
ΩΩ7 8
{
ææ 	
string
øø 
tool
øø 
=
øø 
	parameter
øø #
as
øø$ &
string
øø' -
;
øø- .
switch
¿¿ 
(
¿¿ 
tool
¿¿ 
)
¿¿ 
{
¡¡ 
case
¬¬ 
$str
¬¬ 
:
¬¬ 
CurrentTool
√√ 
=
√√  !
DrawingTool
√√" -
.
√√- .
Pencil
√√. 4
;
√√4 5
EditingMode
ƒƒ 
=
ƒƒ  !"
InkCanvasEditingMode
ƒƒ" 6
.
ƒƒ6 7
Ink
ƒƒ7 :
;
ƒƒ: ;
InkAttributes
≈≈ !
.
≈≈! "
Color
≈≈" '
=
≈≈( )
_currentColor
≈≈* 7
;
≈≈7 8
break
∆∆ 
;
∆∆ 
case
»» 
$str
»» 
:
»» 
CurrentTool
…… 
=
……  !
DrawingTool
……" -
.
……- .
Eraser
……. 4
;
……4 5
EditingMode
   
=
    !"
InkCanvasEditingMode
  " 6
.
  6 7
EraseByPoint
  7 C
;
  C D
break
ÀÀ 
;
ÀÀ 
case
ÕÕ 
$str
ÕÕ 
:
ÕÕ  
CurrentTool
ŒŒ 
=
ŒŒ  !
DrawingTool
ŒŒ" -
.
ŒŒ- .
Triangle
ŒŒ. 6
;
ŒŒ6 7
EditingMode
œœ 
=
œœ  !"
InkCanvasEditingMode
œœ" 6
.
œœ6 7
None
œœ7 ;
;
œœ; <
break
–– 
;
–– 
case
““ 
$str
““ 
:
““ 
CurrentTool
”” 
=
””  !
DrawingTool
””" -
.
””- .
Circle
””. 4
;
””4 5
EditingMode
‘‘ 
=
‘‘  !"
InkCanvasEditingMode
‘‘" 6
.
‘‘6 7
None
‘‘7 ;
;
‘‘; <
break
’’ 
;
’’ 
case
◊◊ 
$str
◊◊ 
:
◊◊ 
CurrentTool
ÿÿ 
=
ÿÿ  !
DrawingTool
ÿÿ" -
.
ÿÿ- .
Square
ÿÿ. 4
;
ÿÿ4 5
EditingMode
ŸŸ 
=
ŸŸ  !"
InkCanvasEditingMode
ŸŸ" 6
.
ŸŸ6 7
None
ŸŸ7 ;
;
ŸŸ; <
break
⁄⁄ 
;
⁄⁄ 
}
€€ 
}
‹‹ 	
private
ﬁﬁ 
void
ﬁﬁ 

StartShape
ﬁﬁ 
(
ﬁﬁ  
Point
ﬁﬁ  %
position
ﬁﬁ& .
)
ﬁﬁ. /
{
ﬂﬂ 	
if
‡‡ 
(
‡‡ 
CurrentTool
‡‡ 
==
‡‡ 
DrawingTool
‡‡ *
.
‡‡* +
Pencil
‡‡+ 1
||
‡‡2 4
CurrentTool
‡‡5 @
==
‡‡A C
DrawingTool
‡‡D O
.
‡‡O P
Eraser
‡‡P V
)
‡‡V W
return
‡‡X ^
;
‡‡^ _
_startPoint
‚‚ 
=
‚‚ 
position
‚‚ "
;
‚‚" ##
StylusPointCollection
„„ !
points
„„" (
=
„„) *
new
„„+ .#
StylusPointCollection
„„/ D
(
„„D E
new
„„E H
Point
„„I N
[
„„N O
]
„„O P
{
„„Q R
position
„„S [
}
„„\ ]
)
„„] ^
;
„„^ _!
_currentShapeStroke
‰‰ 
=
‰‰  !
new
‰‰" %
Stroke
‰‰& ,
(
‰‰, -
points
‰‰- 3
)
‰‰3 4
{
ÂÂ 
DrawingAttributes
ÊÊ !
=
ÊÊ" #
InkAttributes
ÊÊ$ 1
.
ÊÊ1 2
Clone
ÊÊ2 7
(
ÊÊ7 8
)
ÊÊ8 9
}
ÁÁ 
;
ÁÁ 
Strokes
ÈÈ 
.
ÈÈ 
Add
ÈÈ 
(
ÈÈ !
_currentShapeStroke
ÈÈ +
)
ÈÈ+ ,
;
ÈÈ, -
}
ÍÍ 	
private
ÏÏ 
void
ÏÏ 
UpdateShape
ÏÏ  
(
ÏÏ  !
Point
ÏÏ! &
currentPosition
ÏÏ' 6
)
ÏÏ6 7
{
ÌÌ 	
if
ÓÓ 
(
ÓÓ !
_currentShapeStroke
ÓÓ #
==
ÓÓ$ &
null
ÓÓ' +
)
ÓÓ+ ,
return
ÓÓ- 3
;
ÓÓ3 4#
StylusPointCollection
 !
	newPoints
" +
=
, -
null
. 2
;
2 3
switch
ÚÚ 
(
ÚÚ 
CurrentTool
ÚÚ 
)
ÚÚ  
{
ÛÛ 
case
ÙÙ 
DrawingTool
ÙÙ  
.
ÙÙ  !
Square
ÙÙ! '
:
ÙÙ' (
	newPoints
ıı 
=
ıı #
CalculateSquarePoints
ıı  5
(
ıı5 6
_startPoint
ıı6 A
,
ııA B
currentPosition
ııC R
)
ııR S
;
ııS T
break
ˆˆ 
;
ˆˆ 
case
˜˜ 
DrawingTool
˜˜  
.
˜˜  !
Triangle
˜˜! )
:
˜˜) *
	newPoints
¯¯ 
=
¯¯ %
CalculateTrianglePoints
¯¯  7
(
¯¯7 8
_startPoint
¯¯8 C
,
¯¯C D
currentPosition
¯¯E T
)
¯¯T U
;
¯¯U V
break
˘˘ 
;
˘˘ 
case
˙˙ 
DrawingTool
˙˙  
.
˙˙  !
Circle
˙˙! '
:
˙˙' (
	newPoints
˚˚ 
=
˚˚ #
CalculateCirclePoints
˚˚  5
(
˚˚5 6
_startPoint
˚˚6 A
,
˚˚A B
currentPosition
˚˚C R
)
˚˚R S
;
˚˚S T
break
¸¸ 
;
¸¸ 
}
˝˝ 
if
ˇˇ 
(
ˇˇ 
	newPoints
ˇˇ 
!=
ˇˇ 
null
ˇˇ !
)
ˇˇ! "
{
ÄÄ !
_currentShapeStroke
ÅÅ #
.
ÅÅ# $
StylusPoints
ÅÅ$ 0
=
ÅÅ1 2
	newPoints
ÅÅ3 <
;
ÅÅ< =
}
ÇÇ 
}
ÉÉ 	
private
ÖÖ 
void
ÖÖ 
EndShape
ÖÖ 
(
ÖÖ 
)
ÖÖ 
{
ÜÜ 	!
_currentShapeStroke
áá 
=
áá  !
null
áá" &
;
áá& '
}
àà 	
private
ää #
StylusPointCollection
ää %#
CalculateSquarePoints
ää& ;
(
ää; <
Point
ää< A
start
ääB G
,
ääG H
Point
ääI N
end
ääO R
)
ääR S
{
ãã 	
var
åå 
points
åå 
=
åå 
new
åå 
List
åå !
<
åå! "
Point
åå" '
>
åå' (
{
çç 
start
éé 
,
éé 
new
èè 
Point
èè 
(
èè 
end
èè 
.
èè 
X
èè 
,
èè  
start
èè! &
.
èè& '
Y
èè' (
)
èè( )
,
èè) *
end
êê 
,
êê 
new
ëë 
Point
ëë 
(
ëë 
start
ëë 
.
ëë  
X
ëë  !
,
ëë! "
end
ëë# &
.
ëë& '
Y
ëë' (
)
ëë( )
,
ëë) *
start
íí 
}
ìì 
;
ìì 
return
îî 
new
îî #
StylusPointCollection
îî ,
(
îî, -
points
îî- 3
)
îî3 4
;
îî4 5
}
ïï 	
private
óó #
StylusPointCollection
óó %%
CalculateTrianglePoints
óó& =
(
óó= >
Point
óó> C
start
óóD I
,
óóI J
Point
óóK P
end
óóQ T
)
óóT U
{
òò 	
double
ôô 
topX
ôô 
=
ôô 
(
ôô 
start
ôô  
.
ôô  !
X
ôô! "
+
ôô# $
end
ôô% (
.
ôô( )
X
ôô) *
)
ôô* +
/
ôô, -
$num
ôô. /
;
ôô/ 0
var
öö 
points
öö 
=
öö 
new
öö 
List
öö !
<
öö! "
Point
öö" '
>
öö' (
{
õõ 
new
úú 
Point
úú 
(
úú 
topX
úú 
,
úú 
start
úú  %
.
úú% &
Y
úú& '
)
úú' (
,
úú( )
end
ùù 
,
ùù 
new
ûû 
Point
ûû 
(
ûû 
start
ûû 
.
ûû  
X
ûû  !
,
ûû! "
end
ûû# &
.
ûû& '
Y
ûû' (
)
ûû( )
,
ûû) *
new
üü 
Point
üü 
(
üü 
topX
üü 
,
üü 
start
üü  %
.
üü% &
Y
üü& '
)
üü' (
}
†† 
;
†† 
return
°° 
new
°° #
StylusPointCollection
°° ,
(
°°, -
points
°°- 3
)
°°3 4
;
°°4 5
}
¢¢ 	
private
§§ #
StylusPointCollection
§§ %#
CalculateCirclePoints
§§& ;
(
§§; <
Point
§§< A
start
§§B G
,
§§G H
Point
§§I N
end
§§O R
)
§§R S
{
•• 	#
StylusPointCollection
¶¶ !
points
¶¶" (
=
¶¶) *
new
¶¶+ .#
StylusPointCollection
¶¶/ D
(
¶¶D E
)
¶¶E F
;
¶¶F G
double
ßß 
centerX
ßß 
=
ßß 
(
ßß 
start
ßß #
.
ßß# $
X
ßß$ %
+
ßß& '
end
ßß( +
.
ßß+ ,
X
ßß, -
)
ßß- .
/
ßß/ 0
$num
ßß1 2
;
ßß2 3
double
®® 
centerY
®® 
=
®® 
(
®® 
start
®® #
.
®®# $
Y
®®$ %
+
®®& '
end
®®( +
.
®®+ ,
Y
®®, -
)
®®- .
/
®®/ 0
$num
®®1 2
;
®®2 3
double
©© 
radiusX
©© 
=
©© 
Math
©© !
.
©©! "
Abs
©©" %
(
©©% &
end
©©& )
.
©©) *
X
©©* +
-
©©, -
start
©©. 3
.
©©3 4
X
©©4 5
)
©©5 6
/
©©7 8
$num
©©9 :
;
©©: ;
double
™™ 
radiusY
™™ 
=
™™ 
Math
™™ !
.
™™! "
Abs
™™" %
(
™™% &
end
™™& )
.
™™) *
Y
™™* +
-
™™, -
start
™™. 3
.
™™3 4
Y
™™4 5
)
™™5 6
/
™™7 8
$num
™™9 :
;
™™: ;
for
¨¨ 
(
¨¨ 
int
¨¨ 
i
¨¨ 
=
¨¨ 
$num
¨¨ 
;
¨¨ 
i
¨¨ 
<=
¨¨  
$num
¨¨! $
;
¨¨$ %
i
¨¨& '
+=
¨¨( *
$num
¨¨+ ,
)
¨¨, -
{
≠≠ 
double
ÆÆ 
angle
ÆÆ 
=
ÆÆ 
i
ÆÆ  
*
ÆÆ! "
Math
ÆÆ# '
.
ÆÆ' (
PI
ÆÆ( *
/
ÆÆ+ ,
$num
ÆÆ- 0
;
ÆÆ0 1
double
ØØ 
x
ØØ 
=
ØØ 
centerX
ØØ "
+
ØØ# $
radiusX
ØØ% ,
*
ØØ- .
Math
ØØ/ 3
.
ØØ3 4
Cos
ØØ4 7
(
ØØ7 8
angle
ØØ8 =
)
ØØ= >
;
ØØ> ?
double
∞∞ 
y
∞∞ 
=
∞∞ 
centerY
∞∞ "
+
∞∞# $
radiusY
∞∞% ,
*
∞∞- .
Math
∞∞/ 3
.
∞∞3 4
Sin
∞∞4 7
(
∞∞7 8
angle
∞∞8 =
)
∞∞= >
;
∞∞> ?
points
±± 
.
±± 
Add
±± 
(
±± 
new
±± 
StylusPoint
±± *
(
±±* +
x
±±+ ,
,
±±, -
y
±±. /
)
±±/ 0
)
±±0 1
;
±±1 2
}
≤≤ 
return
≥≥ 
points
≥≥ 
;
≥≥ 
}
¥¥ 	
private
∂∂ 
byte
∂∂ 
[
∂∂ 
]
∂∂ '
ConvertStrokesToByteArray
∂∂ 0
(
∂∂0 1
)
∂∂1 2
{
∑∑ 	
using
∏∏ 
(
∏∏ 
MemoryStream
∏∏ 
ms
∏∏  "
=
∏∏# $
new
∏∏% (
MemoryStream
∏∏) 5
(
∏∏5 6
)
∏∏6 7
)
∏∏7 8
{
ππ 
if
∫∫ 
(
∫∫ 
Strokes
∫∫ 
!=
∫∫ 
null
∫∫ #
&&
∫∫$ &
Strokes
∫∫' .
.
∫∫. /
Count
∫∫/ 4
>
∫∫5 6
$num
∫∫7 8
)
∫∫8 9
{
ªª 
Strokes
ºº 
.
ºº 
Save
ºº  
(
ºº  !
ms
ºº! #
)
ºº# $
;
ºº$ %
return
ΩΩ 
ms
ΩΩ 
.
ΩΩ 
ToArray
ΩΩ %
(
ΩΩ% &
)
ΩΩ& '
;
ΩΩ' (
}
ææ 
return
øø 
new
øø 
byte
øø 
[
øø  
$num
øø  !
]
øø! "
;
øø" #
}
¿¿ 
}
¡¡ 	
private
√√ 
void
√√ #
SubscribeToGameEvents
√√ *
(
√√* +
)
√√+ ,
{
ƒƒ 	
GameClientManager
≈≈ 
.
≈≈ 
Instance
≈≈ &
.
≈≈& ' 
GuessingPhaseStart
≈≈' 9
+=
≈≈: <-
OnGuessingPhaseStart_FromServer
≈≈= \
;
≈≈\ ]
GameClientManager
∆∆ 
.
∆∆ 
Instance
∆∆ &
.
∆∆& '
ConnectionLost
∆∆' 5
+=
∆∆6 8
OnConnectionLost
∆∆9 I
;
∆∆I J
}
«« 	
private
…… 
void
…… -
OnGuessingPhaseStart_FromServer
…… 4
(
……4 5
object
……5 ;
sender
……< B
,
……B C)
GuessingPhaseStartEventArgs
……D _
e
……` a
)
……a b
{
   	
var
ÀÀ 
drawing
ÀÀ 
=
ÀÀ 
e
ÀÀ 
.
ÀÀ 
Drawing
ÀÀ #
;
ÀÀ# $
string
ÃÃ 

myUsername
ÃÃ 
=
ÃÃ 
GameClientManager
ÃÃ  1
.
ÃÃ1 2
Instance
ÃÃ2 :
.
ÃÃ: ; 
GetCurrentUsername
ÃÃ; M
(
ÃÃM N
)
ÃÃN O
;
ÃÃO P
if
ŒŒ 
(
ŒŒ 
drawing
ŒŒ 
.
ŒŒ 
OwnerUsername
ŒŒ %
==
ŒŒ& (

myUsername
ŒŒ) 3
)
ŒŒ3 4
{
œœ 
ServiceLocator
–– 
.
–– 

Navigation
–– )
.
––) *)
NavigateToWaitingForGuesses
––* E
(
––E F
drawing
––F M
.
––M N
WordKey
––N U
)
––U V
;
––V W
}
—— 
else
““ 
{
”” 
ServiceLocator
‘‘ 
.
‘‘ 

Navigation
‘‘ )
.
‘‘) *
NavigateToGuess
‘‘* 9
(
‘‘9 :
drawing
‘‘: A
)
‘‘A B
;
‘‘B C
}
’’ 
}
÷÷ 	
private
ÿÿ 
void
ÿÿ 
OnConnectionLost
ÿÿ %
(
ÿÿ% &
)
ÿÿ& '
{
ŸŸ 	
Application
⁄⁄ 
.
⁄⁄ 
Current
⁄⁄ 
.
⁄⁄  

Dispatcher
⁄⁄  *
.
⁄⁄* +
Invoke
⁄⁄+ 1
(
⁄⁄1 2 
CloseCurrentWindow
⁄⁄2 D
)
⁄⁄D E
;
⁄⁄E F
}
€€ 	
private
›› 
void
›› '
UnsubscribeFromGameEvents
›› .
(
››. /
)
››/ 0
{
ﬁﬁ 	
GameClientManager
ﬂﬂ 
.
ﬂﬂ 
Instance
ﬂﬂ &
.
ﬂﬂ& ' 
GuessingPhaseStart
ﬂﬂ' 9
-=
ﬂﬂ: <-
OnGuessingPhaseStart_FromServer
ﬂﬂ= \
;
ﬂﬂ\ ]
GameClientManager
‡‡ 
.
‡‡ 
Instance
‡‡ &
.
‡‡& '
ConnectionLost
‡‡' 5
-=
‡‡6 8
OnConnectionLost
‡‡9 I
;
‡‡I J
}
·· 	
private
„„ 
void
„„  
CloseCurrentWindow
„„ '
(
„„' (
)
„„( )
{
‰‰ 	'
UnsubscribeFromGameEvents
ÂÂ %
(
ÂÂ% &
)
ÂÂ& '
;
ÂÂ' (
_countdownTimer
ÊÊ 
?
ÊÊ 
.
ÊÊ 
Stop
ÊÊ !
(
ÊÊ! "
)
ÊÊ" #
;
ÊÊ# $
Window
ËË 
currentWindow
ËË  
=
ËË! "
Application
ËË# .
.
ËË. /
Current
ËË/ 6
.
ËË6 7
Windows
ËË7 >
.
ÈÈ 
OfType
ÈÈ 
<
ÈÈ 
Window
ÈÈ 
>
ÈÈ 
(
ÈÈ  
)
ÈÈ  !
.
ÍÍ 
FirstOrDefault
ÍÍ 
(
ÍÍ  
w
ÍÍ  !
=>
ÍÍ" $
w
ÍÍ% &
.
ÍÍ& '
DataContext
ÍÍ' 2
==
ÍÍ3 5
this
ÍÍ6 :
)
ÍÍ: ;
;
ÍÍ; <
currentWindow
ÏÏ 
?
ÏÏ 
.
ÏÏ 
Close
ÏÏ  
(
ÏÏ  !
)
ÏÏ! "
;
ÏÏ" #
}
ÌÌ 	
private
ÔÔ 
static
ÔÔ 
void
ÔÔ  
ExecuteCloseWindow
ÔÔ .
(
ÔÔ. /
object
ÔÔ/ 5
	parameter
ÔÔ6 ?
)
ÔÔ? @
{
 	
if
ÒÒ 
(
ÒÒ 
	parameter
ÒÒ 
is
ÒÒ 
Window
ÒÒ #
)
ÒÒ# $
Application
ÒÒ% 0
.
ÒÒ0 1
Current
ÒÒ1 8
.
ÒÒ8 9
Shutdown
ÒÒ9 A
(
ÒÒA B
)
ÒÒB C
;
ÒÒC D
}
ÚÚ 	
private
ÙÙ 
static
ÙÙ 
void
ÙÙ #
ExecuteMaximizeWindow
ÙÙ 1
(
ÙÙ1 2
object
ÙÙ2 8
	parameter
ÙÙ9 B
)
ÙÙB C
{
ıı 	
if
ˆˆ 
(
ˆˆ 
	parameter
ˆˆ 
is
ˆˆ 
Window
ˆˆ #
window
ˆˆ$ *
)
ˆˆ* +
window
˜˜ 
.
˜˜ 
WindowState
˜˜ "
=
˜˜# $
window
˜˜% +
.
˜˜+ ,
WindowState
˜˜, 7
==
˜˜8 :
WindowState
˜˜; F
.
˜˜F G
	Maximized
˜˜G P
?
˜˜Q R
WindowState
˜˜S ^
.
˜˜^ _
Normal
˜˜_ e
:
˜˜f g
WindowState
˜˜h s
.
˜˜s t
	Maximized
˜˜t }
;
˜˜} ~
}
¯¯ 	
private
˙˙ 
static
˙˙ 
void
˙˙ #
ExecuteMinimizeWindow
˙˙ 1
(
˙˙1 2
object
˙˙2 8
	parameter
˙˙9 B
)
˙˙B C
{
˚˚ 	
if
¸¸ 
(
¸¸ 
	parameter
¸¸ 
is
¸¸ 
Window
¸¸ #
window
¸¸$ *
)
¸¸* +
window
¸¸, 2
.
¸¸2 3
WindowState
¸¸3 >
=
¸¸? @
WindowState
¸¸A L
.
¸¸L M
	Minimized
¸¸M V
;
¸¸V W
}
˝˝ 	
}
˛˛ 
}ˇˇ ¨®
°C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Match\AnswersScreenViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Match& +
{ 
public 

class 
PlayerViewModel  
:! "
ViewModelBase# 0
{ 
private 
string 
	_username  
;  !
public 
string 
Username 
{ 	
get 
=> 
	_username 
; 
set 
{ 
	_username 
= 
value #
;# $
OnPropertyChanged% 6
(6 7
nameof7 =
(= >
Username> F
)F G
)G H
;H I
}J K
} 	
private 
int 
_score 
; 
public 
int 
Score 
{ 	
get   
=>   
_score   
;   
set!! 
{!! 
_score!! 
=!! 
value!!  
;!!  !
OnPropertyChanged!!" 3
(!!3 4
nameof!!4 :
(!!: ;
Score!!; @
)!!@ A
)!!A B
;!!B C
}!!D E
}"" 	
}## 
public%% 

class%%  
ChatMessageViewModel%% %
:%%& '
ViewModelBase%%( 5
{&& 
public'' 
string'' 
Sender'' 
{'' 
get'' "
;''" #
set''$ '
;''' (
}'') *
public(( 
string(( 
Message(( 
{(( 
get((  #
;((# $
set((% (
;((( )
}((* +
})) 
public++ 

class++ "
AnswersScreenViewModel++ '
:++( )
ViewModelBase++* 7
{,, 
private-- 
const-- 
int-- 
SecondsPerGuess-- )
=--* +
$num--, -
;--- .
private// 
readonly// 
List// 
<// 

DrawingDto// (
>//( )
_allDrawings//* 6
;//6 7
private00 
readonly00 
List00 
<00 
GuessDto00 &
>00& '
_allGuesses00( 3
;003 4
private11 
List11 
<11 
GuessDto11 
>11 %
_guessesForCurrentDrawing11 8
;118 9
private22 
DispatcherTimer22 
_timer22  &
;22& '
private33 
int33 
_drawingIndex33 !
=33" #
-33$ %
$num33% &
;33& '
private44 
int44 
_guessIndex44 
=44  !
-44" #
$num44# $
;44$ %
private66 
string66 
_drawingArtistName66 )
;66) *
public77 
string77 
DrawingArtistName77 '
{88 	
get99 
=>99 
_drawingArtistName99 %
;99% &
set:: 
{:: 
_drawingArtistName:: $
=::% &
value::' ,
;::, -
OnPropertyChanged::. ?
(::? @
nameof::@ F
(::F G
DrawingArtistName::G X
)::X Y
)::Y Z
;::Z [
}::\ ]
};; 	
private== 
StrokeCollection==  "
_currentDrawingStrokes==! 7
;==7 8
public>> 
StrokeCollection>> !
CurrentDrawingStrokes>>  5
{?? 	
get@@ 
=>@@ "
_currentDrawingStrokes@@ )
;@@) *
setAA 
{AA "
_currentDrawingStrokesAA (
=AA) *
valueAA+ 0
;AA0 1
OnPropertyChangedAA2 C
(AAC D
nameofAAD J
(AAJ K!
CurrentDrawingStrokesAAK `
)AA` a
)AAa b
;AAb c
}AAd e
}BB 	
privateDD 
stringDD "
_currentDisplayedGuessDD -
;DD- .
publicEE 
stringEE !
CurrentDisplayedGuessEE +
{FF 	
getGG 
=>GG "
_currentDisplayedGuessGG )
;GG) *
setHH 
{HH "
_currentDisplayedGuessHH (
=HH) *
valueHH+ 0
;HH0 1
OnPropertyChangedHH2 C
(HHC D
nameofHHD J
(HHJ K!
CurrentDisplayedGuessHHK `
)HH` a
)HHa b
;HHb c
}HHd e
}II 	
privateKK 
BrushKK 
_currentGuessColorKK (
;KK( )
publicLL 
BrushLL 
CurrentGuessColorLL &
{MM 	
getNN 
=>NN 
_currentGuessColorNN %
;NN% &
setOO 
{OO 
_currentGuessColorOO $
=OO% &
valueOO' ,
;OO, -
OnPropertyChangedOO. ?
(OO? @
nameofOO@ F
(OOF G
CurrentGuessColorOOG X
)OOX Y
)OOY Z
;OOZ [
}OO\ ]
}PP 	
publicRR  
ObservableCollectionRR #
<RR# $
PlayerViewModelRR$ 3
>RR3 4

PlayerListRR5 ?
{RR@ A
getRRB E
;RRE F
setRRG J
;RRJ K
}RRL M
publicSS  
ObservableCollectionSS #
<SS# $ 
ChatMessageViewModelSS$ 8
>SS8 9
ChatMessagesSS: F
{SSG H
getSSI L
;SSL M
setSSN Q
;SSQ R
}SSS T
privateUU 
stringUU 
_newChatMessageUU &
;UU& '
publicVV 
stringVV 
NewChatMessageVV $
{WW 	
getXX 
=>XX 
_newChatMessageXX "
;XX" #
setYY 
{ZZ 
_newChatMessage[[ 
=[[  !
value[[" '
;[[' (
OnPropertyChanged\\ !
(\\! "
nameof\\" (
(\\( )
NewChatMessage\\) 7
)\\7 8
)\\8 9
;\\9 :
}]] 
}^^ 	
public`` 
ICommand`` 
SendMessageCommand`` *
{``+ ,
get``- 0
;``0 1
}``2 3
publicbb "
AnswersScreenViewModelbb %
(bb% &
Listbb& *
<bb* +

DrawingDtobb+ 5
>bb5 6
allDrawingsbb7 B
,bbB C
ListbbD H
<bbH I
GuessDtobbI Q
>bbQ R

allGuessesbbS ]
,bb] ^
Listbb_ c
<bbc d
PlayerScoreDtobbd r
>bbr s
	allScoresbbt }
)bb} ~
{cc 	
_allDrawingsdd 
=dd 
allDrawingsdd &
??dd' )
newdd* -
Listdd. 2
<dd2 3

DrawingDtodd3 =
>dd= >
(dd> ?
)dd? @
;dd@ A
_allGuessesee 
=ee 

allGuessesee $
??ee% '
newee( +
Listee, 0
<ee0 1
GuessDtoee1 9
>ee9 :
(ee: ;
)ee; <
;ee< =
_drawingIndexff 
=ff 
-ff 
$numff 
;ff 
_guessIndexgg 
=gg 
-gg 
$numgg 
;gg 
CurrentGuessColorii 
=ii 
Brushesii  '
.ii' (
Blackii( -
;ii- .

PlayerListjj 
=jj 
newjj  
ObservableCollectionjj 1
<jj1 2
PlayerViewModeljj2 A
>jjA B
(jjB C
)jjC D
;jjD E
ifll 
(ll 
	allScoresll 
!=ll 
nullll !
)ll! "
{mm 
foreachnn 
(nn 
varnn 
scorenn "
innn# %
	allScoresnn& /
.nn/ 0
OrderByDescendingnn0 A
(nnA B
snnB C
=>nnD F
snnG H
.nnH I
ScorennI N
)nnN O
)nnO P
{oo 

PlayerListpp 
.pp 
Addpp "
(pp" #
newpp# &
PlayerViewModelpp' 6
{pp7 8
Usernamepp9 A
=ppB C
scoreppD I
.ppI J
UsernameppJ R
,ppR S
ScoreppT Y
=ppZ [
scorepp\ a
.ppa b
Scoreppb g
}pph i
)ppi j
;ppj k
}qq 
}rr 
ChatMessagestt 
=tt 
newtt  
ObservableCollectiontt 3
<tt3 4 
ChatMessageViewModeltt4 H
>ttH I
(ttI J
)ttJ K
;ttK L
SendMessageCommanduu 
=uu  
newuu! $
RelayCommanduu% 1
(uu1 2
OnSendChatMessageuu2 C
,uuC D
CanSendChatMessageuuE W
)uuW X
;uuX Y
GameClientManagervv 
.vv 
Instancevv &
.vv& '!
InGameMessageReceivedvv' <
+=vv= ?+
OnInGameMessageReceived_Handlervv@ _
;vv_ `
GameClientManagerxx 
.xx 
Instancexx &
.xx& '
GameEndxx' .
-=xx/ 1
CloseOnNextPhasexx2 B
;xxB C
GameClientManageryy 
.yy 
Instanceyy &
.yy& '
ConnectionLostyy' 5
-=yy6 8
CloseOnDisconnectyy9 J
;yyJ K
_timer{{ 
={{ 
new{{ 
DispatcherTimer{{ (
{{{) *
Interval{{+ 3
={{4 5
TimeSpan{{6 >
.{{> ?
FromSeconds{{? J
({{J K
SecondsPerGuess{{K Z
){{Z [
}{{\ ]
;{{] ^
_timer|| 
.|| 
Tick|| 
+=|| 
OnTimerTick|| &
;||& '
ShowNextItem~~ 
(~~ 
)~~ 
;~~ 
_timer 
. 
Start 
( 
) 
; 
}
ÄÄ 	
private
ÇÇ 
StrokeCollection
ÇÇ  "
LoadStrokesFromBytes
ÇÇ! 5
(
ÇÇ5 6
byte
ÇÇ6 :
[
ÇÇ: ;
]
ÇÇ; <
data
ÇÇ= A
)
ÇÇA B
{
ÉÉ 	
if
ÑÑ 
(
ÑÑ 
data
ÑÑ 
==
ÑÑ 
null
ÑÑ 
||
ÑÑ 
data
ÑÑ  $
.
ÑÑ$ %
Length
ÑÑ% +
==
ÑÑ, .
$num
ÑÑ/ 0
)
ÑÑ0 1
{
ÖÖ 
return
ÜÜ 
new
ÜÜ 
StrokeCollection
ÜÜ +
(
ÜÜ+ ,
)
ÜÜ, -
;
ÜÜ- .
}
áá 
try
àà 
{
ââ 
using
ää 
(
ää 
var
ää 
ms
ää 
=
ää 
new
ää  #
MemoryStream
ää$ 0
(
ää0 1
data
ää1 5
)
ää5 6
)
ää6 7
{
ãã 
return
åå 
new
åå 
StrokeCollection
åå /
(
åå/ 0
ms
åå0 2
)
åå2 3
;
åå3 4
}
çç 
}
éé 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
êê 
Console
ëë 
.
ëë 
	WriteLine
ëë !
(
ëë! "
$"
ëë" $
$str
ëë$ ;
{
ëë; <
ex
ëë< >
.
ëë> ?
Message
ëë? F
}
ëëF G
"
ëëG H
)
ëëH I
;
ëëI J
return
íí 
new
íí 
StrokeCollection
íí +
(
íí+ ,
)
íí, -
;
íí- .
}
ìì 
}
îî 	
private
ññ 
void
ññ 
OnTimerTick
ññ  
(
ññ  !
object
ññ! '
sender
ññ( .
,
ññ. /
	EventArgs
ññ0 9
e
ññ: ;
)
ññ; <
{
óó 	
ShowNextItem
òò 
(
òò 
)
òò 
;
òò 
}
ôô 	
private
õõ 
void
õõ 
ShowNextItem
õõ !
(
õõ! "
)
õõ" #
{
úú 	
if
ùù 
(
ùù 
_guessIndex
ùù 
==
ùù 
-
ùù  
$num
ùù  !
)
ùù! "
{
ûû 
_drawingIndex
üü 
++
üü 
;
üü  
if
°° 
(
°° 
_drawingIndex
°° !
>=
°°" $
_allDrawings
°°% 1
.
°°1 2
Count
°°2 7
)
°°7 8
{
¢¢ 
_timer
££ 
.
££ 
Stop
££ 
(
££  
)
££  !
;
££! "#
CurrentDisplayedGuess
§§ )
=
§§* +
Lang
§§, 0
.
§§0 1)
answersScreenLbEndOfAnswers
§§1 L
;
§§L M
CurrentGuessColor
•• %
=
••& '
Brushes
••( /
.
••/ 0
Black
••0 5
;
••5 6
return
¶¶ 
;
¶¶ 
}
ßß 
var
©© 
currentDrawing
©© "
=
©©# $
_allDrawings
©©% 1
[
©©1 2
_drawingIndex
©©2 ?
]
©©? @
;
©©@ A
DrawingArtistName
™™ !
=
™™" #
currentDrawing
™™$ 2
.
™™2 3
OwnerUsername
™™3 @
;
™™@ A#
CurrentDrawingStrokes
´´ %
=
´´& '"
LoadStrokesFromBytes
´´( <
(
´´< =
currentDrawing
´´= K
.
´´K L
DrawingData
´´L W
)
´´W X
;
´´X Y'
_guessesForCurrentDrawing
≠≠ )
=
≠≠* +
_allGuesses
≠≠, 7
.
ÆÆ 
Where
ÆÆ 
(
ÆÆ 
g
ÆÆ 
=>
ÆÆ 
g
ÆÆ  !
.
ÆÆ! "
	DrawingId
ÆÆ" +
==
ÆÆ, .
currentDrawing
ÆÆ/ =
.
ÆÆ= >
	DrawingId
ÆÆ> G
)
ÆÆG H
.
ØØ 
ToList
ØØ 
(
ØØ 
)
ØØ 
;
ØØ #
CurrentDisplayedGuess
±± %
=
±±& '
$"
±±( *
{
±±* +
Lang
±±+ /
.
±±/ 0(
answersScreenMsgTheWordWas
±±0 J
}
±±J K
{
±±K L
currentDrawing
±±L Z
.
±±Z [
WordKey
±±[ b
}
±±b c
"
±±c d
;
±±d e
CurrentGuessColor
≤≤ !
=
≤≤" #
Brushes
≤≤$ +
.
≤≤+ ,
DarkBlue
≤≤, 4
;
≤≤4 5
_guessIndex
¥¥ 
=
¥¥ 
$num
¥¥ 
;
¥¥  
}
µµ 
else
∂∂ 
{
∑∑ 
if
∏∏ 
(
∏∏ 
_guessIndex
∏∏ 
<
∏∏  !'
_guessesForCurrentDrawing
∏∏" ;
.
∏∏; <
Count
∏∏< A
)
∏∏A B
{
ππ 
var
∫∫ 
guess
∫∫ 
=
∫∫ '
_guessesForCurrentDrawing
∫∫  9
[
∫∫9 :
_guessIndex
∫∫: E
]
∫∫E F
;
∫∫F G#
CurrentDisplayedGuess
ªª )
=
ªª* +
$"
ªª, .
{
ªª. /
guess
ªª/ 4
.
ªª4 5
GuesserUsername
ªª5 D
}
ªªD E
$str
ªªE G
{
ªªG H
guess
ªªH M
.
ªªM N
	GuessText
ªªN W
}
ªªW X
"
ªªX Y
;
ªªY Z
CurrentGuessColor
ºº %
=
ºº& '
guess
ºº( -
.
ºº- .
	IsCorrect
ºº. 7
?
ºº8 9
Brushes
ºº: A
.
ººA B
Green
ººB G
:
ººH I
Brushes
ººJ Q
.
ººQ R
Red
ººR U
;
ººU V
_guessIndex
ææ 
++
ææ !
;
ææ! "
}
øø 
else
¿¿ 
{
¡¡ #
CurrentDisplayedGuess
¬¬ )
=
¬¬* +
Lang
¬¬, 0
.
¬¬0 1)
answersScreenMsgNextDrawing
¬¬1 L
;
¬¬L M
CurrentGuessColor
√√ %
=
√√& '
Brushes
√√( /
.
√√/ 0
Black
√√0 5
;
√√5 6
_guessIndex
≈≈ 
=
≈≈  !
-
≈≈" #
$num
≈≈# $
;
≈≈$ %
}
∆∆ 
}
«« 
}
»» 	
private
   
void
   
OnSendChatMessage
   &
(
  & '
object
  ' -
	parameter
  . 7
)
  7 8
{
ÀÀ 	
try
ÃÃ 
{
ÕÕ 
GameClientManager
ŒŒ !
.
ŒŒ! "
Instance
ŒŒ" *
.
ŒŒ* +
SendInGameMessage
ŒŒ+ <
(
ŒŒ< =
NewChatMessage
ŒŒ= K
)
ŒŒK L
;
ŒŒL M
NewChatMessage
œœ 
=
œœ  
string
œœ! '
.
œœ' (
Empty
œœ( -
;
œœ- .
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
““ 

MessageBox
”” 
.
”” 
Show
”” 
(
””  
$"
””  "
{
””" #
Lang
””# '
.
””' (&
alertErrorSendingMessage
””( @
}
””@ A
{
””A B
ex
””B D
.
””D E
Message
””E L
}
””L M
"
””M N
,
””N O
Lang
””P T
.
””T U
alertChatError
””U c
,
””c d
MessageBoxButton
””e u
.
””u v
OK
””v x
,
””x y
MessageBoxImage””z â
.””â ä
Warning””ä ë
)””ë í
;””í ì
}
‘‘ 
}
’’ 	
private
◊◊ 
bool
◊◊  
CanSendChatMessage
◊◊ '
(
◊◊' (
object
◊◊( .
	parameter
◊◊/ 8
)
◊◊8 9
{
ÿÿ 	
return
ŸŸ 
!
ŸŸ 
string
ŸŸ 
.
ŸŸ 
IsNullOrEmpty
ŸŸ (
(
ŸŸ( )
NewChatMessage
ŸŸ) 7
)
ŸŸ7 8
;
ŸŸ8 9
}
⁄⁄ 	
private
‹‹ 
void
‹‹ -
OnInGameMessageReceived_Handler
‹‹ 4
(
‹‹4 5
object
‹‹5 ;
sender
‹‹< B
,
‹‹B C$
InGameMessageEventArgs
‹‹D Z
e
‹‹[ \
)
‹‹\ ]
{
›› 	
Application
ﬁﬁ 
.
ﬁﬁ 
Current
ﬁﬁ 
?
ﬁﬁ  
.
ﬁﬁ  !

Dispatcher
ﬁﬁ! +
.
ﬁﬁ+ ,
Invoke
ﬁﬁ, 2
(
ﬁﬁ2 3
(
ﬁﬁ3 4
)
ﬁﬁ4 5
=>
ﬁﬁ6 8
{
ﬂﬂ 
ChatMessages
‡‡ 
.
‡‡ 
Add
‡‡  
(
‡‡  !
new
‡‡! $"
ChatMessageViewModel
‡‡% 9
{
‡‡: ;
Sender
‡‡< B
=
‡‡C D
e
‡‡E F
.
‡‡F G
Sender
‡‡G M
,
‡‡M N
Message
‡‡O V
=
‡‡W X
e
‡‡Y Z
.
‡‡Z [
Message
‡‡[ b
}
‡‡c d
)
‡‡d e
;
‡‡e f
}
·· 
)
·· 
;
·· 
}
‚‚ 	
private
‰‰ 
void
‰‰ 
CloseOnNextPhase
‰‰ %
(
‰‰% &
object
‰‰& ,
sender
‰‰- 3
,
‰‰3 4
	EventArgs
‰‰5 >
e
‰‰? @
)
‰‰@ A
{
ÂÂ 	
Application
ÊÊ 
.
ÊÊ 
Current
ÊÊ 
?
ÊÊ  
.
ÊÊ  !

Dispatcher
ÊÊ! +
.
ÊÊ+ ,
Invoke
ÊÊ, 2
(
ÊÊ2 3
CloseWindow
ÊÊ3 >
)
ÊÊ> ?
;
ÊÊ? @
}
ÁÁ 	
private
ÈÈ 
void
ÈÈ 
CloseOnDisconnect
ÈÈ &
(
ÈÈ& '
)
ÈÈ' (
{
ÍÍ 	
Application
ÎÎ 
.
ÎÎ 
Current
ÎÎ 
?
ÎÎ  
.
ÎÎ  !

Dispatcher
ÎÎ! +
.
ÎÎ+ ,
Invoke
ÎÎ, 2
(
ÎÎ2 3
CloseWindow
ÎÎ3 >
)
ÎÎ> ?
;
ÎÎ? @
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ 
Cleanup
ÓÓ 
(
ÓÓ 
)
ÓÓ 
{
ÔÔ 	
if
 
(
 
_timer
 
!=
 
null
 
)
 
{
ÒÒ 
_timer
ÚÚ 
.
ÚÚ 
Stop
ÚÚ 
(
ÚÚ 
)
ÚÚ 
;
ÚÚ 
_timer
ÛÛ 
.
ÛÛ 
Tick
ÛÛ 
-=
ÛÛ 
OnTimerTick
ÛÛ *
;
ÛÛ* +
}
ÙÙ 
GameClientManager
ˆˆ 
.
ˆˆ 
Instance
ˆˆ &
.
ˆˆ& '#
InGameMessageReceived
ˆˆ' <
-=
ˆˆ= ?-
OnInGameMessageReceived_Handler
ˆˆ@ _
;
ˆˆ_ `
GameClientManager
˜˜ 
.
˜˜ 
Instance
˜˜ &
.
˜˜& '
GameEnd
˜˜' .
-=
˜˜/ 1
CloseOnNextPhase
˜˜2 B
;
˜˜B C
GameClientManager
¯¯ 
.
¯¯ 
Instance
¯¯ &
.
¯¯& '
ConnectionLost
¯¯' 5
-=
¯¯6 8
CloseOnDisconnect
¯¯9 J
;
¯¯J K
}
˘˘ 	
private
˚˚ 
void
˚˚ 
CloseWindow
˚˚  
(
˚˚  !
)
˚˚! "
{
¸¸ 	
Cleanup
˝˝ 
(
˝˝ 
)
˝˝ 
;
˝˝ 
Window
˛˛ 
w
˛˛ 
=
˛˛ 
Application
˛˛ "
.
˛˛" #
Current
˛˛# *
.
˛˛* +
Windows
˛˛+ 2
.
ˇˇ 
OfType
ˇˇ 
<
ˇˇ 
AnswersScreenView
ˇˇ )
>
ˇˇ) *
(
ˇˇ* +
)
ˇˇ+ ,
.
ÄÄ 
FirstOrDefault
ÄÄ 
(
ÄÄ  
win
ÄÄ  #
=>
ÄÄ$ &
win
ÄÄ' *
.
ÄÄ* +
DataContext
ÄÄ+ 6
==
ÄÄ7 9
this
ÄÄ: >
)
ÄÄ> ?
;
ÄÄ? @
w
ÇÇ 
?
ÇÇ 
.
ÇÇ 
Close
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
}ÖÖ ùq
©C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\MatchSettings\MatchSettingsViewModel.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
MatchSettings

& 3
{ 
public 

class "
MatchSettingsViewModel '
:( )
ViewModelBase* 7
{ 
private 
string 

_matchName !
=" #
$str$ 1
+2 3
SessionManager4 B
.B C
InstanceC K
.K L
CurrentUsernameL [
;[ \
private 
bool 
_isPrivateMatch $
=% &
false' ,
;, -
private 
int 
_maxPlayers 
;  
private 
int 
_rounds 
; 
private 
DifficultyModel 
_selectedDifficulty  3
;3 4
public 
List 
< 
int 
> !
AvailablePlayerCounts .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
List 
< 
int 
>  
AvailableRoundCounts -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
List 
< 
DifficultyModel #
># $!
AvailableDifficulties% :
{; <
get= @
;@ A
setB E
;E F
}G H
public 
string 
	MatchName 
{ 	
get 
=> 

_matchName 
; 
set 
=> 
SetProperty 
( 
ref "

_matchName# -
,- .
value/ 4
)4 5
;5 6
} 	
public 
bool 
IsPublicMatch !
{ 	
get   
=>   
!   
_isPrivateMatch   #
;  # $
set!! 
{"" 
if## 
(## 
SetProperty## 
(##  
ref##  #
_isPrivateMatch##$ 3
,##3 4
!##5 6
value##6 ;
)##; <
)##< =
{$$ 
OnPropertyChanged%% %
(%%% &
nameof%%& ,
(%%, -
IsPublicMatch%%- :
)%%: ;
)%%; <
;%%< =
}&& 
}'' 
}(( 	
public** 
int** 

MaxPlayers** 
{++ 	
get,, 
=>,, 
_maxPlayers,, 
;,, 
set-- 
=>-- 
SetProperty-- 
(-- 
ref-- "
_maxPlayers--# .
,--. /
value--0 5
)--5 6
;--6 7
}.. 	
public00 
int00 
Rounds00 
{11 	
get22 
=>22 
_rounds22 
;22 
set33 
=>33 
SetProperty33 
(33 
ref33 "
_rounds33# *
,33* +
value33, 1
)331 2
;332 3
}44 	
public66 
DifficultyModel66 
SelectedDifficulty66 1
{77 	
get88 
=>88 
_selectedDifficulty88 &
;88& '
set99 
=>99 
SetProperty99 
(99 
ref99 "
_selectedDifficulty99# 6
,996 7
value998 =
)99= >
;99> ?
}:: 	
public<< 
RelayCommand<< 
SetMatchTypeCommand<< /
{<<0 1
get<<2 5
;<<5 6
private<<7 >
set<<? B
;<<B C
}<<D E
public== 
RelayCommand== 
CreateMatchCommand== .
{==/ 0
get==1 4
;==4 5
private==6 =
set==> A
;==A B
}==C D
public>> 
RelayCommand>> 
ReturnCommand>> )
{>>* +
get>>, /
;>>/ 0
private>>1 8
set>>9 <
;>>< =
}>>> ?
public@@ "
MatchSettingsViewModel@@ %
(@@% &
)@@& '
{AA 	!
AvailablePlayerCountsBB !
=BB" #

EnumerableBB$ .
.BB. /
RangeBB/ 4
(BB4 5
$numBB5 6
,BB6 7
$numBB8 9
)BB9 :
.BB: ;
ToListBB; A
(BBA B
)BBB C
;BBC D 
AvailableRoundCountsCC  
=CC! "

EnumerableCC# -
.CC- .
RangeCC. 3
(CC3 4
$numCC4 5
,CC5 6
$numCC7 8
)CC8 9
.CC9 :
ToListCC: @
(CC@ A
)CCA B
;CCB C!
AvailableDifficultiesDD !
=DD" #
newDD$ '
ListDD( ,
<DD, -
DifficultyModelDD- <
>DD< =
{EE 
newFF 
DifficultyModelFF #
{FF$ %
IdFF& (
=FF) *
$numFF+ ,
,FF, -
NameFF. 2
=FF3 4

PropertiesFF5 ?
.FF? @
LangsFF@ E
.FFE F
LangFFF J
.FFJ K
createGameCbEasyFFK [
}FF\ ]
,FF] ^
newGG 
DifficultyModelGG #
{GG$ %
IdGG& (
=GG) *
$numGG+ ,
,GG, -
NameGG. 2
=GG3 4

PropertiesGG5 ?
.GG? @
LangsGG@ E
.GGE F
LangGGF J
.GGJ K$
createGameCbIntermediateGGK c
}GGd e
,GGe f
newHH 
DifficultyModelHH #
{HH$ %
IdHH& (
=HH) *
$numHH+ ,
,HH, -
NameHH. 2
=HH3 4

PropertiesHH5 ?
.HH? @
LangsHH@ E
.HHE F
LangHHF J
.HHJ K
createGameCbHardHHK [
}HH\ ]
}II 
;II 

MaxPlayersKK 
=KK !
AvailablePlayerCountsKK .
[KK. /
$numKK/ 0
]KK0 1
;KK1 2
RoundsLL 
=LL  
AvailableRoundCountsLL )
[LL) *
$numLL* +
]LL+ ,
;LL, -
SelectedDifficultyMM 
=MM  !
AvailableDifficultiesMM! 6
[MM6 7
$numMM7 8
]MM8 9
;MM9 :
SetMatchTypeCommandOO 
=OO  !
newOO" %
RelayCommandOO& 2
(OO2 3
ExecuteSetMatchTypeOO3 F
)OOF G
;OOG H
CreateMatchCommandPP 
=PP  
newPP! $
RelayCommandPP% 1
(PP1 2
asyncPP2 7
(PP8 9
paramPP9 >
)PP> ?
=>PP@ B
awaitPPC H#
ExecuteCreateMatchAsyncPPI `
(PP` a
paramPPa f
)PPf g
)PPg h
;PPh i
ReturnCommandQQ 
=QQ 
newQQ 
RelayCommandQQ  ,
(QQ, -
ExecuteReturnQQ- :
)QQ: ;
;QQ; <
}RR 	
privateTT 
voidTT 
ExecuteSetMatchTypeTT (
(TT( )
objectTT) /
	parameterTT0 9
)TT9 :
{UU 	
IsPublicMatchVV 
=VV 
(VV 
	parameterVV &
.VV& '
ToStringVV' /
(VV/ 0
)VV0 1
==VV2 4
$strVV5 =
)VV= >
;VV> ?
}WW 	
privateYY 
asyncYY 
TaskYY #
ExecuteCreateMatchAsyncYY 2
(YY2 3
objectYY3 9
	parameterYY: C
)YYC D
{ZZ 	
if[[ 
([[ 
string[[ 
.[[ 
IsNullOrWhiteSpace[[ )
([[) *
	MatchName[[* 3
)[[3 4
)[[4 5
{\\ 

MessageBox]] 
.]] 
Show]] 
(]]  

Properties]]  *
.]]* +
Langs]]+ 0
.]]0 1
Lang]]1 5
.]]5 6$
alertCreateGameErrorName]]6 N
)]]N O
;]]O P
return^^ 
;^^ 
}__ 
varaa 
settingsaa 
=aa 
newaa 
LobbySettingsDtoaa /
{bb 
	MatchNamecc 
=cc 
thiscc  
.cc  !
	MatchNamecc! *
,cc* +
	IsPrivatedd 
=dd 
thisdd  
.dd  !
_isPrivateMatchdd! 0
,dd0 1

MaxPlayersee 
=ee 
thisee !
.ee! "

MaxPlayersee" ,
,ee, -
TotalRoundsff 
=ff 
thisff "
.ff" #
Roundsff# )
,ff) *
DifficultyIdgg 
=gg 
thisgg #
.gg# $
SelectedDifficultygg$ 6
.gg6 7
Idgg7 9
}hh 
;hh 
varjj 
resultjj 
=jj 
awaitjj $
MatchmakingClientManagerjj 7
.jj7 8
Instancejj8 @
.jj@ A
CreateMatchAsyncjjA Q
(jjQ R
settingsjjR Z
)jjZ [
;jj[ \
ifll 
(ll 
resultll 
.ll 
Successll 
&&ll !
resultll" (
.ll( )
Datall) -
!=ll. 0
nullll1 5
&&ll6 8
resultll9 ?
.ll? @
Datall@ D
.llD E
ContainsKeyllE P
(llP Q
$strllQ Z
)llZ [
)ll[ \
{mm 
stringnn 
matchIdnn 
=nn  
resultnn! '
.nn' (
Datann( ,
[nn, -
$strnn- 6
]nn6 7
;nn7 8
varpp 
lobbyManagerpp  
=pp! "
LobbyClientManagerpp# 5
.pp5 6
Instancepp6 >
;pp> ?
varqq 
sessionManagerqq "
=qq# $
SessionManagerqq% 3
.qq3 4
Instanceqq4 <
;qq< =
stringrr 
currentUsernamerr &
=rr' (
sessionManagerrr) 7
.rr7 8
CurrentUsernamerr8 G
;rrG H
lobbyManagertt 
.tt 
Connecttt $
(tt$ %
currentUsernamett% 4
,tt4 5
matchIdtt6 =
)tt= >
;tt> ?
Windowvv 
waitingRoomViewvv &
=vv' (
nullvv) -
;vv- .
ViewModelBaseww  
waitingRoomViewModelww 2
=ww3 4
nullww5 9
;ww9 :
ifyy 
(yy 
_isPrivateMatchyy #
)yy# $
{zz  
waitingRoomViewModel{{ (
={{) *
new{{+ .0
$WaitingRoomPrivateMatchHostViewModel{{/ S
({{S T
lobbyManager{{T `
,{{` a
sessionManager{{b p
){{p q
;{{q r
waitingRoomView|| #
=||$ %
new||& )+
WaitingRoomPrivateMatchHostView||* I
{}} 
DataContext~~ #
=~~$ % 
waitingRoomViewModel~~& :
} 
; 
}
ÄÄ 
else
ÅÅ 
{
ÇÇ "
waitingRoomViewModel
ÉÉ (
=
ÉÉ) *
new
ÉÉ+ .1
#WaitingRoomPublicMatchHostViewModel
ÉÉ/ R
(
ÉÉR S
lobbyManager
ÉÉS _
,
ÉÉ_ `
sessionManager
ÉÉa o
)
ÉÉo p
;
ÉÉp q
waitingRoomView
ÑÑ #
=
ÑÑ$ %
new
ÑÑ& ),
WaitingRoomPublicMatchHostView
ÑÑ* H
{
ÖÖ 
DataContext
ÜÜ #
=
ÜÜ$ %"
waitingRoomViewModel
ÜÜ& :
}
áá 
;
áá 
}
àà 
if
ää 
(
ää 
	parameter
ää 
is
ää  
Window
ää! '
currentWindow
ää( 5
&&
ää6 8
waitingRoomView
ää9 H
!=
ääI K
null
ääL P
)
ääP Q
{
ãã 
waitingRoomView
åå #
.
åå# $
Show
åå$ (
(
åå( )
)
åå) *
;
åå* +
currentWindow
çç !
.
çç! "
Close
çç" '
(
çç' (
)
çç( )
;
çç) *
}
éé 
else
èè 
{
êê 

MessageBox
ëë 
.
ëë 
Show
ëë #
(
ëë# $
$"
ëë$ &
$str
ëë& :
{
ëë: ;
matchId
ëë; B
}
ëëB C
$str
ëëC i
"
ëëi j
,
ëëj k
$str
ëël r
)
ëër s
;
ëës t
lobbyManager
íí  
.
íí  !

Disconnect
íí! +
(
íí+ ,
)
íí, -
;
íí- .
}
ìì 
}
îî 
else
ïï 
{
ññ 

MessageBox
óó 
.
óó 
Show
óó 
(
óó  
result
óó  &
.
óó& '
Message
óó' .
??
óó/ 1
$str
óó2 Z
,
óóZ [
$str
óó\ c
)
óóc d
;
óód e
}
òò 
}
ôô 	
private
õõ 
static
õõ 
void
õõ 
ExecuteReturn
õõ )
(
õõ) *
object
õõ* 0
	parameter
õõ1 :
)
õõ: ;
{
úú 	
if
ùù 
(
ùù 
	parameter
ùù 
is
ùù 
Window
ùù #
window
ùù$ *
)
ùù* +
{
ûû 
var
üü 
	lobbyView
üü 
=
üü 
new
üü  #
View
üü$ (
.
üü( )
Lobby
üü) .
.
üü. /
	LobbyView
üü/ 8
(
üü8 9
)
üü9 :
;
üü: ;
	lobbyView
†† 
.
†† 
Show
†† 
(
†† 
)
††  
;
††  !
window
°° 
.
°° 
Close
°° 
(
°° 
)
°° 
;
°° 
}
¢¢ 
}
££ 	
}
§§ 
public
¶¶ 

class
¶¶ 
DifficultyModel
¶¶  
{
ßß 
public
®® 
int
®® 
Id
®® 
{
®® 
get
®® 
;
®® 
set
®®  
;
®®  !
}
®®" #
public
©© 
string
©© 
Name
©© 
{
©© 
get
©©  
;
©©  !
set
©©" %
;
©©% &
}
©©' (
public
´´ 
override
´´ 
string
´´ 
ToString
´´ '
(
´´' (
)
´´( )
{
¨¨ 	
return
≠≠ 
Name
≠≠ 
;
≠≠ 
}
ÆÆ 	
}
ØØ 
}∞∞ ≈¿
°C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\DirectMessageViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
{ 
public 

class "
DirectMessageViewModel '
:( )
ViewModelBase* 7
,7 8
IDisposable9 D
{ 
private 
static 
SocialServiceClient *
Client+ 1
=>2 4
SocialClientManager5 H
.H I
InstanceI Q
.Q R
ClientR X
;X Y
public  
ObservableCollection #
<# $
	FriendDto$ -
>- .
Conversations/ <
{= >
get? B
;B C
}D E
public  
ObservableCollection #
<# $
DirectMessageDto$ 4
>4 5
ChatHistory6 A
{B C
getD G
;G H
}I J
private 
string 
_messageText #
;# $
public 
string 
MessageText !
{ 	
get 
{ 
return 
_messageText #
;# $
} 
set 
{ 
if 
( 
_messageText  
!=! #
value$ )
)) *
{ 
_messageText    
=  ! "
value  # (
;  ( )
OnPropertyChanged!! %
(!!% &
)!!& '
;!!' (
}"" 
}## 
}$$ 	
private&& 
string&& '
_currentChatPartnerUsername&& 2
;&&2 3
private'' 
	FriendDto'' !
_selectedConversation'' /
;''/ 0
public(( 
	FriendDto((  
SelectedConversation(( -
{)) 	
get** 
{++ 
return,, !
_selectedConversation,, ,
;,,, -
}-- 
set.. 
{// 
if00 
(00 !
_selectedConversation00 )
!=00* ,
value00- 2
)002 3
{11 !
_selectedConversation22 )
=22* +
value22, 1
;221 2
OnPropertyChanged33 %
(33% &
)33& '
;33' (
if55 
(55 
value55 
!=55  
null55! %
)55% &
{66 
LoadChatHistory77 '
(77' (
value77( -
.77- .
Username77. 6
)776 7
;777 8
}88 
else99 
{:: 
ClearChatHistory;; (
(;;( )
);;) *
;;;* +
}<< 
}== 
}>> 
}?? 	
publicAA 
ICommandAA 
SendMessageCommandAA *
{AA+ ,
getAA- 0
;AA0 1
}AA2 3
publicCC "
DirectMessageViewModelCC %
(CC% &
)CC& '
{DD 	
ConversationsEE 
=EE 
newEE  
ObservableCollectionEE  4
<EE4 5
	FriendDtoEE5 >
>EE> ?
(EE? @
)EE@ A
;EEA B
ChatHistoryFF 
=FF 
newFF  
ObservableCollectionFF 2
<FF2 3
DirectMessageDtoFF3 C
>FFC D
(FFD E
)FFE F
;FFF G
SendMessageCommandGG 
=GG  
newGG! $
RelayCommandGG% 1
(GG1 2
PerformSendMessageGG2 D
,GGD E
	parameterGGF O
=>GGP R!
CanPerformSendMessageGGS h
(GGh i
)GGi j
)GGj k
;GGk l
SubscribeToEventsII 
(II 
)II 
;II  
ifKK 
(KK $
CanExecuteNetworkActionsKK (
(KK( )
)KK) *
)KK* +
{LL  
LoadFriendsListAsyncMM $
(MM$ %
)MM% &
;MM& '
}NN 
elseOO 
{PP 
ConsoleQQ 
.QQ 
	WriteLineQQ !
(QQ! "
$strQQ" _
)QQ_ `
;QQ` a
}RR 
}SS 	
privateUU 
boolUU $
CanExecuteNetworkActionsUU -
(UU- .
)UU. /
{VV 	
returnWW 
ClientWW 
!=WW 
nullWW !
&&WW" $
ClientWW% +
.WW+ ,
StateWW, 1
==WW2 4
CommunicationStateWW5 G
.WWG H
OpenedWWH N
;WWN O
}XX 	
privateZZ 
asyncZZ 
TaskZZ  
LoadFriendsListAsyncZZ /
(ZZ/ 0
)ZZ0 1
{[[ 	
if\\ 
(\\ 
!\\ $
CanExecuteNetworkActions\\ )
(\\) *
)\\* +
)\\+ ,
{]] 
Console^^ 
.^^ 
	WriteLine^^ !
(^^! "
$str^^" a
)^^a b
;^^b c
return__ 
;__ 
}`` 
tryaa 
{bb 
varcc 
userscc 
=cc 
awaitcc !
Clientcc" (
.cc( )
GetFriendsListAsynccc) <
(cc< =
SessionManagercc= K
.ccK L
InstanceccL T
.ccT U
CurrentUsernameccU d
)ccd e
;cce f
Applicationdd 
.dd 
Currentdd #
.dd# $

Dispatcherdd$ .
.dd. /
Invokedd/ 5
(dd5 6
(dd6 7
)dd7 8
=>dd9 ;
{ee 
Conversationsff !
.ff! "
Clearff" '
(ff' (
)ff( )
;ff) *
ifgg 
(gg 
usersgg 
!=gg  
nullgg! %
)gg% &
{hh 
foreachii 
(ii  !
varii! $
uii% &
inii' )
usersii* /
)ii/ 0
{jj 
Conversationskk )
.kk) *
Addkk* -
(kk- .
ukk. /
)kk/ 0
;kk0 1
}ll 
}mm 
}nn 
)nn 
;nn 
}oo 
catchpp 
(pp 
FaultExceptionpp !

fexGeneralpp" ,
)pp, -
{qq 

MessageBoxrr 
.rr 
Showrr 
(rr  
Langss 
.ss %
alertChatLoadFriendsErrorss 2
,ss2 3
Langtt 
.tt 
alertErrorTitlett (
,tt( )
MessageBoxButtonuu $
.uu$ %
OKuu% '
,uu' (
MessageBoxImagevv #
.vv# $
Errorvv$ )
)vv) *
;vv* +
Consoleww 
.ww 
	WriteLineww !
(ww! "
$"ww" $
$strww$ D
{wwD E

fexGeneralwwE O
.wwO P
MessagewwP W
}wwW X
"wwX Y
)wwY Z
;wwZ [
}xx 
catchyy 
(yy %
EndpointNotFoundExceptionyy ,
exyy- /
)yy/ 0
{zz 

MessageBox{{ 
.{{ 
Show{{ 
({{  
Lang|| 
.|| '
alertConnectionErrorMessage|| 4
,||4 5
Lang}} 
.}} %
alertConnectionErrorTitle}} 2
,}}2 3
MessageBoxButton~~ $
.~~$ %
OK~~% '
,~~' (
MessageBoxImage #
.# $
Error$ )
)) *
;* +
Console
ÄÄ 
.
ÄÄ 
	WriteLine
ÄÄ !
(
ÄÄ! "
$"
ÄÄ" $
$str
ÄÄ$ K
{
ÄÄK L
ex
ÄÄL N
.
ÄÄN O
Message
ÄÄO V
}
ÄÄV W
"
ÄÄW X
)
ÄÄX Y
;
ÄÄY Z
}
ÅÅ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÉÉ 

MessageBox
ÑÑ 
.
ÑÑ 
Show
ÑÑ 
(
ÑÑ  
Lang
ÖÖ 
.
ÖÖ '
alertChatLoadFriendsError
ÖÖ 2
,
ÖÖ2 3
Lang
ÜÜ 
.
ÜÜ 
alertErrorTitle
ÜÜ (
,
ÜÜ( )
MessageBoxButton
áá $
.
áá$ %
OK
áá% '
,
áá' (
MessageBoxImage
àà #
.
àà# $
Error
àà$ )
)
àà) *
;
àà* +
Console
ââ 
.
ââ 
	WriteLine
ââ !
(
ââ! "
$"
ââ" $
$str
ââ$ G
{
ââG H
ex
ââH J
.
ââJ K
Message
ââK R
}
ââR S
"
ââS T
)
ââT U
;
ââU V
}
ää 
}
ãã 	
private
çç 
async
çç 
Task
çç 
LoadChatHistory
çç *
(
çç* +
string
çç+ 1
otherUsername
çç2 ?
)
çç? @
{
éé 	
if
èè 
(
èè 
string
èè 
.
èè 
IsNullOrEmpty
èè $
(
èè$ %
otherUsername
èè% 2
)
èè2 3
)
èè3 4
{
êê 
ClearChatHistory
ëë  
(
ëë  !
)
ëë! "
;
ëë" #
return
íí 
;
íí 
}
ìì 
if
ïï 
(
ïï 
!
ïï &
CanExecuteNetworkActions
ïï )
(
ïï) *
)
ïï* +
)
ïï+ ,
{
ññ 
Console
óó 
.
óó 
	WriteLine
óó !
(
óó! "
$str
óó" \
)
óó\ ]
;
óó] ^
ClearChatHistory
òò  
(
òò  !
)
òò! "
;
òò" #
return
ôô 
;
ôô 
}
öö )
_currentChatPartnerUsername
úú '
=
úú( )
otherUsername
úú* 7
;
úú7 8
try
ùù 
{
ûû 
string
üü 
currentUsername
üü &
=
üü' (
SessionManager
üü) 7
.
üü7 8
Instance
üü8 @
.
üü@ A
CurrentUsername
üüA P
;
üüP Q
var
†† 
history
†† 
=
†† 
await
†† #
Client
††$ *
.
††* +)
GetConversationHistoryAsync
††+ F
(
††F G
currentUsername
††G V
,
††V W
otherUsername
††X e
)
††e f
;
††f g
Application
¢¢ 
.
¢¢ 
Current
¢¢ #
.
¢¢# $

Dispatcher
¢¢$ .
.
¢¢. /
Invoke
¢¢/ 5
(
¢¢5 6
(
¢¢6 7
)
¢¢7 8
=>
¢¢9 ;
{
££ 
ChatHistory
§§ 
.
§§  
Clear
§§  %
(
§§% &
)
§§& '
;
§§' (
if
•• 
(
•• 
history
•• 
!=
••  "
null
••# '
)
••' (
{
¶¶ 
foreach
ßß 
(
ßß  !
var
ßß! $
msg
ßß% (
in
ßß) +
history
ßß, 3
)
ßß3 4
{
®® 
if
©© 
(
©©  
msg
©©  #
.
©©# $
SenderUsername
©©$ 2
==
©©3 5
currentUsername
©©6 E
)
©©E F
{
™™ 
var
´´  #
localMessageDto
´´$ 3
=
´´4 5
new
´´6 9
DirectMessageDto
´´: J
{
¨¨  !
SenderUsername
≠≠$ 2
=
≠≠3 4
Lang
≠≠5 9
.
≠≠9 : 
alertChatSenderYou
≠≠: L
,
≠≠L M
RecipientUsername
ÆÆ$ 5
=
ÆÆ6 7
msg
ÆÆ8 ;
.
ÆÆ; <
RecipientUsername
ÆÆ< M
,
ÆÆM N
Content
ØØ$ +
=
ØØ, -
msg
ØØ. 1
.
ØØ1 2
Content
ØØ2 9
,
ØØ9 :
	Timestamp
∞∞$ -
=
∞∞. /
msg
∞∞0 3
.
∞∞3 4
	Timestamp
∞∞4 =
}
±±  !
;
±±! "
ChatHistory
≤≤  +
.
≤≤+ ,
Add
≤≤, /
(
≤≤/ 0
localMessageDto
≤≤0 ?
)
≤≤? @
;
≤≤@ A
}
≥≥ 
else
¥¥  
{
µµ 
ChatHistory
∂∂  +
.
∂∂+ ,
Add
∂∂, /
(
∂∂/ 0
msg
∂∂0 3
)
∂∂3 4
;
∂∂4 5
}
∑∑ 
}
∏∏ 
}
ππ 
}
∫∫ 
)
∫∫ 
;
∫∫ 
}
ªª 
catch
ºº 
(
ºº 
FaultException
ºº !

fexGeneral
ºº" ,
)
ºº, -
{
ΩΩ 

MessageBox
ææ 
.
ææ 
Show
ææ 
(
ææ  
Lang
øø 
.
øø '
alertChatLoadHistoryError
øø 2
,
øø2 3
Lang
¿¿ 
.
¿¿ 
alertErrorTitle
¿¿ (
,
¿¿( )
MessageBoxButton
¡¡ $
.
¡¡$ %
OK
¡¡% '
,
¡¡' (
MessageBoxImage
¬¬ #
.
¬¬# $
Error
¬¬$ )
)
¬¬) *
;
¬¬* +
Console
√√ 
.
√√ 
	WriteLine
√√ !
(
√√! "
$"
√√" $
$str
√√$ D
{
√√D E

fexGeneral
√√E O
.
√√O P
Message
√√P W
}
√√W X
"
√√X Y
)
√√Y Z
;
√√Z [
ClearChatHistory
ƒƒ  
(
ƒƒ  !
)
ƒƒ! "
;
ƒƒ" #
}
≈≈ 
catch
∆∆ 
(
∆∆ '
EndpointNotFoundException
∆∆ ,
ex
∆∆- /
)
∆∆/ 0
{
«« 

MessageBox
»» 
.
»» 
Show
»» 
(
»»  
Lang
…… 
.
…… )
alertConnectionErrorMessage
…… 4
,
……4 5
Lang
   
.
   '
alertConnectionErrorTitle
   2
,
  2 3
MessageBoxButton
ÀÀ $
.
ÀÀ$ %
OK
ÀÀ% '
,
ÀÀ' (
MessageBoxImage
ÃÃ #
.
ÃÃ# $
Error
ÃÃ$ )
)
ÃÃ) *
;
ÃÃ* +
Console
ÕÕ 
.
ÕÕ 
	WriteLine
ÕÕ !
(
ÕÕ! "
$"
ÕÕ" $
$str
ÕÕ$ K
{
ÕÕK L
ex
ÕÕL N
.
ÕÕN O
Message
ÕÕO V
}
ÕÕV W
"
ÕÕW X
)
ÕÕX Y
;
ÕÕY Z
ClearChatHistory
ŒŒ  
(
ŒŒ  !
)
ŒŒ! "
;
ŒŒ" #
}
œœ 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 

MessageBox
““ 
.
““ 
Show
““ 
(
““  
Lang
”” 
.
”” '
alertChatLoadHistoryError
”” 2
,
””2 3
Lang
‘‘ 
.
‘‘ 
alertErrorTitle
‘‘ (
,
‘‘( )
MessageBoxButton
’’ $
.
’’$ %
OK
’’% '
,
’’' (
MessageBoxImage
÷÷ #
.
÷÷# $
Error
÷÷$ )
)
÷÷) *
;
÷÷* +
Console
◊◊ 
.
◊◊ 
	WriteLine
◊◊ !
(
◊◊! "
$"
◊◊" $
$str
◊◊$ @
{
◊◊@ A
ex
◊◊A C
.
◊◊C D
Message
◊◊D K
}
◊◊K L
"
◊◊L M
)
◊◊M N
;
◊◊N O
ClearChatHistory
ÿÿ  
(
ÿÿ  !
)
ÿÿ! "
;
ÿÿ" #
}
ŸŸ 
}
⁄⁄ 	
private
‹‹ 
void
‹‹ 
ClearChatHistory
‹‹ %
(
‹‹% &
)
‹‹& '
{
›› 	)
_currentChatPartnerUsername
ﬁﬁ '
=
ﬁﬁ( )
null
ﬁﬁ* .
;
ﬁﬁ. /
Application
ﬂﬂ 
.
ﬂﬂ 
Current
ﬂﬂ 
.
ﬂﬂ  

Dispatcher
ﬂﬂ  *
.
ﬂﬂ* +
Invoke
ﬂﬂ+ 1
(
ﬂﬂ1 2
(
ﬂﬂ2 3
)
ﬂﬂ3 4
=>
ﬂﬂ5 7
ChatHistory
ﬂﬂ8 C
.
ﬂﬂC D
Clear
ﬂﬂD I
(
ﬂﬂI J
)
ﬂﬂJ K
)
ﬂﬂK L
;
ﬂﬂL M
}
‡‡ 	
private
‚‚ 
bool
‚‚ #
CanPerformSendMessage
‚‚ *
(
‚‚* +
)
‚‚+ ,
{
„„ 	
return
‰‰ 
!
‰‰ 
string
‰‰ 
.
‰‰  
IsNullOrWhiteSpace
‰‰ -
(
‰‰- .
MessageText
‰‰. 9
)
‰‰9 :
&&
‰‰; =)
_currentChatPartnerUsername
ÂÂ .
!=
ÂÂ/ 1
null
ÂÂ2 6
&&
ÂÂ7 9&
CanExecuteNetworkActions
ÊÊ +
(
ÊÊ+ ,
)
ÊÊ, -
;
ÊÊ- .
}
ÁÁ 	
private
ÈÈ 
void
ÈÈ  
PerformSendMessage
ÈÈ '
(
ÈÈ' (
object
ÈÈ( .
obj
ÈÈ/ 2
)
ÈÈ2 3
{
ÍÍ 	
if
ÎÎ 
(
ÎÎ 
!
ÎÎ #
CanPerformSendMessage
ÎÎ &
(
ÎÎ& '
)
ÎÎ' (
)
ÎÎ( )
{
ÏÏ 
return
ÌÌ 
;
ÌÌ 
}
ÓÓ 
var
 

messageDto
 
=
 
new
  
DirectMessageDto
! 1
{
ÒÒ 
SenderUsername
ÚÚ 
=
ÚÚ  
SessionManager
ÚÚ! /
.
ÚÚ/ 0
Instance
ÚÚ0 8
.
ÚÚ8 9
CurrentUsername
ÚÚ9 H
,
ÚÚH I
RecipientUsername
ÛÛ !
=
ÛÛ" #)
_currentChatPartnerUsername
ÛÛ$ ?
,
ÛÛ? @
Content
ÙÙ 
=
ÙÙ 
MessageText
ÙÙ %
,
ÙÙ% &
	Timestamp
ıı 
=
ıı 
DateTime
ıı $
.
ıı$ %
UtcNow
ıı% +
}
ˆˆ 
;
ˆˆ 
try
¯¯ 
{
˘˘ 
Client
˙˙ 
.
˙˙ 
SendDirectMessage
˙˙ (
(
˙˙( )

messageDto
˙˙) 3
)
˙˙3 4
;
˙˙4 5
var
¸¸ 
localMsg
¸¸ 
=
¸¸ 
new
¸¸ "
DirectMessageDto
¸¸# 3
{
˝˝ 
SenderUsername
˛˛ "
=
˛˛# $
Lang
˛˛% )
.
˛˛) * 
alertChatSenderYou
˛˛* <
,
˛˛< =
Content
ˇˇ 
=
ˇˇ 
MessageText
ˇˇ )
,
ˇˇ) *
	Timestamp
ÄÄ 
=
ÄÄ 
DateTime
ÄÄ  (
.
ÄÄ( )
Now
ÄÄ) ,
}
ÅÅ 
;
ÅÅ 
ChatHistory
ÇÇ 
.
ÇÇ 
Add
ÇÇ 
(
ÇÇ  
localMsg
ÇÇ  (
)
ÇÇ( )
;
ÇÇ) *
MessageText
ÉÉ 
=
ÉÉ 
string
ÉÉ $
.
ÉÉ$ %
Empty
ÉÉ% *
;
ÉÉ* +
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ $
CommunicationException
ÖÖ )
commEx
ÖÖ* 0
)
ÖÖ0 1
{
ÜÜ 

MessageBox
áá 
.
áá 
Show
áá 
(
áá  
Lang
àà 
.
àà '
alertChatMessageSendError
àà 2
,
àà2 3
Lang
ââ 
.
ââ 
alertErrorTitle
ââ (
,
ââ( )
MessageBoxButton
ää $
.
ää$ %
OK
ää% '
,
ää' (
MessageBoxImage
ãã #
.
ãã# $
Error
ãã$ )
)
ãã) *
;
ãã* +
Console
åå 
.
åå 
	WriteLine
åå !
(
åå! "
$"
åå" $
$str
åå$ I
{
ååI J
commEx
ååJ P
.
ååP Q
Message
ååQ X
}
ååX Y
"
ååY Z
)
ååZ [
;
åå[ \
}
çç 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
èè 

MessageBox
êê 
.
êê 
Show
êê 
(
êê  
Lang
ëë 
.
ëë '
alertChatMessageSendError
ëë 2
,
ëë2 3
Lang
íí 
.
íí 
alertErrorTitle
íí (
,
íí( )
MessageBoxButton
ìì $
.
ìì$ %
OK
ìì% '
,
ìì' (
MessageBoxImage
îî #
.
îî# $
Error
îî$ )
)
îî) *
;
îî* +
Console
ïï 
.
ïï 
	WriteLine
ïï !
(
ïï! "
$"
ïï" $
$str
ïï$ <
{
ïï< =
ex
ïï= ?
.
ïï? @
Message
ïï@ G
}
ïïG H
"
ïïH I
)
ïïI J
;
ïïJ K
}
ññ 
}
óó 	
private
ôô 
void
ôô 
SubscribeToEvents
ôô &
(
ôô& '
)
ôô' (
{
öö 	!
SocialClientManager
õõ 
.
õõ  
Instance
õõ  (
.
õõ( )
OnMessageReceived
õõ) :
+=
õõ; =#
HandleMessageReceived
õõ> S
;
õõS T!
SocialClientManager
úú 
.
úú  
Instance
úú  (
.
úú( )
OnFriendResponse
úú) 9
+=
úú: <"
HandleFriendResponse
úú= Q
;
úúQ R
Console
ùù 
.
ùù 
	WriteLine
ùù 
(
ùù 
$str
ùù V
)
ùùV W
;
ùùW X
}
ûû 	
private
†† 
void
†† #
UnsubscribeFromEvents
†† *
(
††* +
)
††+ ,
{
°° 	!
SocialClientManager
¢¢ 
.
¢¢  
Instance
¢¢  (
.
¢¢( )
OnMessageReceived
¢¢) :
-=
¢¢; =#
HandleMessageReceived
¢¢> S
;
¢¢S T!
SocialClientManager
££ 
.
££  
Instance
££  (
.
££( )
OnFriendResponse
££) 9
-=
££: <"
HandleFriendResponse
££= Q
;
££Q R
Console
§§ 
.
§§ 
	WriteLine
§§ 
(
§§ 
$str
§§ Y
)
§§Y Z
;
§§Z [
}
•• 	
public
ßß 
void
ßß 
Dispose
ßß 
(
ßß 
)
ßß 
{
®® 	
Dispose
©© 
(
©© 
true
©© 
)
©© 
;
©© 
GC
™™ 
.
™™ 
SuppressFinalize
™™ 
(
™™  
this
™™  $
)
™™$ %
;
™™% &
}
´´ 	
	protected
≠≠ 
virtual
≠≠ 
void
≠≠ 
Dispose
≠≠ &
(
≠≠& '
bool
≠≠' +
	disposing
≠≠, 5
)
≠≠5 6
{
ÆÆ 	
if
ØØ 
(
ØØ 
	disposing
ØØ 
)
ØØ 
{
∞∞ #
UnsubscribeFromEvents
±± %
(
±±% &
)
±±& '
;
±±' (
}
≤≤ 
}
≥≥ 	
public
µµ 
void
µµ 
Cleanup
µµ 
(
µµ 
)
µµ 
{
∂∂ 	
Dispose
∑∑ 
(
∑∑ 
)
∑∑ 
;
∑∑ 
}
∏∏ 	
private
∫∫ 
void
∫∫ #
HandleMessageReceived
∫∫ *
(
∫∫* +
DirectMessageDto
∫∫+ ;
message
∫∫< C
)
∫∫C D
{
ªª 	
Application
ºº 
.
ºº 
Current
ºº 
.
ºº  

Dispatcher
ºº  *
.
ºº* +
Invoke
ºº+ 1
(
ºº1 2
(
ºº2 3
)
ºº3 4
=>
ºº5 7
{
ΩΩ 
if
ææ 
(
ææ 
message
ææ 
.
ææ 
SenderUsername
ææ *
==
ææ+ -)
_currentChatPartnerUsername
ææ. I
)
ææI J
{
øø 
ChatHistory
¿¿ 
.
¿¿  
Add
¿¿  #
(
¿¿# $
message
¿¿$ +
)
¿¿+ ,
;
¿¿, -
}
¡¡ 
else
¬¬ 
{
√√ 

MessageBox
ƒƒ 
.
ƒƒ 
Show
ƒƒ #
(
ƒƒ# $
string
≈≈ 
.
≈≈ 
Format
≈≈ %
(
≈≈% &
Lang
≈≈& *
.
≈≈* +%
alertChatNewMessageFrom
≈≈+ B
,
≈≈B C
message
≈≈D K
.
≈≈K L
SenderUsername
≈≈L Z
)
≈≈Z [
,
≈≈[ \
Lang
∆∆ 
.
∆∆ &
alertChatNewMessageTitle
∆∆ 5
,
∆∆5 6
MessageBoxButton
«« (
.
««( )
OK
««) +
,
««+ ,
MessageBoxImage
»» '
.
»»' (
Information
»»( 3
)
»»3 4
;
»»4 5
}
…… 
}
   
)
   
;
   
}
ÀÀ 	
private
ÕÕ 
void
ÕÕ "
HandleFriendResponse
ÕÕ )
(
ÕÕ) *
string
ÕÕ* 0
fromUsername
ÕÕ1 =
,
ÕÕ= >
bool
ÕÕ? C
accepted
ÕÕD L
)
ÕÕL M
{
ŒŒ 	
if
œœ 
(
œœ 
accepted
œœ 
)
œœ 
{
–– 
Application
—— 
.
—— 
Current
—— #
.
——# $

Dispatcher
——$ .
.
——. /
Invoke
——/ 5
(
——5 6
(
——6 7
)
——7 8
=>
——9 ;"
LoadFriendsListAsync
——< P
(
——P Q
)
——Q R
)
——R S
;
——S T
}
““ 
}
”” 	
~
’’ 	$
DirectMessageViewModel
’’	 
(
’’  
)
’’  !
{
÷÷ 	
Dispose
◊◊ 
(
◊◊ 
false
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 	
}
ŸŸ 
}⁄⁄ Î†
ûC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\HomePages\SignUpViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
	HomePages& /
{ 
public 

class 
SignUpViewModel  
:! "
ViewModelBase# 0
{ 
private 
string 
	_username  
;  !
public 
string 
Username 
{ 	
get 
=> 
	_username 
; 
set 
{ 
if 
( 
	_username 
!=  
value! &
)& '
{ 
	_username   
=   
value    %
;  % &
OnPropertyChanged!! %
(!!% &
)!!& '
;!!' (
}"" 
}## 
}$$ 	
private&& 
string&& 

_firstName&& !
;&&! "
public'' 
string'' 
	FirstName'' 
{(( 	
get)) 
=>)) 

_firstName)) 
;)) 
set** 
{++ 
if,, 
(,, 

_firstName,, 
!=,, !
value,," '
),,' (
{-- 

_firstName.. 
=..  
value..! &
;..& '
OnPropertyChanged// %
(//% &
)//& '
;//' (
}00 
}11 
}22 	
private44 
string44 
	_lastName44  
;44  !
public55 
string55 
LastName55 
{66 	
get77 
=>77 
	_lastName77 
;77 
set88 
{99 
if:: 
(:: 
	_lastName:: 
!=::  
value::! &
)::& '
{;; 
	_lastName<< 
=<< 
value<<  %
;<<% &
OnPropertyChanged== %
(==% &
)==& '
;==' (
}>> 
}?? 
}@@ 	
privateBB 
stringBB 
_emailBB 
;BB 
publicCC 
stringCC 
EmailCC 
{DD 	
getEE 
=>EE 
_emailEE 
;EE 
setFF 
{GG 
ifHH 
(HH 
_emailHH 
!=HH 
valueHH #
)HH# $
{II 
_emailJJ 
=JJ 
valueJJ "
;JJ" #
OnPropertyChangedKK %
(KK% &
)KK& '
;KK' (
}LL 
}MM 
}NN 	
privatePP 
stringPP 
	_passwordPP  
;PP  !
publicQQ 
stringQQ 
PasswordQQ 
{RR 	
getSS 
=>SS 
	_passwordSS 
;SS 
setTT 
{UU 
ifVV 
(VV 
	_passwordVV 
!=VV  
valueVV! &
)VV& '
{WW 
	_passwordXX 
=XX 
valueXX  %
;XX% &
OnPropertyChangedYY %
(YY% &
)YY& '
;YY' (
}ZZ 
}[[ 
}\\ 	
private^^ 
bool^^ 
_isMale^^ 
=^^ 
true^^ #
;^^# $
public__ 
bool__ 
IsMale__ 
{`` 	
getaa 
=>aa 
_isMaleaa 
;aa 
setbb 
{cc 
ifdd 
(dd 
valuedd 
&&dd 
_isMaledd $
!=dd% '
valuedd( -
)dd- .
{ee 
_isMaleff 
=ff 
valueff #
;ff# $
OnPropertyChangedgg %
(gg% &
)gg& '
;gg' (
ResetGenderhh 
(hh  
$numhh  !
)hh! "
;hh" #
}ii 
}jj 
}kk 	
privatemm 
boolmm 
	_isFemalemm 
;mm 
publicnn 
boolnn 
IsFemalenn 
{oo 	
getpp 
=>pp 
	_isFemalepp 
;pp 
setqq 
{rr 
ifss 
(ss 
valuess 
&&ss 
	_isFemaless &
!=ss' )
valuess* /
)ss/ 0
{tt 
	_isFemaleuu 
=uu 
valueuu  %
;uu% &
OnPropertyChangedvv %
(vv% &
)vv& '
;vv' (
ResetGenderww 
(ww  
$numww  !
)ww! "
;ww" #
}xx 
}yy 
}zz 	
private|| 
bool|| 
_isNonBinary|| !
;||! "
public}} 
bool}} 
IsNonBinary}} 
{~~ 	
get 
=> 
_isNonBinary 
;  
set
ÄÄ 
{
ÅÅ 
if
ÇÇ 
(
ÇÇ 
value
ÇÇ 
&&
ÇÇ 
_isNonBinary
ÇÇ )
!=
ÇÇ* ,
value
ÇÇ- 2
)
ÇÇ2 3
{
ÉÉ 
_isNonBinary
ÑÑ  
=
ÑÑ! "
value
ÑÑ# (
;
ÑÑ( )
OnPropertyChanged
ÖÖ %
(
ÖÖ% &
)
ÖÖ& '
;
ÖÖ' (
ResetGender
ÜÜ 
(
ÜÜ  
$num
ÜÜ  !
)
ÜÜ! "
;
ÜÜ" #
}
áá 
}
àà 
}
ââ 	
private
ãã 
int
ãã 
_selectedAvatarId
ãã %
=
ãã& '
$num
ãã( )
;
ãã) *
public
åå 
int
åå 
SelectedAvatarId
åå #
{
çç 	
get
éé 
=>
éé 
_selectedAvatarId
éé $
;
éé$ %
set
èè 
{
êê 
if
ëë 
(
ëë 
_selectedAvatarId
ëë %
!=
ëë& (
value
ëë) .
)
ëë. /
{
íí 
_selectedAvatarId
ìì %
=
ìì& '
value
ìì( -
;
ìì- .
OnPropertyChanged
îî %
(
îî% &
)
îî& '
;
îî' (
}
ïï 
}
ññ 
}
óó 	
private
ôô 
BitmapImage
ôô "
_selectedAvatarImage
ôô 0
;
ôô0 1
public
öö 
BitmapImage
öö !
SelectedAvatarImage
öö .
{
õõ 	
get
úú 
=>
úú "
_selectedAvatarImage
úú '
;
úú' (
set
ùù 
{
ûû 
if
üü 
(
üü "
_selectedAvatarImage
üü (
!=
üü) +
value
üü, 1
)
üü1 2
{
†† "
_selectedAvatarImage
°° (
=
°°) *
value
°°+ 0
;
°°0 1
OnPropertyChanged
¢¢ %
(
¢¢% &
)
¢¢& '
;
¢¢' (
}
££ 
}
§§ 
}
•• 	
public
ßß 
ICommand
ßß 
SignUpCommand
ßß %
{
ßß& '
get
ßß( +
;
ßß+ ,
}
ßß- .
public
®® 
ICommand
®® !
SelectAvatarCommand
®® +
{
®®, -
get
®®. 1
;
®®1 2
}
®®3 4
public
©© 
ICommand
©©  
CloseWindowCommand
©© *
{
©©+ ,
get
©©- 0
;
©©0 1
}
©©2 3
public
™™ 
ICommand
™™ #
MaximizeWindowCommand
™™ -
{
™™. /
get
™™0 3
;
™™3 4
}
™™5 6
public
´´ 
ICommand
´´ #
MinimizeWindowCommand
´´ -
{
´´. /
get
´´0 3
;
´´3 4
}
´´5 6
public
¨¨ 
ICommand
¨¨ 
ReturnCommand
¨¨ %
{
¨¨& '
get
¨¨( +
;
¨¨+ ,
}
¨¨- .
public
ÆÆ 
SignUpViewModel
ÆÆ 
(
ÆÆ 
)
ÆÆ  
{
ØØ 	
SignUpCommand
∞∞ 
=
∞∞ 
new
∞∞ 
RelayCommand
∞∞  ,
(
∞∞, -
ExecuteSignUp
∞∞- :
,
∞∞: ;
CanExecuteSignUp
∞∞< L
)
∞∞L M
;
∞∞M N!
SelectAvatarCommand
±± 
=
±±  !
new
±±" %
RelayCommand
±±& 2
(
±±2 3$
OpenSelectAvatarDialog
±±3 I
)
±±I J
;
±±J K 
CloseWindowCommand
≤≤ 
=
≤≤  
new
≤≤! $
RelayCommand
≤≤% 1
(
≤≤1 2 
ExecuteCloseWindow
≤≤2 D
)
≤≤D E
;
≤≤E F#
MaximizeWindowCommand
≥≥ !
=
≥≥" #
new
≥≥$ '
RelayCommand
≥≥( 4
(
≥≥4 5#
ExecuteMaximizeWindow
≥≥5 J
)
≥≥J K
;
≥≥K L#
MinimizeWindowCommand
¥¥ !
=
¥¥" #
new
¥¥$ '
RelayCommand
¥¥( 4
(
¥¥4 5#
ExecuteMinimizeWindow
¥¥5 J
)
¥¥J K
;
¥¥K L
ReturnCommand
µµ 
=
µµ 
new
µµ 
RelayCommand
µµ  ,
(
µµ, -
ExecuteReturn
µµ- :
)
µµ: ;
;
µµ; <
LoadDefaultAvatar
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂  
}
∑∑ 	
private
ππ 
void
ππ 
ResetGender
ππ  
(
ππ  !
int
ππ! $
selectedGenderId
ππ% 5
)
ππ5 6
{
∫∫ 	
bool
ªª 
oldMale
ªª 
=
ªª 
_isMale
ªª "
;
ªª" #
bool
ºº 
	oldFemale
ºº 
=
ºº 
	_isFemale
ºº &
;
ºº& '
bool
ΩΩ 
oldNonBinary
ΩΩ 
=
ΩΩ 
_isNonBinary
ΩΩ  ,
;
ΩΩ, -
_isMale
øø 
=
øø 
(
øø 
selectedGenderId
øø '
==
øø( *
$num
øø+ ,
)
øø, -
;
øø- .
	_isFemale
¿¿ 
=
¿¿ 
(
¿¿ 
selectedGenderId
¿¿ )
==
¿¿* ,
$num
¿¿- .
)
¿¿. /
;
¿¿/ 0
_isNonBinary
¡¡ 
=
¡¡ 
(
¡¡ 
selectedGenderId
¡¡ ,
==
¡¡- /
$num
¡¡0 1
)
¡¡1 2
;
¡¡2 3
if
√√ 
(
√√ 
oldMale
√√ 
!=
√√ 
_isMale
√√ "
)
√√" #
OnPropertyChanged
ƒƒ !
(
ƒƒ! "
nameof
ƒƒ" (
(
ƒƒ( )
IsMale
ƒƒ) /
)
ƒƒ/ 0
)
ƒƒ0 1
;
ƒƒ1 2
if
≈≈ 
(
≈≈ 
	oldFemale
≈≈ 
!=
≈≈ 
	_isFemale
≈≈ &
)
≈≈& '
OnPropertyChanged
∆∆ !
(
∆∆! "
nameof
∆∆" (
(
∆∆( )
IsFemale
∆∆) 1
)
∆∆1 2
)
∆∆2 3
;
∆∆3 4
if
«« 
(
«« 
oldNonBinary
«« 
!=
«« 
_isNonBinary
««  ,
)
««, -
OnPropertyChanged
»» !
(
»»! "
nameof
»»" (
(
»»( )
IsNonBinary
»») 4
)
»»4 5
)
»»5 6
;
»»6 7
}
…… 	
private
ÀÀ 
async
ÀÀ 
Task
ÀÀ 
LoadDefaultAvatar
ÀÀ ,
(
ÀÀ, -
)
ÀÀ- .
{
ÃÃ 	
var
ÕÕ 
client
ÕÕ 
=
ÕÕ 
new
ÕÕ &
UserProfileServiceClient
ÕÕ 5
(
ÕÕ5 6
)
ÕÕ6 7
;
ÕÕ7 8
bool
ŒŒ 
success
ŒŒ 
=
ŒŒ 
false
ŒŒ  
;
ŒŒ  !
try
œœ 
{
–– 
var
—— 
avatars
—— 
=
—— 
await
—— #
client
——$ *
.
——* +&
GetAvailableAvatarsAsync
——+ C
(
——C D
)
——D E
;
——E F
if
““ 
(
““ 
avatars
““ 
!=
““ 
null
““ #
&&
““$ &
avatars
““' .
.
““. /
Any
““/ 2
(
““2 3
)
““3 4
)
““4 5
{
”” 
var
‘‘ 
defaultAvatar
‘‘ %
=
‘‘& '
avatars
‘‘( /
.
‘‘/ 0
FirstOrDefault
‘‘0 >
(
‘‘> ?
a
‘‘? @
=>
‘‘A C
a
‘‘D E
.
‘‘E F
IdAvatar
‘‘F N
==
‘‘O Q
$num
‘‘R S
)
‘‘S T
??
‘‘U W
avatars
‘‘X _
[
‘‘_ `
$num
‘‘` a
]
‘‘a b
;
‘‘b c
SelectedAvatarId
’’ $
=
’’% &
defaultAvatar
’’' 4
.
’’4 5
IdAvatar
’’5 =
;
’’= >!
SelectedAvatarImage
÷÷ '
=
÷÷( ) 
ConvertByteToImage
÷÷* <
(
÷÷< =
defaultAvatar
÷÷= J
.
÷÷J K

AvatarData
÷÷K U
)
÷÷U V
;
÷÷V W
}
◊◊ 
client
ÿÿ 
.
ÿÿ 
Close
ÿÿ 
(
ÿÿ 
)
ÿÿ 
;
ÿÿ 
success
ŸŸ 
=
ŸŸ 
true
ŸŸ 
;
ŸŸ 
}
⁄⁄ 
catch
€€ 
(
€€ 
FaultException
€€ !
)
€€! "
{
‹‹ 

MessageBox
›› 
.
›› 
Show
›› 
(
››  
Lang
››  $
.
››$ %%
alertServerErrorMessage
››% <
,
››< =
Lang
››> B
.
››B C
alertErrorTitle
››C R
,
››R S
MessageBoxButton
››T d
.
››d e
OK
››e g
,
››g h
MessageBoxImage
››i x
.
››x y
Error
››y ~
)
››~ 
;›› Ä
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ '
EndpointNotFoundException
ﬂﬂ ,
)
ﬂﬂ, -
{
‡‡ 

MessageBox
·· 
.
·· 
Show
·· 
(
··  
Lang
··  $
.
··$ %)
alertConnectionErrorMessage
··% @
,
··@ A
Lang
··B F
.
··F G'
alertConnectionErrorTitle
··G `
,
··` a
MessageBoxButton
··b r
.
··r s
OK
··s u
,
··u v
MessageBoxImage··w Ü
.··Ü á
Error··á å
)··å ç
;··ç é
}
‚‚ 
catch
„„ 
{
‰‰ 

MessageBox
ÂÂ 
.
ÂÂ 
Show
ÂÂ 
(
ÂÂ  
Lang
ÂÂ  $
.
ÂÂ$ %"
alertAvatarLoadError
ÂÂ% 9
,
ÂÂ9 :
Lang
ÂÂ; ?
.
ÂÂ? @
alertErrorTitle
ÂÂ@ O
,
ÂÂO P
MessageBoxButton
ÂÂQ a
.
ÂÂa b
OK
ÂÂb d
,
ÂÂd e
MessageBoxImage
ÂÂf u
.
ÂÂu v
Error
ÂÂv {
)
ÂÂ{ |
;
ÂÂ| }
}
ÊÊ 
finally
ÁÁ 
{
ËË 
if
ÈÈ 
(
ÈÈ 
!
ÈÈ 
success
ÈÈ 
&&
ÈÈ 
client
ÈÈ  &
.
ÈÈ& '
State
ÈÈ' ,
!=
ÈÈ- / 
CommunicationState
ÈÈ0 B
.
ÈÈB C
Closed
ÈÈC I
)
ÈÈI J
client
ÍÍ 
.
ÍÍ 
Abort
ÍÍ  
(
ÍÍ  !
)
ÍÍ! "
;
ÍÍ" #
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ $
OpenSelectAvatarDialog
ÓÓ +
(
ÓÓ+ ,
object
ÓÓ, 2
	parameter
ÓÓ3 <
)
ÓÓ< =
{
ÔÔ 	
var
 
selectAvatarView
  
=
! "
new
# &
SelectAvatarView
' 7
(
7 8
)
8 9
;
9 :
var
ÒÒ #
selectAvatarViewModel
ÒÒ %
=
ÒÒ& '
new
ÒÒ( +#
SelectAvatarViewModel
ÒÒ, A
(
ÒÒA B
SelectedAvatarId
ÒÒB R
)
ÒÒR S
;
ÒÒS T#
selectAvatarViewModel
ÚÚ !
.
ÚÚ! "
AvatarSelected
ÚÚ" 0
+=
ÚÚ1 3
OnAvatarSelected
ÚÚ4 D
;
ÚÚD E
selectAvatarView
ÛÛ 
.
ÛÛ 
DataContext
ÛÛ (
=
ÛÛ) *#
selectAvatarViewModel
ÛÛ+ @
;
ÛÛ@ A
selectAvatarView
ÙÙ 
.
ÙÙ 

ShowDialog
ÙÙ '
(
ÙÙ' (
)
ÙÙ( )
;
ÙÙ) *#
selectAvatarViewModel
ıı !
.
ıı! "
AvatarSelected
ıı" 0
-=
ıı1 3
OnAvatarSelected
ıı4 D
;
ııD E
}
ˆˆ 	
private
¯¯ 
void
¯¯ 
OnAvatarSelected
¯¯ %
(
¯¯% &
AvatarModel
¯¯& 1
avatar
¯¯2 8
)
¯¯8 9
{
˘˘ 	
if
˙˙ 
(
˙˙ 
avatar
˙˙ 
!=
˙˙ 
null
˙˙ 
)
˙˙ 
{
˚˚ 
SelectedAvatarId
¸¸  
=
¸¸! "
avatar
¸¸# )
.
¸¸) *
Id
¸¸* ,
;
¸¸, -!
SelectedAvatarImage
˝˝ #
=
˝˝$ %
avatar
˝˝& ,
.
˝˝, -
ImageSource
˝˝- 8
;
˝˝8 9
}
˛˛ 
}
ˇˇ 	
private
ÅÅ 
static
ÅÅ 
bool
ÅÅ 
IsValidEmail
ÅÅ (
(
ÅÅ( )
string
ÅÅ) /
email
ÅÅ0 5
)
ÅÅ5 6
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
string
ÉÉ 
.
ÉÉ  
IsNullOrWhiteSpace
ÉÉ )
(
ÉÉ) *
email
ÉÉ* /
)
ÉÉ/ 0
)
ÉÉ0 1
return
ÑÑ 
false
ÑÑ 
;
ÑÑ 
try
ÜÜ 
{
áá 
var
àà 
regex
àà 
=
àà 
new
àà 
Regex
àà  %
(
àà% &
$str
àà& H
,
ààH I
RegexOptions
ààJ V
.
ààV W

IgnoreCase
ààW a
,
ààa b
TimeSpan
ààc k
.
ààk l
FromMilliseconds
ààl |
(
àà| }
$numàà} Ä
)ààÄ Å
)ààÅ Ç
;ààÇ É
return
ââ 
regex
ââ 
.
ââ 
IsMatch
ââ $
(
ââ$ %
email
ââ% *
)
ââ* +
;
ââ+ ,
}
ää 
catch
ãã 
(
ãã (
RegexMatchTimeoutException
ãã -
)
ãã- .
{
åå 
return
çç 
false
çç 
;
çç 
}
éé 
}
èè 	
private
ëë 
static
ëë 
bool
ëë 
IsPasswordSecure
ëë ,
(
ëë, -
string
ëë- 3
password
ëë4 <
,
ëë< =
out
ëë> A
string
ëëB H
errorLangKey
ëëI U
)
ëëU V
{
íí 	
if
ìì 
(
ìì 
string
ìì 
.
ìì  
IsNullOrWhiteSpace
ìì )
(
ìì) *
password
ìì* 2
)
ìì2 3
)
ìì3 4
{
îî 
errorLangKey
ïï 
=
ïï 
$str
ïï 3
;
ïï3 4
return
ññ 
false
ññ 
;
ññ 
}
óó 
if
òò 
(
òò 
password
òò 
.
òò 
Length
òò 
<
òò  !
$num
òò" #
)
òò# $
{
ôô 
errorLangKey
öö 
=
öö 
$str
öö 6
;
öö6 7
return
õõ 
false
õõ 
;
õõ 
}
úú 
if
ùù 
(
ùù 
password
ùù 
.
ùù 
Length
ùù 
>
ùù  !
$num
ùù" $
)
ùù$ %
{
ûû 
errorLangKey
üü 
=
üü 
$str
üü 5
;
üü5 6
return
†† 
false
†† 
;
†† 
}
°° 
if
¢¢ 
(
¢¢ 
!
¢¢ 
password
¢¢ 
.
¢¢ 
Any
¢¢ 
(
¢¢ 
char
¢¢ "
.
¢¢" #
IsUpper
¢¢# *
)
¢¢* +
)
¢¢+ ,
{
££ 
errorLangKey
§§ 
=
§§ 
$str
§§ 8
;
§§8 9
return
•• 
false
•• 
;
•• 
}
¶¶ 
if
ßß 
(
ßß 
!
ßß 
password
ßß 
.
ßß 
Any
ßß 
(
ßß 
char
ßß "
.
ßß" #
IsLower
ßß# *
)
ßß* +
)
ßß+ ,
{
®® 
errorLangKey
©© 
=
©© 
$str
©© 8
;
©©8 9
return
™™ 
false
™™ 
;
™™ 
}
´´ 
if
¨¨ 
(
¨¨ 
!
¨¨ 
password
¨¨ 
.
¨¨ 
Any
¨¨ 
(
¨¨ 
char
¨¨ "
.
¨¨" #
IsDigit
¨¨# *
)
¨¨* +
)
¨¨+ ,
{
≠≠ 
errorLangKey
ÆÆ 
=
ÆÆ 
$str
ÆÆ 8
;
ÆÆ8 9
return
ØØ 
false
ØØ 
;
ØØ 
}
∞∞ 
if
±± 
(
±± 
password
±± 
.
±± 
All
±± 
(
±± 
char
±± !
.
±±! "
IsLetterOrDigit
±±" 1
)
±±1 2
)
±±2 3
{
≤≤ 
errorLangKey
≥≥ 
=
≥≥ 
$str
≥≥ :
;
≥≥: ;
return
¥¥ 
false
¥¥ 
;
¥¥ 
}
µµ 
if
∂∂ 
(
∂∂ 
!
∂∂ 
password
∂∂ 
.
∂∂ 
Contains
∂∂ "
(
∂∂" #
$str
∂∂# &
)
∂∂& '
)
∂∂' (
{
∑∑ 
errorLangKey
∏∏ 
=
∏∏ 
$str
∏∏ 8
;
∏∏8 9
return
ππ 
false
ππ 
;
ππ 
}
∫∫ 
errorLangKey
ºº 
=
ºº 
null
ºº 
;
ºº  
return
ΩΩ 
true
ΩΩ 
;
ΩΩ 
}
ææ 	
private
¿¿ 
bool
¿¿ 
CanExecuteSignUp
¿¿ %
(
¿¿% &
object
¿¿& ,
	parameter
¿¿- 6
)
¿¿6 7
{
¡¡ 	
return
¬¬ 
!
¬¬ 
string
¬¬ 
.
¬¬  
IsNullOrWhiteSpace
¬¬ -
(
¬¬- .
Username
¬¬. 6
)
¬¬6 7
&&
¬¬8 :
!
√√ 
string
√√ 
.
√√  
IsNullOrWhiteSpace
√√ -
(
√√- .
	FirstName
√√. 7
)
√√7 8
&&
√√9 ;
!
ƒƒ 
string
ƒƒ 
.
ƒƒ  
IsNullOrWhiteSpace
ƒƒ -
(
ƒƒ- .
LastName
ƒƒ. 6
)
ƒƒ6 7
&&
ƒƒ8 :
!
≈≈ 
string
≈≈ 
.
≈≈  
IsNullOrWhiteSpace
≈≈ -
(
≈≈- .
Email
≈≈. 3
)
≈≈3 4
&&
≈≈5 7
!
∆∆ 
string
∆∆ 
.
∆∆  
IsNullOrWhiteSpace
∆∆ -
(
∆∆- .
Password
∆∆. 6
)
∆∆6 7
&&
∆∆8 :
(
«« 
IsMale
«« 
||
«« 
IsFemale
«« &
||
««' )
IsNonBinary
««* 5
)
««5 6
;
««6 7
}
»» 	
private
   
async
   
void
   
ExecuteSignUp
   (
(
  ( )
object
  ) /
	parameter
  0 9
)
  9 :
{
ÀÀ 	
if
ÃÃ 
(
ÃÃ 
!
ÃÃ 
CanExecuteSignUp
ÃÃ !
(
ÃÃ! "
	parameter
ÃÃ" +
)
ÃÃ+ ,
)
ÃÃ, -
{
ÕÕ 

MessageBox
ŒŒ 
.
ŒŒ 
Show
ŒŒ 
(
ŒŒ  
Lang
ŒŒ  $
.
ŒŒ$ %$
alertAllFieldsRequired
ŒŒ% ;
,
ŒŒ; <
Lang
ŒŒ= A
.
ŒŒA B"
alertInputErrorTitle
ŒŒB V
,
ŒŒV W
MessageBoxButton
ŒŒX h
.
ŒŒh i
OK
ŒŒi k
,
ŒŒk l
MessageBoxImage
ŒŒm |
.
ŒŒ| }
WarningŒŒ} Ñ
)ŒŒÑ Ö
;ŒŒÖ Ü
return
œœ 
;
œœ 
}
–– 
if
““ 
(
““ 
!
““ 
IsValidEmail
““ 
(
““ 
Email
““ #
)
““# $
)
““$ %
{
”” 

MessageBox
‘‘ 
.
‘‘ 
Show
‘‘ 
(
‘‘  
Lang
‘‘  $
.
‘‘$ %%
alertInvalidEmailFormat
‘‘% <
,
‘‘< =
Lang
‘‘> B
.
‘‘B C$
alertInvalidEmailTitle
‘‘C Y
,
‘‘Y Z
MessageBoxButton
‘‘[ k
.
‘‘k l
OK
‘‘l n
,
‘‘n o
MessageBoxImage
‘‘p 
.‘‘ Ä
Warning‘‘Ä á
)‘‘á à
;‘‘à â
return
’’ 
;
’’ 
}
÷÷ 
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
IsPasswordSecure
ÿÿ !
(
ÿÿ! "
Password
ÿÿ" *
,
ÿÿ* +
out
ÿÿ, /
string
ÿÿ0 6
passwordErrorKey
ÿÿ7 G
)
ÿÿG H
)
ÿÿH I
{
ŸŸ 
string
⁄⁄ "
passwordErrorMessage
⁄⁄ +
=
⁄⁄, -
Lang
⁄⁄. 2
.
⁄⁄2 3
ResourceManager
⁄⁄3 B
.
⁄⁄B C
	GetString
⁄⁄C L
(
⁄⁄L M
passwordErrorKey
⁄⁄M ]
)
⁄⁄] ^
??
⁄⁄_ a
Lang
⁄⁄b f
.
⁄⁄f g(
alertPasswordGenericError⁄⁄g Ä
;⁄⁄Ä Å

MessageBox
€€ 
.
€€ 
Show
€€ 
(
€€  "
passwordErrorMessage
€€  4
,
€€4 5
Lang
€€6 :
.
€€: ;)
alertPasswordNotSecureTitle
€€; V
,
€€V W
MessageBoxButton
€€X h
.
€€h i
OK
€€i k
,
€€k l
MessageBoxImage
€€m |
.
€€| }
Warning€€} Ñ
)€€Ñ Ö
;€€Ö Ü
return
‹‹ 
;
‹‹ 
}
›› 
int
ﬂﬂ 
genderId
ﬂﬂ 
;
ﬂﬂ 
if
‡‡ 
(
‡‡ 
IsMale
‡‡ 
)
‡‡ 
{
·· 
genderId
‚‚ 
=
‚‚ 
$num
‚‚ 
;
‚‚ 
}
„„ 
else
‰‰ 
if
‰‰ 
(
‰‰ 
IsFemale
‰‰ 
)
‰‰ 
{
ÂÂ 
genderId
ÊÊ 
=
ÊÊ 
$num
ÊÊ 
;
ÊÊ 
}
ÁÁ 
else
ËË 
{
ÈÈ 
genderId
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
var
ÏÏ 
newUserProfile
ÏÏ 
=
ÏÏ  
new
ÏÏ! $
AuthService
ÏÏ% 0
.
ÏÏ0 1
UserProfileDto
ÏÏ1 ?
{
ÌÌ 
Username
ÓÓ 
=
ÓÓ 
Username
ÓÓ #
,
ÓÓ# $
	FirstName
ÔÔ 
=
ÔÔ 
	FirstName
ÔÔ %
,
ÔÔ% &
LastName
 
=
 
LastName
 #
,
# $
Email
ÒÒ 
=
ÒÒ 
Email
ÒÒ 
,
ÒÒ 
GenderId
ÚÚ 
=
ÚÚ 
genderId
ÚÚ #
,
ÚÚ# $
AvatarId
ÛÛ 
=
ÛÛ 
SelectedAvatarId
ÛÛ +
}
ÙÙ 
;
ÙÙ 
var
ˆˆ 
client
ˆˆ 
=
ˆˆ 
new
ˆˆ )
AuthenticationServiceClient
ˆˆ 8
(
ˆˆ8 9
)
ˆˆ9 :
;
ˆˆ: ;
bool
˜˜ 
success
˜˜ 
=
˜˜ 
false
˜˜  
;
˜˜  !
try
¯¯ 
{
˘˘ 
var
˙˙ 
result
˙˙ 
=
˙˙ 
await
˙˙ "
client
˙˙# )
.
˙˙) *
RegisterAsync
˙˙* 7
(
˙˙7 8
newUserProfile
˙˙8 F
,
˙˙F G
Password
˙˙H P
)
˙˙P Q
;
˙˙Q R
if
¸¸ 
(
¸¸ 
result
¸¸ 
.
¸¸ 
Success
¸¸ "
)
¸¸" #
{
˝˝ 

MessageBox
˛˛ 
.
˛˛ 
Show
˛˛ #
(
˛˛# $
Lang
˛˛$ (
.
˛˛( )&
alertRegistrationSuccess
˛˛) A
+
˛˛B C
$str
˛˛D G
+
˛˛H I
result
˛˛J P
.
˛˛P Q
Message
˛˛Q X
,
˛˛X Y
Lang
˛˛Z ^
.
˛˛^ _
alertSuccessTitle
˛˛_ p
,
˛˛p q
MessageBoxButton˛˛r Ç
.˛˛Ç É
OK˛˛É Ö
,˛˛Ö Ü
MessageBoxImage˛˛á ñ
.˛˛ñ ó
Information˛˛ó ¢
)˛˛¢ £
;˛˛£ §$
OpenVerificationDialog
ˇˇ *
(
ˇˇ* +
	parameter
ˇˇ+ 4
)
ˇˇ4 5
;
ˇˇ5 6
client
ÄÄ 
.
ÄÄ 
Close
ÄÄ  
(
ÄÄ  !
)
ÄÄ! "
;
ÄÄ" #
success
ÅÅ 
=
ÅÅ 
true
ÅÅ "
;
ÅÅ" #
}
ÇÇ 
else
ÉÉ 
{
ÑÑ 

MessageBox
ÖÖ 
.
ÖÖ 
Show
ÖÖ #
(
ÖÖ# $
result
ÖÖ$ *
.
ÖÖ* +
Message
ÖÖ+ 2
,
ÖÖ2 3
Lang
ÖÖ4 8
.
ÖÖ8 9)
alertRegistrationErrorTitle
ÖÖ9 T
,
ÖÖT U
MessageBoxButton
ÖÖV f
.
ÖÖf g
OK
ÖÖg i
,
ÖÖi j
MessageBoxImage
ÖÖk z
.
ÖÖz {
ErrorÖÖ{ Ä
)ÖÖÄ Å
;ÖÖÅ Ç
}
ÜÜ 
}
áá 
catch
àà 
(
àà 
FaultException
àà !
<
àà! "
string
àà" (
>
àà( )
fex
àà* -
)
àà- .
{
ââ 

MessageBox
ää 
.
ää 
Show
ää 
(
ää  
fex
ää  #
.
ää# $
Detail
ää$ *
,
ää* +
Lang
ää, 0
.
ää0 1)
alertRegistrationErrorTitle
ää1 L
,
ääL M
MessageBoxButton
ääN ^
.
ää^ _
OK
ää_ a
,
ääa b
MessageBoxImage
ääc r
.
äär s
Error
ääs x
)
ääx y
;
ääy z
}
ãã 
catch
åå 
(
åå 
FaultException
åå !
)
åå! "
{
çç 

MessageBox
éé 
.
éé 
Show
éé 
(
éé  
Lang
éé  $
.
éé$ %%
alertServerErrorMessage
éé% <
,
éé< =
Lang
éé> B
.
ééB C
alertErrorTitle
ééC R
,
ééR S
MessageBoxButton
ééT d
.
ééd e
OK
éée g
,
éég h
MessageBoxImage
ééi x
.
ééx y
Error
ééy ~
)
éé~ 
;éé Ä
}
èè 
catch
êê 
(
êê '
EndpointNotFoundException
êê ,
)
êê, -
{
ëë 

MessageBox
íí 
.
íí 
Show
íí 
(
íí  
Lang
íí  $
.
íí$ %)
alertConnectionErrorMessage
íí% @
,
íí@ A
Lang
ííB F
.
ííF G'
alertConnectionErrorTitle
ííG `
,
íí` a
MessageBoxButton
ííb r
.
íír s
OK
íís u
,
ííu v
MessageBoxImageííw Ü
.ííÜ á
Errorííá å
)ííå ç
;ííç é
}
ìì 
catch
îî 
{
ïï 

MessageBox
ññ 
.
ññ 
Show
ññ 
(
ññ  
Lang
ññ  $
.
ññ$ %&
alertUnknownErrorMessage
ññ% =
,
ññ= >
Lang
ññ? C
.
ññC D
alertErrorTitle
ññD S
,
ññS T
MessageBoxButton
ññU e
.
ññe f
OK
ññf h
,
ññh i
MessageBoxImage
ññj y
.
ññy z
Error
ññz 
)ññ Ä
;ññÄ Å
}
óó 
finally
òò 
{
ôô 
if
öö 
(
öö 
!
öö 
success
öö 
&&
öö 
client
öö  &
.
öö& '
State
öö' ,
!=
öö- / 
CommunicationState
öö0 B
.
ööB C
Closed
ööC I
)
ööI J
client
õõ 
.
õõ 
Abort
õõ  
(
õõ  !
)
õõ! "
;
õõ" #
}
úú 
}
ùù 	
private
üü 
void
üü $
OpenVerificationDialog
üü +
(
üü+ ,
object
üü, 2
	parameter
üü3 <
)
üü< =
{
†† 	
var
°° 

verifyView
°° 
=
°° 
new
°°  
VerifyByCodeView
°°! 1
(
°°1 2
)
°°2 3
;
°°3 4

verifyView
¢¢ 
.
¢¢ 
DataContext
¢¢ "
=
¢¢# $
new
¢¢% (#
VerifyByCodeViewModel
¢¢) >
(
¢¢> ?
Email
¢¢? D
)
¢¢D E
;
¢¢E F

verifyView
££ 
.
££ 
Show
££ 
(
££ 
)
££ 
;
££ 
if
•• 
(
•• 
	parameter
•• 
is
•• 
Window
•• #
signUpWindow
••$ 0
)
••0 1
signUpWindow
¶¶ 
.
¶¶ 
Close
¶¶ "
(
¶¶" #
)
¶¶# $
;
¶¶$ %
}
ßß 	
private
©© 
static
©© 
void
©©  
ExecuteCloseWindow
©© .
(
©©. /
object
©©/ 5
	parameter
©©6 ?
)
©©? @
{
™™ 	
if
´´ 
(
´´ 
	parameter
´´ 
is
´´ 
Window
´´ #
)
´´# $
Application
¨¨ 
.
¨¨ 
Current
¨¨ #
.
¨¨# $
Shutdown
¨¨$ ,
(
¨¨, -
)
¨¨- .
;
¨¨. /
}
≠≠ 	
private
ØØ 
static
ØØ 
void
ØØ #
ExecuteMaximizeWindow
ØØ 1
(
ØØ1 2
object
ØØ2 8
	parameter
ØØ9 B
)
ØØB C
{
∞∞ 	
if
±± 
(
±± 
	parameter
±± 
is
±± 
Window
±± #
window
±±$ *
)
±±* +
window
≤≤ 
.
≤≤ 
WindowState
≤≤ "
=
≤≤# $
window
≤≤% +
.
≤≤+ ,
WindowState
≤≤, 7
==
≤≤8 :
WindowState
≤≤; F
.
≤≤F G
	Maximized
≤≤G P
?
≤≤Q R
WindowState
≤≤S ^
.
≤≤^ _
Normal
≤≤_ e
:
≤≤f g
WindowState
≤≤h s
.
≤≤s t
	Maximized
≤≤t }
;
≤≤} ~
}
≥≥ 	
private
µµ 
static
µµ 
void
µµ #
ExecuteMinimizeWindow
µµ 1
(
µµ1 2
object
µµ2 8
	parameter
µµ9 B
)
µµB C
{
∂∂ 	
if
∑∑ 
(
∑∑ 
	parameter
∑∑ 
is
∑∑ 
Window
∑∑ #
window
∑∑$ *
)
∑∑* +
window
∏∏ 
.
∏∏ 
WindowState
∏∏ "
=
∏∏# $
WindowState
∏∏% 0
.
∏∏0 1
	Minimized
∏∏1 :
;
∏∏: ;
}
ππ 	
private
ªª 
static
ªª 
void
ªª 
ExecuteReturn
ªª )
(
ªª) *
object
ªª* 0
	parameter
ªª1 :
)
ªª: ;
{
ºº 	
if
ΩΩ 
(
ΩΩ 
	parameter
ΩΩ 
is
ΩΩ 
Window
ΩΩ #
currentWindow
ΩΩ$ 1
)
ΩΩ1 2
{
ææ 
var
øø 
welcomeView
øø 
=
øø  !
new
øø" %
WelcomeView
øø& 1
(
øø1 2
)
øø2 3
;
øø3 4
welcomeView
¿¿ 
.
¿¿ 
Show
¿¿  
(
¿¿  !
)
¿¿! "
;
¿¿" #
currentWindow
¡¡ 
.
¡¡ 
Close
¡¡ #
(
¡¡# $
)
¡¡$ %
;
¡¡% &
}
¬¬ 
}
√√ 	
public
≈≈ 
static
≈≈ 
BitmapImage
≈≈ ! 
ConvertByteToImage
≈≈" 4
(
≈≈4 5
byte
≈≈5 9
[
≈≈9 :
]
≈≈: ;

imageBytes
≈≈< F
)
≈≈F G
{
∆∆ 	
if
«« 
(
«« 

imageBytes
«« 
==
«« 
null
«« "
||
««# %

imageBytes
««& 0
.
««0 1
Length
««1 7
==
««8 :
$num
««; <
)
««< =
return
»» 
null
»» 
;
»» 
var
   
image
   
=
   
new
   
BitmapImage
   '
(
  ' (
)
  ( )
;
  ) *
using
ÀÀ 
(
ÀÀ 
var
ÀÀ 
mem
ÀÀ 
=
ÀÀ 
new
ÀÀ  
MemoryStream
ÀÀ! -
(
ÀÀ- .

imageBytes
ÀÀ. 8
)
ÀÀ8 9
)
ÀÀ9 :
{
ÃÃ 
mem
ÕÕ 
.
ÕÕ 
Position
ÕÕ 
=
ÕÕ 
$num
ÕÕ  
;
ÕÕ  !
image
ŒŒ 
.
ŒŒ 
	BeginInit
ŒŒ 
(
ŒŒ  
)
ŒŒ  !
;
ŒŒ! "
image
œœ 
.
œœ 
CreateOptions
œœ #
=
œœ$ %!
BitmapCreateOptions
œœ& 9
.
œœ9 :!
PreservePixelFormat
œœ: M
;
œœM N
image
–– 
.
–– 
CacheOption
–– !
=
––" #
BitmapCacheOption
––$ 5
.
––5 6
OnLoad
––6 <
;
––< =
image
—— 
.
—— 
	UriSource
—— 
=
——  !
null
——" &
;
——& '
image
““ 
.
““ 
StreamSource
““ "
=
““# $
mem
““% (
;
““( )
image
”” 
.
”” 
EndInit
”” 
(
”” 
)
”” 
;
””  
}
‘‘ 
image
’’ 
.
’’ 
Freeze
’’ 
(
’’ 
)
’’ 
;
’’ 
return
÷÷ 
image
÷÷ 
;
÷÷ 
}
◊◊ 	
}
ÿÿ 
}ŸŸ æ¬
ùC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Matches\MatchesViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Matches& -
{ 
public 

class 
MatchesViewModel !
:" #
ViewModelBase$ 1
{ 
private 
bool !
_isPublicViewSelected *
=+ ,
true- 1
;1 2
private 
string 

_matchCode !
;! "
private  
ObservableCollection $
<$ %
MatchInfoModel% 3
>3 4
_publicMatches5 C
;C D
private 
string 
_joiningMatchId &
=' (
null) -
;- .
private 
bool  
_joiningPrivateMatch )
=* +
false, 1
;1 2
private 
Window 
_currentWindow %
=& '
null( ,
;, -
public 
bool  
IsPublicViewSelected (
{ 	
get 
=> !
_isPublicViewSelected (
;( )
set 
=> 
SetProperty 
( 
ref "!
_isPublicViewSelected# 8
,8 9
value: ?
)? @
;@ A
} 	
public 
string 
	MatchCode 
{ 	
get   
=>   

_matchCode   
;   
set!! 
=>!! 
SetProperty!! 
(!! 
ref!! "

_matchCode!!# -
,!!- .
value!!/ 4
)!!4 5
;!!5 6
}"" 	
private$$ 
bool$$ 

_isJoining$$ 
;$$  
public%% 
bool%% 
	IsJoining%% 
{&& 	
get'' 
=>'' 

_isJoining'' 
;'' 
set(( 
{)) 
if** 
(** 
SetProperty** 
(**  
ref**  #

_isJoining**$ .
,**. /
value**0 5
)**5 6
)**6 7
{++ 
Application,, 
.,,  
Current,,  '
?,,' (
.,,( )

Dispatcher,,) 3
.,,3 4
Invoke,,4 :
(,,: ;
(,,; <
),,< =
=>,,> @
{-- 
CommandManager.. &
...& '&
InvalidateRequerySuggested..' A
(..A B
)..B C
;..C D
}// 
)// 
;// 
}00 
}11 
}22 	
public44  
ObservableCollection44 #
<44# $
MatchInfoModel44$ 2
>442 3
PublicMatches444 A
{55 	
get66 
=>66 
_publicMatches66 !
;66! "
set77 
=>77 
SetProperty77 
(77 
ref77 "
_publicMatches77# 1
,771 2
value773 8
)778 9
;779 :
}88 	
public:: 
RelayCommand:: $
ShowPublicMatchesCommand:: 4
{::5 6
get::7 :
;::: ;
private::< C
set::D G
;::G H
}::I J
public;; 
RelayCommand;; %
ShowPrivateMatchesCommand;; 5
{;;6 7
get;;8 ;
;;;; <
private;;= D
set;;E H
;;;H I
};;J K
public<< 
RelayCommand<< "
JoinPublicMatchCommand<< 2
{<<3 4
get<<5 8
;<<8 9
private<<: A
set<<B E
;<<E F
}<<G H
public== 
RelayCommand== #
JoinPrivateMatchCommand== 3
{==4 5
get==6 9
;==9 :
private==; B
set==C F
;==F G
}==H I
public>> 
RelayCommand>> 
RefreshCommand>> *
{>>+ ,
get>>- 0
;>>0 1
set>>3 6
;>>6 7
}>>8 9
public?? 
RelayCommand?? 
ReturnCommand?? )
{??* +
get??, /
;??/ 0
private??1 8
set??9 <
;??< =
}??> ?
publicAA 
MatchesViewModelAA 
(AA  
)AA  !
{BB 	
PublicMatchesCC 
=CC 
newCC  
ObservableCollectionCC  4
<CC4 5
MatchInfoModelCC5 C
>CCC D
(CCD E
)CCE F
;CCF G$
ShowPublicMatchesCommandEE $
=EE% &
newEE' *
RelayCommandEE+ 7
(EE7 8
(EE8 9
pEE9 :
)EE: ;
=>EE< > 
IsPublicViewSelectedEE? S
=EET U
trueEEV Z
)EEZ [
;EE[ \%
ShowPrivateMatchesCommandFF %
=FF& '
newFF( +
RelayCommandFF, 8
(FF8 9
(FF9 :
pFF: ;
)FF; <
=>FF= ? 
IsPublicViewSelectedFF@ T
=FFU V
falseFFW \
)FF\ ]
;FF] ^"
JoinPublicMatchCommandGG "
=GG# $
newGG% (
RelayCommandGG) 5
(GG5 6"
ExecuteJoinPublicMatchGG6 L
,GGL M
CanExecuteJoinGGN \
)GG\ ]
;GG] ^#
JoinPrivateMatchCommandHH #
=HH$ %
newHH& )
RelayCommandHH* 6
(HH6 7
asyncHH7 <
(HH= >
pHH> ?
)HH? @
=>HHA C
awaitHHD I(
ExecuteJoinPrivateMatchAsyncHHJ f
(HHf g
pHHg h
)HHh i
,HHi j
CanExecuteJoinHHk y
)HHy z
;HHz {
ReturnCommandII 
=II 
newII 
RelayCommandII  ,
(II, -
ExecuteReturnII- :
)II: ;
;II; <$
MatchmakingClientManagerKK $
.KK$ %
InstanceKK% -
.KK- .&
OnPublicMatchesListUpdatedKK. H
+=KKI K&
OnPublicMatchesListUpdatedKKL f
;KKf g$
MatchmakingClientManagerLL $
.LL$ %
InstanceLL% -
.LL- .%
OnMatchJoinedSuccessfullyLL. G
+=LLH J
OnMatchJoinedLLK X
;LLX Y$
MatchmakingClientManagerMM $
.MM$ %
InstanceMM% -
.MM- .
OnMatchmakingFailedMM. A
+=MMB D
OnMatchmakingFailedMME X
;MMX Y
LoadPublicMatchesOO 
(OO 
)OO 
;OO  
}PP 	
privateRR 
boolRR 
CanExecuteJoinRR #
(RR# $
objectRR$ *
	parameterRR+ 4
)RR4 5
{SS 	
returnTT 
!TT 
	IsJoiningTT 
;TT 
}UU 	
privateWW 
asyncWW 
TaskWW 
LoadPublicMatchesWW ,
(WW, -
)WW- .
{XX 	
varYY 

matchesDtoYY 
=YY 
awaitYY "$
MatchmakingClientManagerYY# ;
.YY; <
InstanceYY< D
.YYD E!
GetPublicMatchesAsyncYYE Z
(YYZ [
)YY[ \
;YY\ ]&
OnPublicMatchesListUpdatedZZ &
(ZZ& '

matchesDtoZZ' 1
)ZZ1 2
;ZZ2 3
}[[ 	
private]] 
void]] "
ExecuteJoinPublicMatch]] +
(]]+ ,
object]], 2
	parameter]]3 <
)]]< =
{^^ 	
if__ 
(__ 
	IsJoining__ 
)__ 
return__ !
;__! "
	IsJoining`` 
=`` 
true`` 
;`` 
ifbb 
(bb 
	parameterbb 
isbb 
MatchInfoModelbb +
	matchInfobb, 5
&&bb6 8
	matchInfobb9 B
.bbB C
CanJoinbbC J
)bbJ K
{cc 
_joiningMatchIddd 
=dd  !
	matchInfodd" +
.dd+ ,
MatchIddd, 3
;dd3 4 
_joiningPrivateMatchee $
=ee% &
falseee' ,
;ee, -
_currentWindowff 
=ff  
FindParentWindowff! 1
(ff1 2
)ff2 3
;ff3 4$
MatchmakingClientManagerhh (
.hh( )
Instancehh) 1
.hh1 2
JoinPublicMatchhh2 A
(hhA B
	matchInfohhB K
.hhK L
MatchIdhhL S
)hhS T
;hhT U
}ii 
elsejj 
ifjj 
(jj 
	parameterjj 
isjj !
stringjj" (
matchIdjj) 0
)jj0 1
{kk 
_joiningMatchIdll 
=ll  !
matchIdll" )
;ll) * 
_joiningPrivateMatchmm $
=mm% &
falsemm' ,
;mm, -
_currentWindownn 
=nn  
FindParentWindownn! 1
(nn1 2
)nn2 3
;nn3 4$
MatchmakingClientManageroo (
.oo( )
Instanceoo) 1
.oo1 2
JoinPublicMatchoo2 A
(ooA B
matchIdooB I
)ooI J
;ooJ K
}pp 
elseqq 
{rr 

MessageBoxss 
.ss 
Showss 
(ss  
$strss  M
,ssM N
$strssO V
)ssV W
;ssW X
}tt 
}uu 	
privateww 
asyncww 
Taskww (
ExecuteJoinPrivateMatchAsyncww 7
(ww7 8
objectww8 >
	parameterww? H
)wwH I
{xx 	
ifyy 
(yy 
stringyy 
.yy 
IsNullOrWhiteSpaceyy )
(yy) *
	MatchCodeyy* 3
)yy3 4
)yy4 5
{zz 

MessageBox{{ 
.{{ 
Show{{ 
({{  

Properties{{  *
.{{* +
Langs{{+ 0
.{{0 1
Lang{{1 5
.{{5 6*
alertPrivateMatchesErrorNoCode{{6 T
){{T U
;{{U V
return|| 
;|| 
}}} 
if 
( 
	IsJoining 
) 
return !
;! "
	IsJoining
ÄÄ 
=
ÄÄ 
true
ÄÄ 
;
ÄÄ 
string
ÇÇ 

codeToJoin
ÇÇ 
=
ÇÇ 
	MatchCode
ÇÇ  )
.
ÇÇ) *
ToUpper
ÇÇ* 1
(
ÇÇ1 2
)
ÇÇ2 3
;
ÇÇ3 4
var
ÉÉ 
result
ÉÉ 
=
ÉÉ 
await
ÉÉ &
MatchmakingClientManager
ÉÉ 7
.
ÉÉ7 8
Instance
ÉÉ8 @
.
ÉÉ@ A#
JoinPrivateMatchAsync
ÉÉA V
(
ÉÉV W

codeToJoin
ÉÉW a
)
ÉÉa b
;
ÉÉb c
if
ÖÖ 
(
ÖÖ 
result
ÖÖ 
.
ÖÖ 
Success
ÖÖ 
&&
ÖÖ !
result
ÖÖ" (
.
ÖÖ( )
Data
ÖÖ) -
!=
ÖÖ. 0
null
ÖÖ1 5
&&
ÖÖ6 8
result
ÖÖ9 ?
.
ÖÖ? @
Data
ÖÖ@ D
.
ÖÖD E
ContainsKey
ÖÖE P
(
ÖÖP Q
$str
ÖÖQ Z
)
ÖÖZ [
)
ÖÖ[ \
{
ÜÜ 
string
áá 
matchId
áá 
=
áá  
result
áá! '
.
áá' (
Data
áá( ,
[
áá, -
$str
áá- 6
]
áá6 7
;
áá7 8
var
ââ 
lobbyManager
ââ  
=
ââ! " 
LobbyClientManager
ââ# 5
.
ââ5 6
Instance
ââ6 >
;
ââ> ?
var
ää 
sessionManager
ää "
=
ää# $
SessionManager
ää% 3
.
ää3 4
Instance
ää4 <
;
ää< =
string
ãã 
currentUsername
ãã &
=
ãã' (
sessionManager
ãã) 7
.
ãã7 8
CurrentUsername
ãã8 G
;
ããG H
lobbyManager
åå 
.
åå 
Connect
åå $
(
åå$ %
currentUsername
åå% 4
,
åå4 5
matchId
åå6 =
)
åå= >
;
åå> ?
var
çç "
waitingRoomViewModel
çç (
=
çç) *
new
çç+ ..
 WaitingRoomPrivateMatchViewModel
çç/ O
(
ççO P
lobbyManager
ççP \
,
çç\ ]
sessionManager
çç^ l
)
ççl m
;
ççm n
var
éé 
waitingRoomView
éé #
=
éé$ %
new
éé& ))
WaitingRoomPrivateMatchView
éé* E
{
èè 
DataContext
êê 
=
êê  !"
waitingRoomViewModel
êê" 6
}
ëë 
;
ëë 
Window
ìì 
currentWindow
ìì $
=
ìì% &
FindParentWindow
ìì' 7
(
ìì7 8
	parameter
ìì8 A
)
ììA B
;
ììB C
if
îî 
(
îî 
currentWindow
îî !
!=
îî" $
null
îî% )
)
îî) *
{
ïï 
CleanupEvents
ññ !
(
ññ! "
)
ññ" #
;
ññ# $
waitingRoomView
óó #
.
óó# $
Show
óó$ (
(
óó( )
)
óó) *
;
óó* +
currentWindow
òò !
.
òò! "
Close
òò" '
(
òò' (
)
òò( )
;
òò) *
}
ôô 
else
öö 
{
õõ 

MessageBox
úú 
.
úú 
Show
úú #
(
úú# $
$"
úú$ &
$str
úú& :
{
úú: ;

codeToJoin
úú; E
}
úúE F
$str
úúF e
"
úúe f
,
úúf g
$str
úúh n
)
úún o
;
úúo p
lobbyManager
ùù  
.
ùù  !

Disconnect
ùù! +
(
ùù+ ,
)
ùù, -
;
ùù- .
}
ûû 
}
üü 
else
†† 
{
°° 

MessageBox
¢¢ 
.
¢¢ 
Show
¢¢ 
(
¢¢  
result
¢¢  &
.
¢¢& '
Message
¢¢' .
??
¢¢/ 1
$str
¢¢2 b
,
¢¢b c
$str
¢¢d k
)
¢¢k l
;
¢¢l m
}
££ 
	IsJoining
§§ 
=
§§ 
false
§§ 
;
§§ 
}
•• 	
private
ßß 
void
ßß 
ExecuteReturn
ßß "
(
ßß" #
object
ßß# )
	parameter
ßß* 3
)
ßß3 4
{
®® 	
CleanupEvents
©© 
(
©© 
)
©© 
;
©© 
if
™™ 
(
™™ 
	parameter
™™ 
is
™™ 
Window
™™ #
window
™™$ *
)
™™* +
{
´´ 
var
¨¨ 
	lobbyView
¨¨ 
=
¨¨ 
new
¨¨  #
View
¨¨$ (
.
¨¨( )
Lobby
¨¨) .
.
¨¨. /
	LobbyView
¨¨/ 8
(
¨¨8 9
)
¨¨9 :
;
¨¨: ;
	lobbyView
≠≠ 
.
≠≠ 
Show
≠≠ 
(
≠≠ 
)
≠≠  
;
≠≠  !
window
ÆÆ 
.
ÆÆ 
Close
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ØØ 
}
∞∞ 	
private
≤≤ 
void
≤≤ (
OnPublicMatchesListUpdated
≤≤ /
(
≤≤/ 0
List
≤≤0 4
<
≤≤4 5
MatchInfoDto
≤≤5 A
>
≤≤A B
publicMatches
≤≤C P
)
≤≤P Q
{
≥≥ 	
Application
¥¥ 
.
¥¥ 
Current
¥¥ 
?
¥¥  
.
¥¥  !

Dispatcher
¥¥! +
?
¥¥+ ,
.
¥¥, -
Invoke
¥¥- 3
(
¥¥3 4
(
¥¥4 5
)
¥¥5 6
=>
¥¥7 9
{
µµ 
PublicMatches
∂∂ 
.
∂∂ 
Clear
∂∂ #
(
∂∂# $
)
∂∂$ %
;
∂∂% &
if
∑∑ 
(
∑∑ 
publicMatches
∑∑ !
!=
∑∑" $
null
∑∑% )
)
∑∑) *
{
∏∏ 
foreach
ππ 
(
ππ 
var
ππ  
matchDto
ππ! )
in
ππ* ,
publicMatches
ππ- :
)
ππ: ;
{
∫∫ 
PublicMatches
ªª %
.
ªª% &
Add
ªª& )
(
ªª) *
new
ªª* -
MatchInfoModel
ªª. <
(
ªª< =
matchDto
ªª= E
)
ªªE F
)
ªªF G
;
ªªG H
}
ºº 
}
ΩΩ 
}
ææ 
)
ææ 
;
ææ 
}
øø 	
private
¡¡ 
void
¡¡ 
OnMatchJoined
¡¡ "
(
¡¡" #
string
¡¡# )
matchId
¡¡* 1
,
¡¡1 2 
OperationResultDto
¡¡3 E
result
¡¡F L
)
¡¡L M
{
¬¬ 	
if
√√ 
(
√√ 
matchId
√√ 
!=
√√ 
_joiningMatchId
√√ *
||
√√+ -"
_joiningPrivateMatch
√√. B
)
√√B C
{
ƒƒ 
return
≈≈ 
;
≈≈ 
}
∆∆ 
Application
»» 
.
»» 
Current
»» 
?
»»  
.
»»  !

Dispatcher
»»! +
?
»»+ ,
.
»», -
Invoke
»»- 3
(
»»3 4
(
»»4 5
)
»»5 6
=>
»»7 9
{
…… 
	IsJoining
   
=
   
false
   !
;
  ! "
if
ÃÃ 
(
ÃÃ 
result
ÃÃ 
.
ÃÃ 
Success
ÃÃ "
)
ÃÃ" #
{
ÕÕ 
var
ŒŒ 
lobbyManager
ŒŒ $
=
ŒŒ% & 
LobbyClientManager
ŒŒ' 9
.
ŒŒ9 :
Instance
ŒŒ: B
;
ŒŒB C
var
œœ 
sessionManager
œœ &
=
œœ' (
SessionManager
œœ) 7
.
œœ7 8
Instance
œœ8 @
;
œœ@ A
string
–– 
currentUsername
–– *
=
––+ ,
sessionManager
––- ;
.
––; <
CurrentUsername
––< K
;
––K L
lobbyManager
——  
.
——  !
Connect
——! (
(
——( )
currentUsername
——) 8
,
——8 9
matchId
——: A
)
——A B
;
——B C
var
““ "
waitingRoomViewModel
““ ,
=
““- .
new
““/ 2-
WaitingRoomPublicMatchViewModel
““3 R
(
““R S
lobbyManager
““S _
,
““_ `
sessionManager
““a o
)
““o p
;
““p q
var
”” 
waitingRoomView
”” '
=
””( )
new
””* -(
WaitingRoomPublicMatchView
””. H
{
‘‘ 
DataContext
’’ #
=
’’$ %"
waitingRoomViewModel
’’& :
}
÷÷ 
;
÷÷ 
if
ÿÿ 
(
ÿÿ 
_currentWindow
ÿÿ &
!=
ÿÿ' )
null
ÿÿ* .
)
ÿÿ. /
{
ŸŸ 
CleanupEvents
⁄⁄ %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
waitingRoomView
€€ '
.
€€' (
Show
€€( ,
(
€€, -
)
€€- .
;
€€. /
_currentWindow
‹‹ &
.
‹‹& '
Close
‹‹' ,
(
‹‹, -
)
‹‹- .
;
‹‹. /
}
›› 
else
ﬁﬁ 
{
ﬂﬂ 

MessageBox
‡‡ "
.
‡‡" #
Show
‡‡# '
(
‡‡' (
$"
‡‡( *
$str
‡‡* >
{
‡‡> ?
matchId
‡‡? F
}
‡‡F G
$str
‡‡G f
"
‡‡f g
,
‡‡g h
$str
‡‡i o
)
‡‡o p
;
‡‡p q
lobbyManager
·· $
.
··$ %

Disconnect
··% /
(
··/ 0
)
··0 1
;
··1 2
}
‚‚ 
}
„„ 
else
‰‰ 
{
ÂÂ 

MessageBox
ÊÊ 
.
ÊÊ 
Show
ÊÊ #
(
ÊÊ# $
$"
ÊÊ$ &
$str
ÊÊ& C
{
ÊÊC D
matchId
ÊÊD K
}
ÊÊK L
$str
ÊÊL N
{
ÊÊN O
result
ÊÊO U
.
ÊÊU V
Message
ÊÊV ]
}
ÊÊ] ^
"
ÊÊ^ _
,
ÊÊ_ `
$str
ÊÊa h
)
ÊÊh i
;
ÊÊi j
}
ÁÁ 
_joiningMatchId
ÈÈ 
=
ÈÈ  !
null
ÈÈ" &
;
ÈÈ& '"
_joiningPrivateMatch
ÍÍ $
=
ÍÍ% &
false
ÍÍ' ,
;
ÍÍ, -
_currentWindow
ÎÎ 
=
ÎÎ  
null
ÎÎ! %
;
ÎÎ% &
}
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÌÌ 	
private
ÔÔ 
void
ÔÔ 
CleanupEvents
ÔÔ "
(
ÔÔ" #
)
ÔÔ# $
{
 	&
MatchmakingClientManager
ÒÒ $
.
ÒÒ$ %
Instance
ÒÒ% -
.
ÒÒ- .(
OnPublicMatchesListUpdated
ÒÒ. H
-=
ÒÒI K(
OnPublicMatchesListUpdated
ÒÒL f
;
ÒÒf g&
MatchmakingClientManager
ÚÚ $
.
ÚÚ$ %
Instance
ÚÚ% -
.
ÚÚ- .'
OnMatchJoinedSuccessfully
ÚÚ. G
-=
ÚÚH J
OnMatchJoined
ÚÚK X
;
ÚÚX Y&
MatchmakingClientManager
ÛÛ $
.
ÛÛ$ %
Instance
ÛÛ% -
.
ÛÛ- .!
OnMatchmakingFailed
ÛÛ. A
-=
ÛÛB D!
OnMatchmakingFailed
ÛÛE X
;
ÛÛX Y
}
ÙÙ 	
private
ˆˆ 
Window
ˆˆ 
FindParentWindow
ˆˆ '
(
ˆˆ' (
object
ˆˆ( .
commandParameter
ˆˆ/ ?
=
ˆˆ@ A
null
ˆˆB F
)
ˆˆF G
{
˜˜ 	
if
¯¯ 
(
¯¯ 
commandParameter
¯¯  
is
¯¯! #
Window
¯¯$ *
win
¯¯+ .
)
¯¯. /
return
¯¯0 6
win
¯¯7 :
;
¯¯: ;
return
˘˘ 
Application
˘˘ 
.
˘˘ 
Current
˘˘ &
?
˘˘& '
.
˘˘' (
Windows
˘˘( /
.
˘˘/ 0
OfType
˘˘0 6
<
˘˘6 7
Window
˘˘7 =
>
˘˘= >
(
˘˘> ?
)
˘˘? @
.
˘˘@ A
SingleOrDefault
˘˘A P
(
˘˘P Q
w
˘˘Q R
=>
˘˘S U
w
˘˘V W
.
˘˘W X
DataContext
˘˘X c
==
˘˘d f
this
˘˘g k
||
˘˘l n
w
˘˘o p
.
˘˘p q
IsActive
˘˘q y
)
˘˘y z
;
˘˘z {
}
˙˙ 	
private
¸¸ 
void
¸¸ !
OnMatchmakingFailed
¸¸ (
(
¸¸( )
string
¸¸) /
reason
¸¸0 6
)
¸¸6 7
{
˝˝ 	
Application
˛˛ 
.
˛˛ 
Current
˛˛ 
?
˛˛  
.
˛˛  !

Dispatcher
˛˛! +
?
˛˛+ ,
.
˛˛, -
Invoke
˛˛- 3
(
˛˛3 4
(
˛˛4 5
)
˛˛5 6
=>
˛˛7 9
{
ˇˇ 

MessageBox
ÄÄ 
.
ÄÄ 
Show
ÄÄ 
(
ÄÄ  
$"
ÄÄ  "
$str
ÄÄ" 8
{
ÄÄ8 9
reason
ÄÄ9 ?
}
ÄÄ? @
"
ÄÄ@ A
)
ÄÄA B
;
ÄÄB C
	IsJoining
ÅÅ 
=
ÅÅ 
false
ÅÅ !
;
ÅÅ! "
}
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
public
ÜÜ 

class
ÜÜ 
MatchInfoModel
ÜÜ 
:
ÜÜ  !
ViewModelBase
ÜÜ" /
{
áá 
public
àà 
string
àà 
MatchId
àà 
{
àà 
get
àà  #
;
àà# $
set
àà% (
;
àà( )
}
àà* +
public
ââ 
string
ââ 
	MatchName
ââ 
{
ââ  !
get
ââ" %
;
ââ% &
set
ââ' *
;
ââ* +
}
ââ, -
public
ää 
string
ää 
HostUsername
ää "
{
ää# $
get
ää% (
;
ää( )
set
ää* -
;
ää- .
}
ää/ 0
public
ãã 
int
ãã 
CurrentPlayers
ãã !
{
ãã" #
get
ãã$ '
;
ãã' (
set
ãã) ,
;
ãã, -
}
ãã. /
public
åå 
int
åå 

MaxPlayers
åå 
{
åå 
get
åå  #
;
åå# $
set
åå% (
;
åå( )
}
åå* +
public
çç 
string
çç 
DifficultyName
çç $
{
çç% &
get
çç' *
;
çç* +
set
çç, /
;
çç/ 0
}
çç1 2
public
éé 
bool
éé 
CanJoin
éé 
=>
éé 
CurrentPlayers
éé -
<
éé. /

MaxPlayers
éé0 :
;
éé: ;
public
êê 
MatchInfoModel
êê 
(
êê 
MatchInfoDto
êê *
dto
êê+ .
)
êê. /
{
ëë 	
MatchId
íí 
=
íí 
dto
íí 
.
íí 
MatchId
íí !
;
íí! "
	MatchName
ìì 
=
ìì 
dto
ìì 
.
ìì 
	MatchName
ìì %
;
ìì% &
HostUsername
îî 
=
îî 
dto
îî 
.
îî 
HostUsername
îî +
;
îî+ ,
CurrentPlayers
ïï 
=
ïï 
dto
ïï  
.
ïï  !
CurrentPlayers
ïï! /
;
ïï/ 0

MaxPlayers
ññ 
=
ññ 
dto
ññ 
.
ññ 

MaxPlayers
ññ '
;
ññ' (
DifficultyName
óó 
=
óó 
dto
óó  
.
óó  !
DifficultyName
óó! /
;
óó/ 0
}
òò 	
}
ôô 
}öö ¶$
úC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\HomePages\MainViewModel.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
	HomePages

& /
{ 
public 

class 
MainViewModel 
:  
ViewModelBase! .
{ 
public 
ICommand 
StartGameCommand (
{) *
get+ .
;. /
}0 1
public 
ICommand 
CloseWindowCommand *
{+ ,
get- 0
;0 1
}2 3
public 
ICommand !
MaximizeWindowCommand -
{. /
get0 3
;3 4
}5 6
public 
ICommand !
MinimizeWindowCommand -
{. /
get0 3
;3 4
}5 6
public 
MainViewModel 
( 
) 
{ 	
StartGameCommand 
= 
new "
RelayCommand# /
(/ 0
	StartGame0 9
)9 :
;: ;
CloseWindowCommand 
=  
new! $
RelayCommand% 1
(1 2
ExecuteCloseWindow2 D
)D E
;E F!
MaximizeWindowCommand !
=" #
new$ '
RelayCommand( 4
(4 5!
ExecuteMaximizeWindow5 J
)J K
;K L!
MinimizeWindowCommand !
=" #
new$ '
RelayCommand( 4
(4 5!
ExecuteMinimizeWindow5 J
)J K
;K L
} 	
private 
static 
void 
	StartGame %
(% &
object& ,
	parameter- 6
)6 7
{ 	
var 
welcomeView 
= 
new !
WelcomeView" -
(- .
). /
;/ 0
welcomeView 
. 
WindowState #
=$ %
WindowState& 1
.1 2
	Maximized2 ;
;; <
welcomeView 
. 
WindowStyle #
=$ %
WindowStyle& 1
.1 2
None2 6
;6 7
welcomeView   
.   

ResizeMode   "
=  # $

ResizeMode  % /
.  / 0
NoResize  0 8
;  8 9
welcomeView!! 
.!! 
Show!! 
(!! 
)!! 
;!! 
if## 
(## 
	parameter## 
is## 
Window## #

mainWindow##$ .
)##. /
{$$ 

mainWindow%% 
.%% 
Close%%  
(%%  !
)%%! "
;%%" #
}&& 
}'' 	
private)) 
static)) 
void)) 
ExecuteCloseWindow)) .
()). /
object))/ 5
	parameter))6 ?
)))? @
{** 	
if++ 
(++ 
	parameter++ 
is++ 
Window++ #
)++# $
{,, 
Application-- 
.-- 
Current-- #
.--# $
Shutdown--$ ,
(--, -
)--- .
;--. /
}.. 
}// 	
private11 
static11 
void11 !
ExecuteMaximizeWindow11 1
(111 2
object112 8
	parameter119 B
)11B C
{22 	
if33 
(33 
	parameter33 
is33 
Window33 #
window33$ *
)33* +
{44 
window55 
.55 
WindowState55 "
=55# $
window55% +
.55+ ,
WindowState55, 7
==558 :
WindowState55; F
.55F G
	Maximized55G P
?55Q R
WindowState55S ^
.55^ _
Normal55_ e
:55f g
WindowState55h s
.55s t
	Maximized55t }
;55} ~
}66 
}77 	
private99 
static99 
void99 !
ExecuteMinimizeWindow99 1
(991 2
object992 8
	parameter999 B
)99B C
{:: 	
if;; 
(;; 
	parameter;; 
is;; 
Window;; #
window;;$ *
);;* +
{<< 
window== 
.== 
WindowState== "
===# $
WindowState==% 0
.==0 1
	Minimized==1 :
;==: ;
}>> 
}?? 	
}@@ 
}AA üc
™C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\Dialogs\ChangePasswordViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
.+ ,
Dialogs, 3
{ 
internal 
class #
ChangePasswordViewModel *
:+ ,
ViewModelBase- :
{ 
private 
readonly 
string 
	_username  )
;) *
public 
ICommand 
ConfirmCommand &
{' (
get) ,
;, -
}. /
public 
ICommand 
CloseCommand $
{% &
get' *
;* +
}, -
public #
ChangePasswordViewModel &
(& '
string' -
username. 6
)6 7
{ 	
	_username 
= 
username  
;  !
ConfirmCommand 
= 
new  
RelayCommand! -
(- .
ExecuteConfirm. <
)< =
;= >
CloseCommand 
= 
new 
RelayCommand +
(+ ,
ExecuteClose, 8
)8 9
;9 :
} 	
private 
static 
bool 
IsPasswordSecure ,
(, -
string- 3
password4 <
,< =
out> A
stringB H
errorLangKeyI U
)U V
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
password* 2
)2 3
)3 4
{   
errorLangKey!! 
=!! 
$str!! 3
;!!3 4
return"" 
false"" 
;"" 
}## 
if$$ 
($$ 
password$$ 
.$$ 
Length$$ 
<$$  !
$num$$" #
)$$# $
{%% 
errorLangKey&& 
=&& 
$str&& 6
;&&6 7
return'' 
false'' 
;'' 
}(( 
if)) 
()) 
!)) 
password)) 
.)) 
Any)) 
()) 
char)) "
.))" #
IsUpper))# *
)))* +
)))+ ,
{** 
errorLangKey++ 
=++ 
$str++ 8
;++8 9
return,, 
false,, 
;,, 
}-- 
if.. 
(.. 
!.. 
password.. 
... 
Any.. 
(.. 
char.. "
..." #
IsLower..# *
)..* +
)..+ ,
{// 
errorLangKey00 
=00 
$str00 8
;008 9
return11 
false11 
;11 
}22 
if33 
(33 
!33 
password33 
.33 
Any33 
(33 
char33 "
.33" #
IsDigit33# *
)33* +
)33+ ,
{44 
errorLangKey55 
=55 
$str55 8
;558 9
return66 
false66 
;66 
}77 
if88 
(88 
password88 
.88 
All88 
(88 
char88 !
.88! "
IsLetterOrDigit88" 1
)881 2
)882 3
{99 
errorLangKey:: 
=:: 
$str:: :
;::: ;
return;; 
false;; 
;;; 
}<< 
errorLangKey>> 
=>> 
null>> 
;>>  
return?? 
true?? 
;?? 
}@@ 	
privateBB 
asyncBB 
voidBB 
ExecuteConfirmBB )
(BB) *
objectBB* 0
	parameterBB1 :
)BB: ;
{CC 	
ifDD 
(DD 
!DD 
(DD 
	parameterDD 
isDD 
WindowDD %
windowDD& ,
)DD, -
)DD- .
{EE 
returnFF 
;FF 
}GG 
varII 
newPasswordBoxII 
=II  
windowII! '
.II' (
FindNameII( 0
(II0 1
$strII1 A
)IIA B
asIIC E
PasswordBoxIIF Q
;IIQ R
varJJ 
confirmPasswordBoxJJ "
=JJ# $
windowJJ% +
.JJ+ ,
FindNameJJ, 4
(JJ4 5
$strJJ5 I
)JJI J
asJJK M
PasswordBoxJJN Y
;JJY Z
ifLL 
(LL 
newPasswordBoxLL 
==LL !
nullLL" &
||LL' )
confirmPasswordBoxLL* <
==LL= ?
nullLL@ D
)LLD E
{MM 

MessageBoxNN 
.NN 
ShowNN 
(NN  
LangOO 
.OO )
alertPasswordControlsNotFoundOO 6
,OO6 7
LangPP 
.PP 
alertErrorTitlePP (
,PP( )
MessageBoxButtonQQ $
.QQ$ %
OKQQ% '
,QQ' (
MessageBoxImageRR #
.RR# $
ErrorRR$ )
)RR) *
;RR* +
returnSS 
;SS 
}TT 
stringVV 
newPasswordVV 
=VV  
newPasswordBoxVV! /
.VV/ 0
PasswordVV0 8
;VV8 9
stringWW 
confirmPasswordWW "
=WW# $
confirmPasswordBoxWW% 7
.WW7 8
PasswordWW8 @
;WW@ A
ifYY 
(YY 
!YY 
IsPasswordSecureYY !
(YY! "
newPasswordYY" -
,YY- .
outYY/ 2
stringYY3 9
passwordErrorKeyYY: J
)YYJ K
)YYK L
{ZZ 
string[[  
passwordErrorMessage[[ +
=[[, -
Lang[[. 2
.[[2 3
ResourceManager[[3 B
.[[B C
	GetString[[C L
([[L M
passwordErrorKey[[M ]
)[[] ^
??[[_ a
Lang[[b f
.[[f g&
alertPasswordGenericError	[[g Ä
;
[[Ä Å

MessageBox\\ 
.\\ 
Show\\ 
(\\   
passwordErrorMessage]] (
,]]( )
Lang^^ 
.^^ '
alertPasswordNotSecureTitle^^ 4
,^^4 5
MessageBoxButton__ $
.__$ %
OK__% '
,__' (
MessageBoxImage`` #
.``# $
Warning``$ +
)``+ ,
;``, -
returnaa 
;aa 
}bb 
ifdd 
(dd 
newPassworddd 
!=dd 
confirmPassworddd .
)dd. /
{ee 

MessageBoxff 
.ff 
Showff 
(ff  
Langgg 
.gg $
alertPasswordsDoNotMatchgg 1
,gg1 2
Langhh 
.hh  
alertInputErrorTitlehh -
,hh- .
MessageBoxButtonii $
.ii$ %
OKii% '
,ii' (
MessageBoxImagejj #
.jj# $
Warningjj$ +
)jj+ ,
;jj, -
returnkk 
;kk 
}ll 
trynn 
{oo 
usingpp 
(pp 
varpp 
clientpp !
=pp" #
newpp$ '$
UserProfileServiceClientpp( @
(pp@ A
)ppA B
)ppB C
{qq 
varrr 
resultrr 
=rr  
awaitrr! &
clientrr' -
.rr- .&
RequestChangePasswordAsyncrr. H
(rrH I
	_usernamerrI R
)rrR S
;rrS T
ifss 
(ss 
resultss 
.ss 
Successss &
)ss& '
{tt 

MessageBoxuu "
.uu" #
Showuu# '
(uu' (
resultvv "
.vv" #
Messagevv# *
,vv* +
Langww  
.ww  !
alertCodeSentTitleww! 3
,ww3 4
MessageBoxButtonxx ,
.xx, -
OKxx- /
,xx/ 0
MessageBoxImageyy +
.yy+ ,
Informationyy, 7
)yy7 8
;yy8 9
var{{ 
verifyVM{{ $
={{% &
new{{' *(
VerifyChangesByCodeViewModel{{+ G
({{G H(
VerifyChangesByCodeViewModel|| 8
.||8 9
VerificationMode||9 I
.||I J
Password||J R
,||R S
	_username}} %
,}}% &
newPassword~~ '
,~~' (
null  
)  !
;! "
var
ÄÄ 

verifyView
ÄÄ &
=
ÄÄ' (
new
ÄÄ) ,%
VerifyChangesByCodeView
ÄÄ- D
{
ÄÄE F
DataContext
ÄÄG R
=
ÄÄS T
verifyVM
ÄÄU ]
}
ÄÄ^ _
;
ÄÄ_ `
ExecuteClose
ÇÇ $
(
ÇÇ$ %
	parameter
ÇÇ% .
)
ÇÇ. /
;
ÇÇ/ 0

verifyView
ÉÉ "
.
ÉÉ" #

ShowDialog
ÉÉ# -
(
ÉÉ- .
)
ÉÉ. /
;
ÉÉ/ 0
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 

MessageBox
áá "
.
áá" #
Show
áá# '
(
áá' (
result
àà "
.
àà" #
Message
àà# *
,
àà* +
Lang
ââ  
.
ââ  !
alertErrorTitle
ââ! 0
,
ââ0 1
MessageBoxButton
ää ,
.
ää, -
OK
ää- /
,
ää/ 0
MessageBoxImage
ãã +
.
ãã+ ,
Warning
ãã, 3
)
ãã3 4
;
ãã4 5
}
åå 
}
çç 
}
éé 
catch
èè 
(
èè 
FaultException
èè !

fexGeneral
èè" ,
)
èè, -
{
êê 

MessageBox
ëë 
.
ëë 
Show
ëë 
(
ëë  
Lang
íí 
.
íí %
alertServerErrorMessage
íí 0
,
íí0 1
Lang
ìì 
.
ìì 
alertErrorTitle
ìì (
,
ìì( )
MessageBoxButton
îî $
.
îî$ %
OK
îî% '
,
îî' (
MessageBoxImage
ïï #
.
ïï# $
Error
ïï$ )
)
ïï) *
;
ïï* +
Console
ññ 
.
ññ 
	WriteLine
ññ !
(
ññ! "
$"
ññ" $
$str
ññ$ O
{
ññO P

fexGeneral
ññP Z
.
ññZ [
Message
ññ[ b
}
ññb c
"
ññc d
)
ññd e
;
ññe f
}
óó 
catch
òò 
(
òò '
EndpointNotFoundException
òò ,
ex
òò- /
)
òò/ 0
{
ôô 

MessageBox
öö 
.
öö 
Show
öö 
(
öö  
Lang
õõ 
.
õõ )
alertConnectionErrorMessage
õõ 4
,
õõ4 5
Lang
úú 
.
úú '
alertConnectionErrorTitle
úú 2
,
úú2 3
MessageBoxButton
ùù $
.
ùù$ %
OK
ùù% '
,
ùù' (
MessageBoxImage
ûû #
.
ûû# $
Error
ûû$ )
)
ûû) *
;
ûû* +
Console
üü 
.
üü 
	WriteLine
üü !
(
üü! "
$"
üü" $
$str
üü$ V
{
üüV W
ex
üüW Y
.
üüY Z
Message
üüZ a
}
üüa b
"
üüb c
)
üüc d
;
üüd e
}
†† 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
¢¢ 

MessageBox
££ 
.
££ 
Show
££ 
(
££  
Lang
§§ 
.
§§ &
alertUnknownErrorMessage
§§ 1
,
§§1 2
Lang
•• 
.
•• 
alertErrorTitle
•• (
,
••( )
MessageBoxButton
¶¶ $
.
¶¶$ %
OK
¶¶% '
,
¶¶' (
MessageBoxImage
ßß #
.
ßß# $
Error
ßß$ )
)
ßß) *
;
ßß* +
Console
®® 
.
®® 
	WriteLine
®® !
(
®®! "
$"
®®" $
$str
®®$ S
{
®®S T
ex
®®T V
.
®®V W
Message
®®W ^
}
®®^ _
"
®®_ `
)
®®` a
;
®®a b
}
©© 
}
™™ 	
private
¨¨ 
static
¨¨ 
void
¨¨ 
ExecuteClose
¨¨ (
(
¨¨( )
object
¨¨) /
	parameter
¨¨0 9
)
¨¨9 :
{
≠≠ 	
if
ÆÆ 
(
ÆÆ 
	parameter
ÆÆ 
is
ÆÆ 
Window
ÆÆ #
window
ÆÆ$ *
)
ÆÆ* +
{
ØØ 
window
∞∞ 
.
∞∞ 
Close
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
}
±± 
}
≤≤ 	
}
≥≥ 
}¥¥ ˆ|
õC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\ProfileViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
{ 
public 

class 
ProfileViewModel !
:" #
ViewModelBase$ 1
{ 
private 
readonly 
UserProfileDto '
_profileData( 4
;4 5
public 
string 
	FirstName 
{ 	
get 
{ 
return 
_profileData #
.# $
	FirstName$ -
;- .
} 
set 
{ 
if 
( 
_profileData  
.  !
	FirstName! *
!=+ -
value. 3
)3 4
{ 
_profileData  
.  !
	FirstName! *
=+ ,
value- 2
;2 3
OnPropertyChanged %
(% &
)& '
;' (
}   
}!! 
}"" 	
public## 
string## 
LastName## 
{$$ 	
get%% 
{&& 
return'' 
_profileData'' #
.''# $
LastName''$ ,
;'', -
}(( 
set)) 
{** 
if++ 
(++ 
_profileData++  
.++  !
LastName++! )
!=++* ,
value++- 2
)++2 3
{,, 
_profileData--  
.--  !
LastName--! )
=--* +
value--, 1
;--1 2
OnPropertyChanged.. %
(..% &
)..& '
;..' (
}// 
}00 
}11 	
public33 
string33 
Username33 
=>33 !
_profileData33" .
?33. /
.33/ 0
Username330 8
;338 9
public55 
string55 
Email55 
{66 	
get77 
{88 
return99 
_profileData99 #
?99# $
.99$ %
Email99% *
;99* +
}:: 
set;; 
{<< 
if== 
(== 
_profileData==  
!===! #
null==$ (
&&==) +
_profileData==, 8
.==8 9
Email==9 >
!===? A
value==B G
)==G H
{>> 
_profileData??  
.??  !
Email??! &
=??' (
value??) .
;??. /
OnPropertyChanged@@ %
(@@% &
)@@& '
;@@' (
}AA 
}BB 
}CC 	
publicEE 
boolEE 
IsMaleEE 
=>EE 
_profileDataEE *
?EE* +
.EE+ ,
GenderIdEE, 4
==EE5 7
$numEE8 9
;EE9 :
publicFF 
boolFF 
IsFemaleFF 
=>FF 
_profileDataFF  ,
?FF, -
.FF- .
GenderIdFF. 6
==FF7 9
$numFF: ;
;FF; <
publicGG 
boolGG 
IsNonBinaryGG 
=>GG  "
_profileDataGG# /
?GG/ 0
.GG0 1
GenderIdGG1 9
==GG: <
$numGG= >
;GG> ?
publicII 
ICommandII 
ChangeEmailCommandII *
{II+ ,
getII- 0
;II0 1
}II2 3
publicJJ 
ICommandJJ !
ChangePasswordCommandJJ -
{JJ. /
getJJ0 3
;JJ3 4
}JJ5 6
publicKK 
ICommandKK 
SaveProfileCommandKK *
{KK+ ,
getKK- 0
;KK0 1
}KK2 3
publicMM 
ProfileViewModelMM 
(MM  
UserProfileDtoMM  .
initialProfileDataMM/ A
)MMA B
{NN 	
_profileDataOO 
=OO 
initialProfileDataOO -
??OO. 0
throwOO1 6
newOO7 :!
ArgumentNullExceptionOO; P
(OOP Q
nameofOOQ W
(OOW X
initialProfileDataOOX j
)OOj k
,OOk l
$str	OOm ì
)
OOì î
;
OOî ï
ChangeEmailCommandQQ 
=QQ  
newQQ! $
RelayCommandQQ% 1
(QQ1 2
ExecuteChangeEmailQQ2 D
)QQD E
;QQE F!
ChangePasswordCommandRR !
=RR" #
newRR$ '
RelayCommandRR( 4
(RR4 5!
ExecuteChangePasswordRR5 J
)RRJ K
;RRK L
SaveProfileCommandSS 
=SS  
newSS! $
RelayCommandSS% 1
(SS1 2
ExecuteSaveProfileSS2 D
)SSD E
;SSE F
}TT 	
privateVV 
asyncVV 
voidVV 
ExecuteSaveProfileVV -
(VV- .
objectVV. 4
	parameterVV5 >
)VV> ?
{WW 	
ifXX 
(XX 
stringXX 
.XX 
IsNullOrWhiteSpaceXX )
(XX) *
	FirstNameXX* 3
)XX3 4
||XX5 7
stringXX8 >
.XX> ?
IsNullOrWhiteSpaceXX? Q
(XXQ R
LastNameXXR Z
)XXZ [
)XX[ \
{YY 

MessageBoxZZ 
.ZZ 
ShowZZ 
(ZZ  
Lang[[ 
.[[ '
alertProfileMandatoryFields[[ 4
,[[4 5
Lang\\ 
.\\  
alertInputErrorTitle\\ -
,\\- .
MessageBoxButton]] $
.]]$ %
OK]]% '
,]]' (
MessageBoxImage]]) 8
.]]8 9
Warning]]9 @
)]]@ A
;]]A B
return^^ 
;^^ 
}__ 
usingaa 
(aa 
varaa 
clientaa 
=aa 
newaa  #$
UserProfileServiceClientaa$ <
(aa< =
)aa= >
)aa> ?
{bb 
trycc 
{dd 
OperationResultDtoee &
resultee' -
=ee. /
awaitee0 5
clientee6 <
.ee< =
UpdateProfileAsyncee= O
(eeO P
_profileDataeeP \
.ee\ ]
Usernameee] e
,eee f
_profileDataeeg s
)ees t
;eet u
ifgg 
(gg 
resultgg 
.gg 
Successgg &
)gg& '
{hh 

MessageBoxii "
.ii" #
Showii# '
(ii' (
Langjj  
.jj  !%
alertProfileUpdateSuccessjj! :
,jj: ;
Langkk  
.kk  !
alertSuccessTitlekk! 2
,kk2 3
MessageBoxButtonll ,
.ll, -
OKll- /
,ll/ 0
MessageBoxImagemm +
.mm+ ,
Informationmm, 7
)mm7 8
;mm8 9
}nn 
elseoo 
{pp 

MessageBoxqq "
.qq" #
Showqq# '
(qq' (
resultrr "
.rr" #
Messagerr# *
,rr* +
Langss  
.ss  !(
alertProfileUpdateErrorTitless! =
,ss= >
MessageBoxButtontt ,
.tt, -
OKtt- /
,tt/ 0
MessageBoxImageuu +
.uu+ ,
Warninguu, 3
)uu3 4
;uu4 5
}vv 
}ww 
catchxx 
(xx 
FaultExceptionxx %

fexGeneralxx& 0
)xx0 1
{yy 

MessageBoxzz 
.zz 
Showzz #
(zz# $
Lang{{ 
.{{ #
alertServerErrorMessage{{ 4
,{{4 5
Lang|| 
.|| (
alertProfileUpdateErrorTitle|| 9
,||9 :
MessageBoxButton}} (
.}}( )
OK}}) +
,}}+ ,
MessageBoxImage~~ '
.~~' (
Error~~( -
)~~- .
;~~. /
Console 
. 
	WriteLine %
(% &
$"& (
$str( B
{B C

fexGeneralC M
.M N
MessageN U
}U V
"V W
)W X
;X Y
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ '
EndpointNotFoundException
ÅÅ 0
ex
ÅÅ1 3
)
ÅÅ3 4
{
ÇÇ 

MessageBox
ÉÉ 
.
ÉÉ 
Show
ÉÉ #
(
ÉÉ# $
Lang
ÑÑ 
.
ÑÑ )
alertConnectionErrorMessage
ÑÑ 8
,
ÑÑ8 9
Lang
ÖÖ 
.
ÖÖ *
alertProfileUpdateErrorTitle
ÖÖ 9
,
ÖÖ9 :
MessageBoxButton
ÜÜ (
.
ÜÜ( )
OK
ÜÜ) +
,
ÜÜ+ ,
MessageBoxImage
áá '
.
áá' (
Error
áá( -
)
áá- .
;
áá. /
Console
àà 
.
àà 
	WriteLine
àà %
(
àà% &
$"
àà& (
$str
àà( I
{
ààI J
ex
ààJ L
.
ààL M
Message
ààM T
}
ààT U
"
ààU V
)
ààV W
;
ààW X
}
ââ 
catch
ää 
(
ää 
	Exception
ää  
ex
ää! #
)
ää# $
{
ãã 

MessageBox
åå 
.
åå 
Show
åå #
(
åå# $
Lang
çç 
.
çç ,
alertProfileUpdateUnknownError
çç ;
,
çç; <
Lang
éé 
.
éé *
alertProfileUpdateErrorTitle
éé 9
,
éé9 :
MessageBoxButton
èè (
.
èè( )
OK
èè) +
,
èè+ ,
MessageBoxImage
êê '
.
êê' (
Error
êê( -
)
êê- .
;
êê. /
Console
ëë 
.
ëë 
	WriteLine
ëë %
(
ëë% &
$"
ëë& (
$str
ëë( Q
{
ëëQ R
ex
ëëR T
.
ëëT U
Message
ëëU \
}
ëë\ ]
"
ëë] ^
)
ëë^ _
;
ëë_ `
}
íí 
}
ìì 
}
îî 	
private
ññ 
void
ññ  
ExecuteChangeEmail
ññ '
(
ññ' (
object
ññ( .
	parameter
ññ/ 8
)
ññ8 9
{
óó 	
var
òò 
changeEmailVM
òò 
=
òò 
new
òò  #"
ChangeEmailViewModel
òò$ 8
(
òò8 9
_profileData
òò9 E
.
òòE F
Username
òòF N
,
òòN O
(
òòP Q
newEmail
òòQ Y
)
òòY Z
=>
òò[ ]
{
ôô 
Email
öö 
=
öö 
newEmail
öö  
;
öö  !
}
õõ 
)
õõ 
;
õõ 
var
ùù 
changeEmailView
ùù 
=
ùù  !
new
ùù" %
ChangeEmailView
ùù& 5
{
ûû 
DataContext
üü 
=
üü 
changeEmailVM
üü +
}
†† 
;
†† 
changeEmailView
°° 
.
°° 

ShowDialog
°° &
(
°°& '
)
°°' (
;
°°( )
}
¢¢ 	
private
§§ 
async
§§ 
void
§§ #
ExecuteChangePassword
§§ 0
(
§§0 1
object
§§1 7
	parameter
§§8 A
)
§§A B
{
•• 	

MessageBox
¶¶ 
.
¶¶ 
Show
¶¶ 
(
¶¶ 
Lang
ßß 
.
ßß )
alertPasswordChangeCodeInfo
ßß 0
,
ßß0 1
Lang
®® 
.
®® &
alertPasswordChangeTitle
®® -
,
®®- .
MessageBoxButton
©©  
.
©©  !
OK
©©! #
,
©©# $
MessageBoxImage
™™ 
.
™™  
Information
™™  +
)
™™+ ,
;
™™, -
try
¨¨ 
{
≠≠ 
using
ÆÆ 
(
ÆÆ 
var
ÆÆ 
client
ÆÆ !
=
ÆÆ" #
new
ÆÆ$ '&
UserProfileServiceClient
ÆÆ( @
(
ÆÆ@ A
)
ÆÆA B
)
ÆÆB C
{
ØØ 
var
∞∞ 
result
∞∞ 
=
∞∞  
await
∞∞! &
client
∞∞' -
.
∞∞- .(
RequestChangePasswordAsync
∞∞. H
(
∞∞H I
_profileData
∞∞I U
.
∞∞U V
Username
∞∞V ^
)
∞∞^ _
;
∞∞_ `
if
≤≤ 
(
≤≤ 
result
≤≤ 
.
≤≤ 
Success
≤≤ &
)
≤≤& '
{
≥≥ 
var
¥¥ 
changePasswordVM
¥¥ ,
=
¥¥- .
new
¥¥/ 2%
ChangePasswordViewModel
¥¥3 J
(
¥¥J K
_profileData
¥¥K W
.
¥¥W X
Username
¥¥X `
)
¥¥` a
;
¥¥a b
var
µµ  
changePasswordView
µµ .
=
µµ/ 0
new
µµ1 4 
ChangePasswordView
µµ5 G
{
∂∂ 
DataContext
∑∑ '
=
∑∑( )
changePasswordVM
∑∑* :
}
∏∏ 
;
∏∏  
changePasswordView
ππ *
.
ππ* +

ShowDialog
ππ+ 5
(
ππ5 6
)
ππ6 7
;
ππ7 8
}
∫∫ 
else
ªª 
{
ºº 

MessageBox
ΩΩ "
.
ΩΩ" #
Show
ΩΩ# '
(
ΩΩ' (
result
ææ "
.
ææ" #
Message
ææ# *
,
ææ* +
Lang
øø  
.
øø  !,
alertPasswordRequestErrorTitle
øø! ?
,
øø? @
MessageBoxButton
¿¿ ,
.
¿¿, -
OK
¿¿- /
,
¿¿/ 0
MessageBoxImage
¡¡ +
.
¡¡+ ,
Warning
¡¡, 3
)
¡¡3 4
;
¡¡4 5
}
¬¬ 
}
√√ 
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
FaultException
≈≈ !

fexGeneral
≈≈" ,
)
≈≈, -
{
∆∆ 

MessageBox
«« 
.
«« 
Show
«« 
(
««  
Lang
»» 
.
»» %
alertServerErrorMessage
»» 0
,
»»0 1
Lang
…… 
.
…… ,
alertPasswordRequestErrorTitle
…… 7
,
……7 8
MessageBoxButton
   $
.
  $ %
OK
  % '
,
  ' (
MessageBoxImage
ÀÀ #
.
ÀÀ# $
Error
ÀÀ$ )
)
ÀÀ) *
;
ÀÀ* +
Console
ÃÃ 
.
ÃÃ 
	WriteLine
ÃÃ !
(
ÃÃ! "
$"
ÃÃ" $
$str
ÃÃ$ J
{
ÃÃJ K

fexGeneral
ÃÃK U
.
ÃÃU V
Message
ÃÃV ]
}
ÃÃ] ^
"
ÃÃ^ _
)
ÃÃ_ `
;
ÃÃ` a
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ '
EndpointNotFoundException
ŒŒ ,
ex
ŒŒ- /
)
ŒŒ/ 0
{
œœ 

MessageBox
–– 
.
–– 
Show
–– 
(
––  
Lang
—— 
.
—— )
alertConnectionErrorMessage
—— 4
,
——4 5
Lang
““ 
.
““ ,
alertPasswordRequestErrorTitle
““ 7
,
““7 8
MessageBoxButton
”” $
.
””$ %
OK
””% '
,
””' (
MessageBoxImage
‘‘ #
.
‘‘# $
Error
‘‘$ )
)
‘‘) *
;
‘‘* +
Console
’’ 
.
’’ 
	WriteLine
’’ !
(
’’! "
$"
’’" $
$str
’’$ Q
{
’’Q R
ex
’’R T
.
’’T U
Message
’’U \
}
’’\ ]
"
’’] ^
)
’’^ _
;
’’_ `
}
÷÷ 
catch
◊◊ 
(
◊◊ 
	Exception
◊◊ 
ex
◊◊ 
)
◊◊  
{
ÿÿ 

MessageBox
ŸŸ 
.
ŸŸ 
Show
ŸŸ 
(
ŸŸ  
Lang
⁄⁄ 
.
⁄⁄ .
 alertPasswordRequestUnknownError
⁄⁄ 9
,
⁄⁄9 :
Lang
€€ 
.
€€ ,
alertPasswordRequestErrorTitle
€€ 7
,
€€7 8
MessageBoxButton
‹‹ $
.
‹‹$ %
OK
‹‹% '
,
‹‹' (
MessageBoxImage
›› #
.
››# $
Error
››$ )
)
››) *
;
››* +
Console
ﬁﬁ 
.
ﬁﬁ 
	WriteLine
ﬁﬁ !
(
ﬁﬁ! "
$"
ﬁﬁ" $
$str
ﬁﬁ$ Z
{
ﬁﬁZ [
ex
ﬁﬁ[ ]
.
ﬁﬁ] ^
Message
ﬁﬁ^ e
}
ﬁﬁe f
"
ﬁﬁf g
)
ﬁﬁg h
;
ﬁﬁh i
}
ﬂﬂ 
}
‡‡ 	
}
·· 
}‚‚ ç∑
ôC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\LobbyViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
{ 
public 

class 
LobbyViewModel 
:  !
ViewModelBase" /
{ 
private 
UserProfileDto 
_userProfileData /
;/ 0
private 
string 
	_username  
;  !
private 
BitmapImage 
_userAvatar '
;' (
private 
bool 
_isProfilePopupOpen (
;( )
private 
ProfileViewModel  
_profileViewModel! 2
;2 3
private 
bool 
_isFriendsPopupOpen (
;( )
private   
FriendsViewModel    
_friendsViewModel  ! 2
;  2 3
private!! 
bool!! %
_isConfigurationPopupOpen!! .
;!!. /
private"" "
ConfigurationViewModel"" &#
_configurationViewModel""' >
;""> ?
private## 
bool## 
_isChatPopupOpen## %
;##% &
private$$ "
DirectMessageViewModel$$ &#
_directMessageViewModel$$' >
;$$> ?
public&& 
UserProfileDto&& 
UserProfileData&& -
{'' 	
get(( 
{(( 
return(( 
_userProfileData(( )
;(() *
}((+ ,
set)) 
{** 
if++ 
(++ 
_userProfileData++ $
!=++% '
value++( -
)++- .
{,, 
_userProfileData-- $
=--% &
value--' ,
;--, -
OnPropertyChanged.. %
(..% &
)..& '
;..' (
}// 
}00 
}11 	
public33 
string33 
Username33 
{44 	
get55 
{55 
return55 
	_username55 "
;55" #
}55$ %
set66 
{77 
if88 
(88 
	_username88 
!=88  
value88! &
)88& '
{99 
	_username:: 
=:: 
value::  %
;::% &
OnPropertyChanged;; %
(;;% &
);;& '
;;;' (
}<< 
}== 
}>> 	
public@@ 
BitmapImage@@ 

UserAvatar@@ %
{AA 	
getBB 
{BB 
returnBB 
_userAvatarBB $
;BB$ %
}BB& '
setCC 
{DD 
ifEE 
(EE 
_userAvatarEE 
!=EE  "
valueEE# (
)EE( )
{FF 
_userAvatarGG 
=GG  !
valueGG" '
;GG' (
OnPropertyChangedHH %
(HH% &
)HH& '
;HH' (
}II 
}JJ 
}KK 	
publicMM 
boolMM 
IsProfilePopupOpenMM &
{NN 	
getOO 
{OO 
returnOO 
_isProfilePopupOpenOO ,
;OO, -
}OO. /
setPP 
{QQ 
ifRR 
(RR 
_isProfilePopupOpenRR '
!=RR( *
valueRR+ 0
)RR0 1
{SS 
_isProfilePopupOpenTT '
=TT( )
valueTT* /
;TT/ 0
OnPropertyChangedUU %
(UU% &
)UU& '
;UU' (
}VV 
}WW 
}XX 	
publicZZ 
ProfileViewModelZZ 
ProfileViewModelZZ  0
{[[ 	
get\\ 
{\\ 
return\\ 
_profileViewModel\\ *
;\\* +
}\\, -
set]] 
{^^ 
if__ 
(__ 
_profileViewModel__ %
!=__& (
value__) .
)__. /
{`` 
_profileViewModelaa %
=aa& '
valueaa( -
;aa- .
OnPropertyChangedbb %
(bb% &
)bb& '
;bb' (
}cc 
}dd 
}ee 	
publicgg 
boolgg 
IsFriendsPopupOpengg &
{hh 	
getii 
{ii 
returnii 
_isFriendsPopupOpenii ,
;ii, -
}ii. /
setjj 
{kk 
ifll 
(ll 
_isFriendsPopupOpenll '
!=ll( *
valuell+ 0
)ll0 1
{mm 
_isFriendsPopupOpennn '
=nn( )
valuenn* /
;nn/ 0
OnPropertyChangedoo %
(oo% &
)oo& '
;oo' (
}pp 
}qq 
}rr 	
publictt 
FriendsViewModeltt 
FriendsViewModeltt  0
{uu 	
getvv 
{vv 
returnvv 
_friendsViewModelvv *
;vv* +
}vv, -
setww 
{xx 
ifyy 
(yy 
_friendsViewModelyy %
!=yy& (
valueyy) .
)yy. /
{zz 
_friendsViewModel{{ %
={{& '
value{{( -
;{{- .
OnPropertyChanged|| %
(||% &
)||& '
;||' (
}}} 
}~~ 
} 	
public
ÅÅ 
bool
ÅÅ &
IsConfigurationPopupOpen
ÅÅ ,
{
ÇÇ 	
get
ÉÉ 
{
ÉÉ 
return
ÉÉ '
_isConfigurationPopupOpen
ÉÉ 2
;
ÉÉ2 3
}
ÉÉ4 5
set
ÑÑ 
{
ÖÖ 
if
ÜÜ 
(
ÜÜ '
_isConfigurationPopupOpen
ÜÜ -
!=
ÜÜ. 0
value
ÜÜ1 6
)
ÜÜ6 7
{
áá '
_isConfigurationPopupOpen
àà -
=
àà. /
value
àà0 5
;
àà5 6
OnPropertyChanged
ââ %
(
ââ% &
)
ââ& '
;
ââ' (
}
ää 
}
ãã 
}
åå 	
public
éé $
ConfigurationViewModel
éé %$
ConfigurationViewModel
éé& <
{
èè 	
get
êê 
{
êê 
return
êê %
_configurationViewModel
êê 0
;
êê0 1
}
êê2 3
set
ëë 
{
íí 
if
ìì 
(
ìì %
_configurationViewModel
ìì +
!=
ìì, .
value
ìì/ 4
)
ìì4 5
{
îî %
_configurationViewModel
ïï +
=
ïï, -
value
ïï. 3
;
ïï3 4
OnPropertyChanged
ññ %
(
ññ% &
)
ññ& '
;
ññ' (
}
óó 
}
òò 
}
ôô 	
public
õõ 
bool
õõ 
IsChatPopupOpen
õõ #
{
úú 	
get
ùù 
{
ùù 
return
ùù 
_isChatPopupOpen
ùù )
;
ùù) *
}
ùù+ ,
set
ûû 
{
üü 
if
†† 
(
†† 
_isChatPopupOpen
†† $
!=
††% '
value
††( -
)
††- .
{
°° 
_isChatPopupOpen
¢¢ $
=
¢¢% &
value
¢¢' ,
;
¢¢, -
OnPropertyChanged
££ %
(
££% &
)
££& '
;
££' (
}
§§ 
}
•• 
}
¶¶ 	
public
®® $
DirectMessageViewModel
®® %$
DirectMessageViewModel
®®& <
{
©© 	
get
™™ 
{
™™ 
return
™™ %
_directMessageViewModel
™™ 0
;
™™0 1
}
™™2 3
set
´´ 
{
¨¨ 
if
≠≠ 
(
≠≠ %
_directMessageViewModel
≠≠ +
!=
≠≠, .
value
≠≠/ 4
)
≠≠4 5
{
ÆÆ %
_directMessageViewModel
ØØ +
=
ØØ, -
value
ØØ. 3
;
ØØ3 4
OnPropertyChanged
∞∞ %
(
∞∞% &
)
∞∞& '
;
∞∞' (
}
±± 
}
≤≤ 
}
≥≥ 	
public
µµ 
ICommand
µµ 
SettingsCommand
µµ '
{
µµ( )
get
µµ* -
;
µµ- .
}
µµ/ 0
public
∂∂ 
ICommand
∂∂ 
FriendsCommand
∂∂ &
{
∂∂' (
get
∂∂) ,
;
∂∂, -
}
∂∂. /
public
∑∑ 
ICommand
∑∑ 
ChatCommand
∑∑ #
{
∑∑$ %
get
∑∑& )
;
∑∑) *
}
∑∑+ ,
public
∏∏ 
ICommand
∏∏ 
PlayCommand
∏∏ #
{
∏∏$ %
get
∏∏& )
;
∏∏) *
}
∏∏+ ,
public
ππ 
ICommand
ππ 
CreateGameCommand
ππ )
{
ππ* +
get
ππ, /
;
ππ/ 0
}
ππ1 2
public
∫∫ 
ICommand
∫∫  
EditProfileCommand
∫∫ *
{
∫∫+ ,
get
∫∫- 0
;
∫∫0 1
}
∫∫2 3
public
ªª 
ICommand
ªª !
SelectAvatarCommand
ªª +
{
ªª, -
get
ªª. 1
;
ªª1 2
}
ªª3 4
public
ºº 
ICommand
ºº  
CloseWindowCommand
ºº *
{
ºº+ ,
get
ºº- 0
;
ºº0 1
}
ºº2 3
public
ΩΩ 
ICommand
ΩΩ #
MaximizeWindowCommand
ΩΩ -
{
ΩΩ. /
get
ΩΩ0 3
;
ΩΩ3 4
}
ΩΩ5 6
public
ææ 
ICommand
ææ #
MinimizeWindowCommand
ææ -
{
ææ. /
get
ææ0 3
;
ææ3 4
}
ææ5 6
public
¿¿ 
LobbyViewModel
¿¿ 
(
¿¿ 
)
¿¿ 
{
¡¡ 	
SettingsCommand
¬¬ 
=
¬¬ 
new
¬¬ !
RelayCommand
¬¬" .
(
¬¬. /
ExecuteSettings
¬¬/ >
)
¬¬> ?
;
¬¬? @
FriendsCommand
√√ 
=
√√ 
new
√√  
RelayCommand
√√! -
(
√√- .
ExecuteFriends
√√. <
)
√√< =
;
√√= >
ChatCommand
ƒƒ 
=
ƒƒ 
new
ƒƒ 
RelayCommand
ƒƒ *
(
ƒƒ* +
ExecuteChat
ƒƒ+ 6
)
ƒƒ6 7
;
ƒƒ7 8
PlayCommand
≈≈ 
=
≈≈ 
new
≈≈ 
RelayCommand
≈≈ *
(
≈≈* +
ExecutePlay
≈≈+ 6
)
≈≈6 7
;
≈≈7 8
CreateGameCommand
∆∆ 
=
∆∆ 
new
∆∆  #
RelayCommand
∆∆$ 0
(
∆∆0 1
ExecuteCreateGame
∆∆1 B
)
∆∆B C
;
∆∆C D 
EditProfileCommand
«« 
=
««  
new
««! $
RelayCommand
««% 1
(
««1 2 
ExecuteEditProfile
««2 D
)
««D E
;
««E F!
SelectAvatarCommand
»» 
=
»»  !
new
»»" %
RelayCommand
»»& 2
(
»»2 3!
ExecuteSelectAvatar
»»3 F
)
»»F G
;
»»G H 
CloseWindowCommand
…… 
=
……  
new
……! $
RelayCommand
……% 1
(
……1 2 
ExecuteCloseWindow
……2 D
)
……D E
;
……E F#
MaximizeWindowCommand
   !
=
  " #
new
  $ '
RelayCommand
  ( 4
(
  4 5#
ExecuteMaximizeWindow
  5 J
)
  J K
;
  K L#
MinimizeWindowCommand
ÀÀ !
=
ÀÀ" #
new
ÀÀ$ '
RelayCommand
ÀÀ( 4
(
ÀÀ4 5#
ExecuteMinimizeWindow
ÀÀ5 J
)
ÀÀJ K
;
ÀÀK L
try
ÕÕ 
{
ŒŒ !
SocialClientManager
œœ #
.
œœ# $
Instance
œœ$ ,
.
œœ, -

Initialize
œœ- 7
(
œœ7 8
)
œœ8 9
;
œœ9 :
FriendsViewModel
––  
=
––! "
new
––# &
FriendsViewModel
––' 7
(
––7 8
)
––8 9
;
––9 :$
DirectMessageViewModel
—— &
=
——' (
new
——) ,$
DirectMessageViewModel
——- C
(
——C D
)
——D E
;
——E F$
ConfigurationViewModel
““ &
=
““' (
new
““) ,$
ConfigurationViewModel
““- C
(
““C D
)
““D E
;
““E F
}
”” 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 

MessageBox
÷÷ 
.
÷÷ 
Show
÷÷ 
(
÷÷  
string
◊◊ 
.
◊◊ 
Format
◊◊ !
(
◊◊! "
Lang
◊◊" &
.
◊◊& ')
alertSocialServiceInitError
◊◊' B
,
◊◊B C
ex
◊◊D F
.
◊◊F G
Message
◊◊G N
)
◊◊N O
,
◊◊O P
Lang
ÿÿ 
.
ÿÿ %
alertCriticalErrorTitle
ÿÿ 0
,
ÿÿ0 1
MessageBoxButton
ŸŸ $
.
ŸŸ$ %
OK
ŸŸ% '
,
ŸŸ' (
MessageBoxImage
⁄⁄ #
.
⁄⁄# $
Warning
⁄⁄$ +
)
⁄⁄+ ,
;
⁄⁄, -
Console
€€ 
.
€€ 
	WriteLine
€€ !
(
€€! "
$"
€€" $
$str
€€$ M
{
€€M N
ex
€€N P
.
€€P Q
Message
€€Q X
}
€€X Y
"
€€Y Z
)
€€Z [
;
€€[ \
}
‹‹ 
LoadDataOnEntry
ﬁﬁ 
(
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 	
private
·· 
async
·· 
Task
·· 
LoadDataOnEntry
·· *
(
··* +
)
··+ ,
{
‚‚ 	
await
„„ "
LoadUserProfileAsync
„„ &
(
„„& '
)
„„' (
;
„„( )
}
‰‰ 	
private
ÊÊ 
void
ÊÊ 
ExecuteSettings
ÊÊ $
(
ÊÊ$ %
object
ÊÊ% +
	parameter
ÊÊ, 5
)
ÊÊ5 6
{
ÁÁ 	
if
ËË 
(
ËË $
ConfigurationViewModel
ËË &
!=
ËË' )
null
ËË* .
)
ËË. /
{
ÈÈ  
IsProfilePopupOpen
ÍÍ "
=
ÍÍ# $
false
ÍÍ% *
;
ÍÍ* + 
IsFriendsPopupOpen
ÎÎ "
=
ÎÎ# $
false
ÎÎ% *
;
ÎÎ* +
IsChatPopupOpen
ÏÏ 
=
ÏÏ  !
false
ÏÏ" '
;
ÏÏ' (&
IsConfigurationPopupOpen
ÌÌ (
=
ÌÌ) *
!
ÌÌ+ ,&
IsConfigurationPopupOpen
ÌÌ, D
;
ÌÌD E
}
ÓÓ 
else
ÔÔ 
{
 

MessageBox
ÒÒ 
.
ÒÒ 
Show
ÒÒ 
(
ÒÒ  
Lang
ÚÚ 
.
ÚÚ *
alertFeatureUnavailableError
ÚÚ 5
,
ÚÚ5 6
Lang
ÛÛ 
.
ÛÛ 
alertErrorTitle
ÛÛ (
,
ÛÛ( )
MessageBoxButton
ÙÙ $
.
ÙÙ$ %
OK
ÙÙ% '
,
ÙÙ' (
MessageBoxImage
ıı #
.
ıı# $
Warning
ıı$ +
)
ıı+ ,
;
ıı, -
}
ˆˆ 
}
˜˜ 	
private
˘˘ 
void
˘˘ 
ExecuteFriends
˘˘ #
(
˘˘# $
object
˘˘$ *
param
˘˘+ 0
)
˘˘0 1
{
˙˙ 	
if
˚˚ 
(
˚˚ 
FriendsViewModel
˚˚  
!=
˚˚! #
null
˚˚$ (
)
˚˚( )
{
¸¸  
IsProfilePopupOpen
˝˝ "
=
˝˝# $
false
˝˝% *
;
˝˝* +&
IsConfigurationPopupOpen
˛˛ (
=
˛˛) *
false
˛˛+ 0
;
˛˛0 1
IsChatPopupOpen
ˇˇ 
=
ˇˇ  !
false
ˇˇ" '
;
ˇˇ' ( 
IsFriendsPopupOpen
ÄÄ "
=
ÄÄ# $
!
ÄÄ% & 
IsFriendsPopupOpen
ÄÄ& 8
;
ÄÄ8 9
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 

MessageBox
ÑÑ 
.
ÑÑ 
Show
ÑÑ 
(
ÑÑ  
Lang
ÖÖ 
.
ÖÖ *
alertFeatureUnavailableError
ÖÖ 5
,
ÖÖ5 6
Lang
ÜÜ 
.
ÜÜ 
alertErrorTitle
ÜÜ (
,
ÜÜ( )
MessageBoxButton
áá $
.
áá$ %
OK
áá% '
,
áá' (
MessageBoxImage
àà #
.
àà# $
Warning
àà$ +
)
àà+ ,
;
àà, -
}
ââ 
}
ää 	
private
åå 
void
åå 
ExecuteChat
åå  
(
åå  !
object
åå! '
param
åå( -
)
åå- .
{
çç 	
if
éé 
(
éé $
DirectMessageViewModel
éé &
!=
éé' )
null
éé* .
)
éé. /
{
èè  
IsProfilePopupOpen
êê "
=
êê# $
false
êê% *
;
êê* +&
IsConfigurationPopupOpen
ëë (
=
ëë) *
false
ëë+ 0
;
ëë0 1 
IsFriendsPopupOpen
íí "
=
íí# $
false
íí% *
;
íí* +
IsChatPopupOpen
ìì 
=
ìì  !
!
ìì" #
IsChatPopupOpen
ìì# 2
;
ìì2 3
}
îî 
else
ïï 
{
ññ 

MessageBox
óó 
.
óó 
Show
óó 
(
óó  
Lang
òò 
.
òò  
alertChatLoadError
òò +
,
òò+ ,
Lang
ôô 
.
ôô 
alertErrorTitle
ôô (
,
ôô( )
MessageBoxButton
öö $
.
öö$ %
OK
öö% '
,
öö' (
MessageBoxImage
õõ #
.
õõ# $
Warning
õõ$ +
)
õõ+ ,
;
õõ, -
}
úú 
}
ùù 	
private
üü 
void
üü 
ExecutePlay
üü  
(
üü  !
object
üü! '
param
üü( -
)
üü- .
{
†† 	
MatchesViewModel
°° 
matchesViewModel
°° -
=
°°. /
new
°°0 3
MatchesViewModel
°°4 D
(
°°D E
)
°°E F
;
°°F G
MatchesView
¢¢ 
matchesView
¢¢ #
=
¢¢$ %
new
¢¢& )
MatchesView
¢¢* 5
(
¢¢5 6
)
¢¢6 7
;
¢¢7 8
matchesView
££ 
.
££ 
DataContext
££ #
=
££$ %
matchesViewModel
££& 6
;
££6 7
matchesView
§§ 
.
§§ 
Show
§§ 
(
§§ 
)
§§ 
;
§§ %
CloseCurrentLobbyWindow
•• #
(
••# $
)
••$ %
;
••% &
}
¶¶ 	
private
®® 
void
®® 
ExecuteCreateGame
®® &
(
®®& '
object
®®' -
param
®®. 3
)
®®3 4
{
©© 	$
MatchSettingsViewModel
™™ "$
matchSettingsViewModel
™™# 9
=
™™: ;
new
™™< ?$
MatchSettingsViewModel
™™@ V
(
™™V W
)
™™W X
;
™™X Y
MatchSettingsView
´´ 
matchSettingsView
´´ /
=
´´0 1
new
´´2 5
MatchSettingsView
´´6 G
(
´´G H
)
´´H I
;
´´I J
matchSettingsView
¨¨ 
.
¨¨ 
DataContext
¨¨ )
=
¨¨* +$
matchSettingsViewModel
¨¨, B
;
¨¨B C
matchSettingsView
≠≠ 
.
≠≠ 
Show
≠≠ "
(
≠≠" #
)
≠≠# $
;
≠≠$ %%
CloseCurrentLobbyWindow
ÆÆ #
(
ÆÆ# $
)
ÆÆ$ %
;
ÆÆ% &
}
ØØ 	
private
±± 
async
±± 
Task
±± "
LoadUserProfileAsync
±± /
(
±±/ 0
)
±±0 1
{
≤≤ 	
if
≥≥ 
(
≥≥ 
!
≥≥ 
SessionManager
≥≥ 
.
≥≥  
Instance
≥≥  (
.
≥≥( )

IsLoggedIn
≥≥) 3
)
≥≥3 4
{
¥¥ 
Console
µµ 
.
µµ 
	WriteLine
µµ !
(
µµ! "
$str
µµ" N
)
µµN O
;
µµO P
return
∂∂ 
;
∂∂ 
}
∑∑ 
using
ππ 
(
ππ 
var
ππ 
client
ππ 
=
ππ 
new
ππ  #&
UserProfileServiceClient
ππ$ <
(
ππ< =
)
ππ= >
)
ππ> ?
{
∫∫ 
try
ªª 
{
ºº 
UserProfileDto
ΩΩ "
profileData
ΩΩ# .
=
ΩΩ/ 0
await
ΩΩ1 6
client
ΩΩ7 =
.
ΩΩ= >!
GetUserProfileAsync
ΩΩ> Q
(
ΩΩQ R
SessionManager
ΩΩR `
.
ΩΩ` a
Instance
ΩΩa i
.
ΩΩi j
CurrentUsername
ΩΩj y
)
ΩΩy z
;
ΩΩz {
if
øø 
(
øø 
profileData
øø #
==
øø$ &
null
øø' +
)
øø+ ,
{
¿¿ 

MessageBox
¡¡ "
.
¡¡" #
Show
¡¡# '
(
¡¡' (
Lang
¬¬  
.
¬¬  !#
alertProfileLoadError
¬¬! 6
,
¬¬6 7
Lang
√√  
.
√√  !
alertErrorTitle
√√! 0
,
√√0 1
MessageBoxButton
ƒƒ ,
.
ƒƒ, -
OK
ƒƒ- /
,
ƒƒ/ 0
MessageBoxImage
≈≈ +
.
≈≈+ ,
Error
≈≈, 1
)
≈≈1 2
;
≈≈2 3
return
∆∆ 
;
∆∆ 
}
«« 
UserProfileData
…… #
=
……$ %
profileData
……& 1
;
……1 2
Username
   
=
   
profileData
   *
.
  * +
Username
  + 3
;
  3 4
ProfileViewModel
ÀÀ $
=
ÀÀ% &
new
ÀÀ' *
ProfileViewModel
ÀÀ+ ;
(
ÀÀ; <
UserProfileData
ÀÀ< K
)
ÀÀK L
;
ÀÀL M
var
ÕÕ 

allAvatars
ÕÕ "
=
ÕÕ# $
await
ÕÕ% *
client
ÕÕ+ 1
.
ÕÕ1 2&
GetAvailableAvatarsAsync
ÕÕ2 J
(
ÕÕJ K
)
ÕÕK L
;
ÕÕL M
if
ŒŒ 
(
ŒŒ 

allAvatars
ŒŒ "
!=
ŒŒ# %
null
ŒŒ& *
)
ŒŒ* +
{
œœ 
var
–– 
userAvatarDto
–– )
=
––* +

allAvatars
––, 6
.
––6 7
FirstOrDefault
––7 E
(
––E F
a
––F G
=>
––H J
a
––K L
.
––L M
IdAvatar
––M U
==
––V X
profileData
––Y d
.
––d e
AvatarId
––e m
)
––m n
;
––n o
if
—— 
(
—— 
userAvatarDto
—— )
?
——) *
.
——* +

AvatarData
——+ 5
!=
——6 8
null
——9 =
)
——= >
{
““ 

UserAvatar
”” &
=
””' ( 
ConvertByteToImage
””) ;
(
””; <
userAvatarDto
””< I
.
””I J

AvatarData
””J T
)
””T U
;
””U V
}
‘‘ 
else
’’ 
{
÷÷ 
Console
◊◊ #
.
◊◊# $
	WriteLine
◊◊$ -
(
◊◊- .
$"
◊◊. 0
$str
◊◊0 >
{
◊◊> ?
profileData
◊◊? J
.
◊◊J K
AvatarId
◊◊K S
}
◊◊S T
$str
◊◊T o
"
◊◊o p
)
◊◊p q
;
◊◊q r
}
ÿÿ 
}
ŸŸ 
}
⁄⁄ 
catch
€€ 
(
€€ 
FaultException
€€ %

fexGeneral
€€& 0
)
€€0 1
{
‹‹ 

MessageBox
›› 
.
›› 
Show
›› #
(
››# $
Lang
ﬁﬁ 
.
ﬁﬁ )
alertProfileLoadServerError
ﬁﬁ 8
,
ﬁﬁ8 9
Lang
ﬂﬂ 
.
ﬂﬂ 
alertErrorTitle
ﬂﬂ ,
,
ﬂﬂ, -
MessageBoxButton
‡‡ (
.
‡‡( )
OK
‡‡) +
,
‡‡+ ,
MessageBoxImage
·· '
.
··' (
Error
··( -
)
··- .
;
··. /
Console
‚‚ 
.
‚‚ 
	WriteLine
‚‚ %
(
‚‚% &
$"
‚‚& (
$str
‚‚( C
{
‚‚C D

fexGeneral
‚‚D N
.
‚‚N O
Message
‚‚O V
}
‚‚V W
"
‚‚W X
)
‚‚X Y
;
‚‚Y Z
}
„„ 
catch
‰‰ 
(
‰‰ '
EndpointNotFoundException
‰‰ 0
ex
‰‰1 3
)
‰‰3 4
{
ÂÂ 

MessageBox
ÊÊ 
.
ÊÊ 
Show
ÊÊ #
(
ÊÊ# $
Lang
ÁÁ 
.
ÁÁ )
alertConnectionErrorMessage
ÁÁ 8
,
ÁÁ8 9
Lang
ËË 
.
ËË '
alertConnectionErrorTitle
ËË 6
,
ËË6 7
MessageBoxButton
ÈÈ (
.
ÈÈ( )
OK
ÈÈ) +
,
ÈÈ+ ,
MessageBoxImage
ÍÍ '
.
ÍÍ' (
Error
ÍÍ( -
)
ÍÍ- .
;
ÍÍ. /
Console
ÎÎ 
.
ÎÎ 
	WriteLine
ÎÎ %
(
ÎÎ% &
$"
ÎÎ& (
$str
ÎÎ( J
{
ÎÎJ K
ex
ÎÎK M
.
ÎÎM N
Message
ÎÎN U
}
ÎÎU V
"
ÎÎV W
)
ÎÎW X
;
ÎÎX Y
}
ÏÏ 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ  
ex
ÌÌ! #
)
ÌÌ# $
{
ÓÓ 

MessageBox
ÔÔ 
.
ÔÔ 
Show
ÔÔ #
(
ÔÔ# $
Lang
 
.
 #
alertProfileLoadError
 2
,
2 3
Lang
ÒÒ 
.
ÒÒ 
alertErrorTitle
ÒÒ ,
,
ÒÒ, -
MessageBoxButton
ÚÚ (
.
ÚÚ( )
OK
ÚÚ) +
,
ÚÚ+ ,
MessageBoxImage
ÛÛ '
.
ÛÛ' (
Error
ÛÛ( -
)
ÛÛ- .
;
ÛÛ. /
Console
ÙÙ 
.
ÙÙ 
	WriteLine
ÙÙ %
(
ÙÙ% &
$"
ÙÙ& (
$str
ÙÙ( ?
{
ÙÙ? @
ex
ÙÙ@ B
.
ÙÙB C
Message
ÙÙC J
}
ÙÙJ K
"
ÙÙK L
)
ÙÙL M
;
ÙÙM N
}
ıı 
}
ˆˆ 
}
˜˜ 	
private
˘˘ 
void
˘˘  
ExecuteEditProfile
˘˘ '
(
˘˘' (
object
˘˘( .
	parameter
˘˘/ 8
)
˘˘8 9
{
˙˙ 	
if
˚˚ 
(
˚˚ 
ProfileViewModel
˚˚  
!=
˚˚! #
null
˚˚$ (
)
˚˚( )
{
¸¸ &
IsConfigurationPopupOpen
˝˝ (
=
˝˝) *
false
˝˝+ 0
;
˝˝0 1 
IsFriendsPopupOpen
˛˛ "
=
˛˛# $
false
˛˛% *
;
˛˛* +
IsChatPopupOpen
ˇˇ 
=
ˇˇ  !
false
ˇˇ" '
;
ˇˇ' ( 
IsProfilePopupOpen
ÄÄ "
=
ÄÄ# $
!
ÄÄ% & 
IsProfilePopupOpen
ÄÄ& 8
;
ÄÄ8 9
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 

MessageBox
ÑÑ 
.
ÑÑ 
Show
ÑÑ 
(
ÑÑ  
Lang
ÖÖ 
.
ÖÖ #
alertProfileNotLoaded
ÖÖ .
,
ÖÖ. /
Lang
ÜÜ 
.
ÜÜ 
alertInfoTitle
ÜÜ '
,
ÜÜ' (
MessageBoxButton
áá $
.
áá$ %
OK
áá% '
,
áá' (
MessageBoxImage
àà #
.
àà# $
Information
àà$ /
)
àà/ 0
;
àà0 1
}
ââ 
}
ää 	
private
åå 
void
åå !
ExecuteSelectAvatar
åå (
(
åå( )
object
åå) /
	parameter
åå0 9
)
åå9 :
{
çç 	
if
éé 
(
éé 
UserProfileData
éé 
==
éé  "
null
éé# '
)
éé' (
{
èè 

MessageBox
êê 
.
êê 
Show
êê 
(
êê  
Lang
ëë 
.
ëë #
alertProfileNotLoaded
ëë .
,
ëë. /
Lang
íí 
.
íí 
alertInfoTitle
íí '
,
íí' (
MessageBoxButton
ìì $
.
ìì$ %
OK
ìì% '
,
ìì' (
MessageBoxImage
îî #
.
îî# $
Information
îî$ /
)
îî/ 0
;
îî0 1
return
ïï 
;
ïï 
}
ññ 
var
òò 
selectAvatarView
òò  
=
òò! "
new
òò# &
SelectAvatarView
òò' 7
(
òò7 8
)
òò8 9
;
òò9 :
var
ôô #
selectAvatarViewModel
ôô %
=
ôô& '
new
ôô( +#
SelectAvatarViewModel
ôô, A
(
ôôA B
UserProfileData
ôôB Q
.
ôôQ R
AvatarId
ôôR Z
)
ôôZ [
;
ôô[ \#
selectAvatarViewModel
öö !
.
öö! "
AvatarSelected
öö" 0
+=
öö1 3
OnAvatarSelected
öö4 D
;
ööD E
selectAvatarView
õõ 
.
õõ 
DataContext
õõ (
=
õõ) *#
selectAvatarViewModel
õõ+ @
;
õõ@ A
selectAvatarView
úú 
.
úú 

ShowDialog
úú '
(
úú' (
)
úú( )
;
úú) *#
selectAvatarViewModel
ùù !
.
ùù! "
AvatarSelected
ùù" 0
-=
ùù1 3
OnAvatarSelected
ùù4 D
;
ùùD E
}
ûû 	
private
†† 
async
†† 
void
†† 
OnAvatarSelected
†† +
(
††+ ,
AvatarModel
††, 7
	newAvatar
††8 A
)
††A B
{
°° 	
if
¢¢ 
(
¢¢ 
	newAvatar
¢¢ 
==
¢¢ 
null
¢¢ !
||
¢¢" $
UserProfileData
¢¢% 4
==
¢¢5 7
null
¢¢8 <
||
¢¢= ?
	newAvatar
¢¢@ I
.
¢¢I J
Id
¢¢J L
==
¢¢M O
UserProfileData
¢¢P _
.
¢¢_ `
AvatarId
¢¢` h
)
¢¢h i
{
££ 
return
§§ 
;
§§ 
}
•• 
UserProfileData
ßß 
.
ßß 
AvatarId
ßß $
=
ßß% &
	newAvatar
ßß' 0
.
ßß0 1
Id
ßß1 3
;
ßß3 4
using
©© 
(
©© 
var
©© 
client
©© 
=
©© 
new
©©  #&
UserProfileServiceClient
©©$ <
(
©©< =
)
©©= >
)
©©> ?
{
™™ 
try
´´ 
{
¨¨  
OperationResultDto
≠≠ &
result
≠≠' -
=
≠≠. /
await
≠≠0 5
client
≠≠6 <
.
≠≠< = 
UpdateProfileAsync
≠≠= O
(
≠≠O P
Username
≠≠P X
,
≠≠X Y
UserProfileData
≠≠Z i
)
≠≠i j
;
≠≠j k
if
ÆÆ 
(
ÆÆ 
result
ÆÆ 
.
ÆÆ 
Success
ÆÆ &
)
ÆÆ& '
{
ØØ 

UserAvatar
∞∞ "
=
∞∞# $
	newAvatar
∞∞% .
.
∞∞. /
ImageSource
∞∞/ :
;
∞∞: ;

MessageBox
±± "
.
±±" #
Show
±±# '
(
±±' (
Lang
≤≤  
.
≤≤  !&
alertAvatarUpdateSuccess
≤≤! 9
,
≤≤9 :
Lang
≥≥  
.
≥≥  !
alertSuccessTitle
≥≥! 2
,
≥≥2 3
MessageBoxButton
¥¥ ,
.
¥¥, -
OK
¥¥- /
,
¥¥/ 0
MessageBoxImage
µµ +
.
µµ+ ,
Information
µµ, 7
)
µµ7 8
;
µµ8 9
}
∂∂ 
else
∑∑ 
{
∏∏ 

MessageBox
ππ "
.
ππ" #
Show
ππ# '
(
ππ' (
result
∫∫ "
.
∫∫" #
Message
∫∫# *
,
∫∫* +
Lang
ªª  
.
ªª  !)
alertAvatarUpdateErrorTitle
ªª! <
,
ªª< =
MessageBoxButton
ºº ,
.
ºº, -
OK
ºº- /
,
ºº/ 0
MessageBoxImage
ΩΩ +
.
ΩΩ+ ,
Warning
ΩΩ, 3
)
ΩΩ3 4
;
ΩΩ4 5
}
ææ 
}
øø 
catch
¿¿ 
(
¿¿ 
FaultException
¿¿ %

fexGeneral
¿¿& 0
)
¿¿0 1
{
¡¡ 

MessageBox
¬¬ 
.
¬¬ 
Show
¬¬ #
(
¬¬# $
Lang
√√ 
.
√√ %
alertServerErrorMessage
√√ 4
,
√√4 5
Lang
ƒƒ 
.
ƒƒ )
alertAvatarUpdateErrorTitle
ƒƒ 8
,
ƒƒ8 9
MessageBoxButton
≈≈ (
.
≈≈( )
OK
≈≈) +
,
≈≈+ ,
MessageBoxImage
∆∆ '
.
∆∆' (
Error
∆∆( -
)
∆∆- .
;
∆∆. /
Console
«« 
.
«« 
	WriteLine
«« %
(
««% &
$"
««& (
$str
««( A
{
««A B

fexGeneral
««B L
.
««L M
Message
««M T
}
««T U
"
««U V
)
««V W
;
««W X
}
»» 
catch
…… 
(
…… '
EndpointNotFoundException
…… 0
ex
……1 3
)
……3 4
{
   

MessageBox
ÀÀ 
.
ÀÀ 
Show
ÀÀ #
(
ÀÀ# $
Lang
ÃÃ 
.
ÃÃ )
alertConnectionErrorMessage
ÃÃ 8
,
ÃÃ8 9
Lang
ÕÕ 
.
ÕÕ )
alertAvatarUpdateErrorTitle
ÕÕ 8
,
ÕÕ8 9
MessageBoxButton
ŒŒ (
.
ŒŒ( )
OK
ŒŒ) +
,
ŒŒ+ ,
MessageBoxImage
œœ '
.
œœ' (
Error
œœ( -
)
œœ- .
;
œœ. /
Console
–– 
.
–– 
	WriteLine
–– %
(
––% &
$"
––& (
$str
––( H
{
––H I
ex
––I K
.
––K L
Message
––L S
}
––S T
"
––T U
)
––U V
;
––V W
}
—— 
catch
““ 
(
““ 
	Exception
““  
ex
““! #
)
““# $
{
”” 

MessageBox
‘‘ 
.
‘‘ 
Show
‘‘ #
(
‘‘# $
Lang
’’ 
.
’’ +
alertAvatarUpdateUnknownError
’’ :
,
’’: ;
Lang
÷÷ 
.
÷÷ )
alertAvatarUpdateErrorTitle
÷÷ 8
,
÷÷8 9
MessageBoxButton
◊◊ (
.
◊◊( )
OK
◊◊) +
,
◊◊+ ,
MessageBoxImage
ÿÿ '
.
ÿÿ' (
Error
ÿÿ( -
)
ÿÿ- .
;
ÿÿ. /
Console
ŸŸ 
.
ŸŸ 
	WriteLine
ŸŸ %
(
ŸŸ% &
$"
ŸŸ& (
$str
ŸŸ( @
{
ŸŸ@ A
ex
ŸŸA C
.
ŸŸC D
Message
ŸŸD K
}
ŸŸK L
"
ŸŸL M
)
ŸŸM N
;
ŸŸN O
}
⁄⁄ 
}
€€ 
}
‹‹ 	
public
ﬁﬁ 
static
ﬁﬁ 
BitmapImage
ﬁﬁ ! 
ConvertByteToImage
ﬁﬁ" 4
(
ﬁﬁ4 5
byte
ﬁﬁ5 9
[
ﬁﬁ9 :
]
ﬁﬁ: ;

imageBytes
ﬁﬁ< F
)
ﬁﬁF G
{
ﬂﬂ 	
if
‡‡ 
(
‡‡ 

imageBytes
‡‡ 
==
‡‡ 
null
‡‡ "
||
‡‡# %

imageBytes
‡‡& 0
.
‡‡0 1
Length
‡‡1 7
==
‡‡8 :
$num
‡‡; <
)
‡‡< =
{
·· 
return
‚‚ 
null
‚‚ 
;
‚‚ 
}
„„ 
var
ÂÂ 
image
ÂÂ 
=
ÂÂ 
new
ÂÂ 
BitmapImage
ÂÂ '
(
ÂÂ' (
)
ÂÂ( )
;
ÂÂ) *
using
ÊÊ 
(
ÊÊ 
var
ÊÊ 
mem
ÊÊ 
=
ÊÊ 
new
ÊÊ  
MemoryStream
ÊÊ! -
(
ÊÊ- .

imageBytes
ÊÊ. 8
)
ÊÊ8 9
)
ÊÊ9 :
{
ÁÁ 
mem
ËË 
.
ËË 
Position
ËË 
=
ËË 
$num
ËË  
;
ËË  !
image
ÈÈ 
.
ÈÈ 
	BeginInit
ÈÈ 
(
ÈÈ  
)
ÈÈ  !
;
ÈÈ! "
image
ÍÍ 
.
ÍÍ 
CreateOptions
ÍÍ #
=
ÍÍ$ %!
BitmapCreateOptions
ÍÍ& 9
.
ÍÍ9 :!
PreservePixelFormat
ÍÍ: M
;
ÍÍM N
image
ÎÎ 
.
ÎÎ 
CacheOption
ÎÎ !
=
ÎÎ" #
BitmapCacheOption
ÎÎ$ 5
.
ÎÎ5 6
OnLoad
ÎÎ6 <
;
ÎÎ< =
image
ÏÏ 
.
ÏÏ 
	UriSource
ÏÏ 
=
ÏÏ  !
null
ÏÏ" &
;
ÏÏ& '
image
ÌÌ 
.
ÌÌ 
StreamSource
ÌÌ "
=
ÌÌ# $
mem
ÌÌ% (
;
ÌÌ( )
image
ÓÓ 
.
ÓÓ 
EndInit
ÓÓ 
(
ÓÓ 
)
ÓÓ 
;
ÓÓ  
}
ÔÔ 
image
 
.
 
Freeze
 
(
 
)
 
;
 
return
ÒÒ 
image
ÒÒ 
;
ÒÒ 
}
ÚÚ 	
public
ÙÙ 
void
ÙÙ %
CleanupSocialConnection
ÙÙ +
(
ÙÙ+ ,
)
ÙÙ, -
{
ıı 	
FriendsViewModel
ˆˆ 
?
ˆˆ 
.
ˆˆ 
Cleanup
ˆˆ %
(
ˆˆ% &
)
ˆˆ& '
;
ˆˆ' ($
DirectMessageViewModel
˜˜ "
?
˜˜" #
.
˜˜# $
Cleanup
˜˜$ +
(
˜˜+ ,
)
˜˜, -
;
˜˜- .!
SocialClientManager
¯¯ 
.
¯¯  
Instance
¯¯  (
.
¯¯( )
Cleanup
¯¯) 0
(
¯¯0 1
)
¯¯1 2
;
¯¯2 3
Console
˘˘ 
.
˘˘ 
	WriteLine
˘˘ 
(
˘˘ 
$str
˘˘ 9
)
˘˘9 :
;
˘˘: ;
}
˙˙ 	
private
¸¸ 
static
¸¸ 
void
¸¸ %
CloseCurrentLobbyWindow
¸¸ 3
(
¸¸3 4
)
¸¸4 5
{
˝˝ 	
Window
˛˛ 
lobbyWindow
˛˛ 
=
˛˛  
Application
˛˛! ,
.
˛˛, -
Current
˛˛- 4
.
˛˛4 5
Windows
˛˛5 <
.
˛˛< =
OfType
˛˛= C
<
˛˛C D
	LobbyView
˛˛D M
>
˛˛M N
(
˛˛N O
)
˛˛O P
.
˛˛P Q
FirstOrDefault
˛˛Q _
(
˛˛_ `
)
˛˛` a
;
˛˛a b
if
ˇˇ 
(
ˇˇ 
lobbyWindow
ˇˇ 
!=
ˇˇ 
null
ˇˇ #
)
ˇˇ# $
{
ÄÄ 
lobbyWindow
ÅÅ 
.
ÅÅ 
Close
ÅÅ !
(
ÅÅ! "
)
ÅÅ" #
;
ÅÅ# $
}
ÇÇ 
else
ÉÉ 
{
ÑÑ 

MessageBox
ÖÖ 
.
ÖÖ 
Show
ÖÖ 
(
ÖÖ  
Lang
ÜÜ 
.
ÜÜ +
alertLobbyWindowNotFoundError
ÜÜ 6
,
ÜÜ6 7
Lang
áá 
.
áá 
alertErrorTitle
áá (
,
áá( )
MessageBoxButton
àà $
.
àà$ %
OK
àà% '
,
àà' (
MessageBoxImage
ââ #
.
ââ# $
Warning
ââ$ +
)
ââ+ ,
;
ââ, -
Console
ää 
.
ää 
	WriteLine
ää !
(
ää! "
$str
ää" V
)
ääV W
;
ääW X
}
ãã 
}
åå 	
private
éé 
void
éé  
ExecuteCloseWindow
éé '
(
éé' (
object
éé( .
	parameter
éé/ 8
)
éé8 9
{
èè 	
if
êê 
(
êê 
	parameter
êê 
is
êê 
Window
êê #
)
êê# $
{
ëë %
CleanupSocialConnection
íí '
(
íí' (
)
íí( )
;
íí) *
Application
ìì 
.
ìì 
Current
ìì #
.
ìì# $
Shutdown
ìì$ ,
(
ìì, -
)
ìì- .
;
ìì. /
}
îî 
}
ïï 	
private
óó 
static
óó 
void
óó #
ExecuteMaximizeWindow
óó 1
(
óó1 2
object
óó2 8
	parameter
óó9 B
)
óóB C
{
òò 	
if
ôô 
(
ôô 
	parameter
ôô 
is
ôô 
Window
ôô #
window
ôô$ *
)
ôô* +
{
öö 
window
õõ 
.
õõ 
WindowState
õõ "
=
õõ# $
window
õõ% +
.
õõ+ ,
WindowState
õõ, 7
==
õõ8 :
WindowState
õõ; F
.
õõF G
	Maximized
õõG P
?
õõQ R
WindowState
õõS ^
.
õõ^ _
Normal
õõ_ e
:
õõf g
WindowState
õõh s
.
õõs t
	Maximized
õõt }
;
õõ} ~
}
úú 
}
ùù 	
private
üü 
static
üü 
void
üü #
ExecuteMinimizeWindow
üü 1
(
üü1 2
object
üü2 8
	parameter
üü9 B
)
üüB C
{
†† 	
if
°° 
(
°° 
	parameter
°° 
is
°° 
Window
°° #
window
°°$ *
)
°°* +
{
¢¢ 
window
££ 
.
££ 
WindowState
££ "
=
££# $
WindowState
££% 0
.
££0 1
	Minimized
££1 :
;
££: ;
}
§§ 
}
•• 	
}
¶¶ 
}ßß ÿ™
õC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\FriendsViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
{ 
public 

class 
FriendsViewModel !
:" #
ViewModelBase$ 1
,1 2
IDisposable3 >
{ 
private 
static 
SocialServiceClient *
Client+ 1
=>2 4
SocialClientManager5 H
.H I
InstanceI Q
.Q R
ClientR X
;X Y
public  
ObservableCollection #
<# $
FriendViewModel$ 3
>3 4
Friends5 <
{= >
get? B
;B C
}D E
public  
ObservableCollection #
<# $"
FriendRequestViewModel$ :
>: ;
FriendRequests< J
{K L
getM P
;P Q
}R S
private  
ObservableCollection $
<$ %
UserProfileDto% 3
>3 4
_searchResults5 C
;C D
public  
ObservableCollection #
<# $
UserProfileDto$ 2
>2 3
SearchResults4 A
{ 	
get 
{ 
return 
_searchResults '
;' (
}) *
set 
{ 
if 
( 
_searchResults "
!=# %
value& +
)+ ,
{ 
_searchResults "
=# $
value% *
;* +
OnPropertyChanged %
(% &
)& '
;' (
}   
}!! 
}"" 	
private$$ 
string$$ 
_searchText$$ "
;$$" #
public%% 
string%% 

SearchText%%  
{&& 	
get'' 
{'' 
return'' 
_searchText'' $
;''$ %
}''& '
set(( 
{)) 
if** 
(** 
_searchText** 
!=**  "
value**# (
)**( )
{++ 
_searchText,, 
=,,  !
value,," '
;,,' (
OnPropertyChanged-- %
(--% &
)--& '
;--' (
}.. 
}// 
}00 	
public22 
ICommand22 
SearchCommand22 %
{22& '
get22( +
;22+ ,
}22- .
public33 
ICommand33  
InviteByEmailCommand33 ,
{33- .
get33/ 2
;332 3
}334 5
public44 
ICommand44 $
SendFriendRequestCommand44 0
{441 2
get443 6
;446 7
}448 9
public66 
FriendsViewModel66 
(66  
)66  !
{77 	
Friends88 
=88 
new88  
ObservableCollection88 .
<88. /
FriendViewModel88/ >
>88> ?
(88? @
)88@ A
;88A B
FriendRequests99 
=99 
new99   
ObservableCollection99! 5
<995 6"
FriendRequestViewModel996 L
>99L M
(99M N
)99N O
;99O P
SearchResults:: 
=:: 
new::  
ObservableCollection::  4
<::4 5
UserProfileDto::5 C
>::C D
(::D E
)::E F
;::F G
SearchCommand<< 
=<< 
new<< 
RelayCommand<<  ,
(<<, -
async<<- 2
	parameter<<3 <
=><<= ?
await<<@ E
SearchUsersAsync<<F V
(<<V W
)<<W X
,<<X Y
	parameter<<Z c
=><<d f$
CanExecuteNetworkActions<<g 
(	<< Ä
)
<<Ä Å
)
<<Å Ç
;
<<Ç É 
InviteByEmailCommand==  
===! "
new==# &
RelayCommand==' 3
(==3 4
InviteByEmail==4 A
,==A B
	parameter==C L
=>==M O$
CanExecuteNetworkActions==P h
(==h i
)==i j
)==j k
;==k l$
SendFriendRequestCommand>> $
=>>% &
new>>' *
RelayCommand>>+ 7
(>>7 8
SendFriendRequest>>8 I
,>>I J
	parameter>>K T
=>>>U W$
CanExecuteNetworkActions>>X p
(>>p q
)>>q r
)>>r s
;>>s t
SubscribeToEvents@@ 
(@@ 
)@@ 
;@@  
ifBB 
(BB $
CanExecuteNetworkActionsBB (
(BB( )
)BB) *
)BB* +
{CC '
LoadFriendsAndRequestsAsyncDD +
(DD+ ,
)DD, -
;DD- .
}EE 
elseFF 
{GG 
ConsoleHH 
.HH 
	WriteLineHH !
(HH! "
$strHH" l
)HHl m
;HHm n
}II 
}JJ 	
privateLL 
boolLL $
CanExecuteNetworkActionsLL -
(LL- .
)LL. /
{MM 	
returnNN 
ClientNN 
!=NN 
nullNN !
&&NN" $
ClientNN% +
.NN+ ,
StateNN, 1
==NN2 4
CommunicationStateNN5 G
.NNG H
OpenedNNH N
;NNN O
}OO 	
privateQQ 
asyncQQ 
TaskQQ '
LoadFriendsAndRequestsAsyncQQ 6
(QQ6 7
)QQ7 8
{RR 	
stringSS 
usernameSS 
=SS 
SessionManagerSS ,
.SS, -
InstanceSS- 5
.SS5 6
CurrentUsernameSS6 E
;SSE F
ifUU 
(UU 
stringUU 
.UU 
IsNullOrEmptyUU $
(UU$ %
usernameUU% -
)UU- .
||UU/ 1
!UU2 3$
CanExecuteNetworkActionsUU3 K
(UUK L
)UUL M
)UUM N
{VV 
ConsoleWW 
.WW 
	WriteLineWW !
(WW! "
$"WW" $
$strWW$ b
{WWb c
usernameWWc k
}WWk l
$strWWl {
{WW{ |%
CanExecuteNetworkActions	WW| î
(
WWî ï
)
WWï ñ
}
WWñ ó
"
WWó ò
)
WWò ô
;
WWô ö
returnXX 
;XX 
}YY 
try[[ 
{\\ 
var]] 
friends]] 
=]] 
await]] #
Client]]$ *
.]]* +
GetFriendsListAsync]]+ >
(]]> ?
username]]? G
)]]G H
;]]H I
Application^^ 
.^^ 
Current^^ #
.^^# $

Dispatcher^^$ .
.^^. /
Invoke^^/ 5
(^^5 6
(^^6 7
)^^7 8
=>^^9 ;
{__ 
Friends`` 
.`` 
Clear`` !
(``! "
)``" #
;``# $
ifaa 
(aa 
friendsaa 
!=aa  "
nullaa# '
)aa' (
{bb 
foreachcc 
(cc  !
varcc! $
fcc% &
incc' )
friendscc* 1
)cc1 2
{dd 
Friendsee #
.ee# $
Addee$ '
(ee' (
newee( +
FriendViewModelee, ;
{ee< =
Usernameee> F
=eeG H
feeI J
.eeJ K
UsernameeeK S
,eeS T
IsOnlineeeU ]
=ee^ _
fee` a
.eea b
IsOnlineeeb j
}eek l
)eel m
;eem n
}ff 
}gg 
}hh 
)hh 
;hh 
varjj 
requestsjj 
=jj 
awaitjj $
Clientjj% +
.jj+ ,"
GetFriendRequestsAsyncjj, B
(jjB C
usernamejjC K
)jjK L
;jjL M
Applicationkk 
.kk 
Currentkk #
.kk# $

Dispatcherkk$ .
.kk. /
Invokekk/ 5
(kk5 6
(kk6 7
)kk7 8
=>kk9 ;
{ll 
FriendRequestsmm "
.mm" #
Clearmm# (
(mm( )
)mm) *
;mm* +
ifnn 
(nn 
requestsnn  
!=nn! #
nullnn$ (
)nn( )
{oo 
foreachpp 
(pp  !
varpp! $
rpp% &
inpp' )
requestspp* 2
)pp2 3
{qq 
FriendRequestsrr *
.rr* +
Addrr+ .
(rr. /
newrr/ 2"
FriendRequestViewModelrr3 I
(rrI J
thisrrJ N
)rrN O
{rrP Q
RequesterUsernamerrR c
=rrd e
rrrf g
.rrg h
RequesterUsernamerrh y
}rrz {
)rr{ |
;rr| }
}ss 
}tt 
}uu 
)uu 
;uu 
}vv 
catchww 
(ww 
FaultExceptionww !

fexGeneralww" ,
)ww, -
{xx 

MessageBoxyy 
.yy 
Showyy 
(yy  
Langzz 
.zz  
alertFriendLoadErrorzz -
,zz- .
Lang{{ 
.{{ 
alertErrorTitle{{ (
,{{( )
MessageBoxButton|| $
.||$ %
OK||% '
,||' (
MessageBoxImage}} #
.}}# $
Error}}$ )
)}}) *
;}}* +
Console~~ 
.~~ 
	WriteLine~~ !
(~~! "
$"~~" $
$str~~$ H
{~~H I

fexGeneral~~I S
.~~S T
Message~~T [
}~~[ \
"~~\ ]
)~~] ^
;~~^ _
} 
catch
ÄÄ 
(
ÄÄ '
EndpointNotFoundException
ÄÄ ,
ex
ÄÄ- /
)
ÄÄ/ 0
{
ÅÅ 

MessageBox
ÇÇ 
.
ÇÇ 
Show
ÇÇ 
(
ÇÇ  
Lang
ÉÉ 
.
ÉÉ )
alertConnectionErrorMessage
ÉÉ 4
,
ÉÉ4 5
Lang
ÑÑ 
.
ÑÑ '
alertConnectionErrorTitle
ÑÑ 2
,
ÑÑ2 3
MessageBoxButton
ÖÖ $
.
ÖÖ$ %
OK
ÖÖ% '
,
ÖÖ' (
MessageBoxImage
ÜÜ #
.
ÜÜ# $
Error
ÜÜ$ )
)
ÜÜ) *
;
ÜÜ* +
Console
áá 
.
áá 
	WriteLine
áá !
(
áá! "
$"
áá" $
$str
áá$ O
{
ááO P
ex
ááP R
.
ááR S
Message
ááS Z
}
ááZ [
"
áá[ \
)
áá\ ]
;
áá] ^
}
àà 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ää 

MessageBox
ãã 
.
ãã 
Show
ãã 
(
ãã  
Lang
åå 
.
åå "
alertFriendLoadError
åå -
,
åå- .
Lang
çç 
.
çç 
alertErrorTitle
çç (
,
çç( )
MessageBoxButton
éé $
.
éé$ %
OK
éé% '
,
éé' (
MessageBoxImage
èè #
.
èè# $
Error
èè$ )
)
èè) *
;
èè* +
Console
êê 
.
êê 
	WriteLine
êê !
(
êê! "
$"
êê" $
$str
êê$ H
{
êêH I
ex
êêI K
.
êêK L
Message
êêL S
}
êêS T
"
êêT U
)
êêU V
;
êêV W
}
ëë 
}
íí 	
private
îî 
async
îî 
Task
îî 
SearchUsersAsync
îî +
(
îî+ ,
)
îî, -
{
ïï 	
if
ññ 
(
ññ 
string
ññ 
.
ññ  
IsNullOrWhiteSpace
ññ )
(
ññ) *

SearchText
ññ* 4
)
ññ4 5
)
ññ5 6
{
óó 
Application
òò 
.
òò 
Current
òò #
.
òò# $

Dispatcher
òò$ .
.
òò. /
Invoke
òò/ 5
(
òò5 6
(
òò6 7
)
òò7 8
=>
òò9 ;
SearchResults
òò< I
.
òòI J
Clear
òòJ O
(
òòO P
)
òòP Q
)
òòQ R
;
òòR S
return
ôô 
;
ôô 
}
öö 
if
úú 
(
úú 
!
úú &
CanExecuteNetworkActions
úú )
(
úú) *
)
úú* +
)
úú+ ,
{
ùù 
Console
ûû 
.
ûû 
	WriteLine
ûû !
(
ûû! "
$str
ûû" ]
)
ûû] ^
;
ûû^ _
return
üü 
;
üü 
}
†† 
try
¢¢ 
{
££ 
var
§§ 
users
§§ 
=
§§ 
await
§§ !
Client
§§" (
.
§§( )
SearchUsersAsync
§§) 9
(
§§9 :

SearchText
§§: D
,
§§D E
SessionManager
§§F T
.
§§T U
Instance
§§U ]
.
§§] ^
CurrentUsername
§§^ m
)
§§m n
;
§§n o
Application
•• 
.
•• 
Current
•• #
.
••# $

Dispatcher
••$ .
.
••. /
Invoke
••/ 5
(
••5 6
(
••6 7
)
••7 8
=>
••9 ;
{
¶¶ 
SearchResults
ßß !
.
ßß! "
Clear
ßß" '
(
ßß' (
)
ßß( )
;
ßß) *
if
®® 
(
®® 
users
®® 
!=
®®  
null
®®! %
)
®®% &
{
©© 
foreach
™™ 
(
™™  !
var
™™! $
u
™™% &
in
™™' )
users
™™* /
)
™™/ 0
{
´´ 
SearchResults
¨¨ )
.
¨¨) *
Add
¨¨* -
(
¨¨- .
u
¨¨. /
)
¨¨/ 0
;
¨¨0 1
}
≠≠ 
}
ÆÆ 
}
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 
catch
±± 
(
±± 
FaultException
±± !

fexGeneral
±±" ,
)
±±, -
{
≤≤ 

MessageBox
≥≥ 
.
≥≥ 
Show
≥≥ 
(
≥≥  
Lang
¥¥ 
.
¥¥ $
alertFriendSearchError
¥¥ /
,
¥¥/ 0
Lang
µµ 
.
µµ 
alertErrorTitle
µµ (
,
µµ( )
MessageBoxButton
∂∂ $
.
∂∂$ %
OK
∂∂% '
,
∂∂' (
MessageBoxImage
∑∑ #
.
∑∑# $
Error
∑∑$ )
)
∑∑) *
;
∑∑* +
Console
∏∏ 
.
∏∏ 
	WriteLine
∏∏ !
(
∏∏! "
$"
∏∏" $
$str
∏∏$ ?
{
∏∏? @

fexGeneral
∏∏@ J
.
∏∏J K
Message
∏∏K R
}
∏∏R S
"
∏∏S T
)
∏∏T U
;
∏∏U V
}
ππ 
catch
∫∫ 
(
∫∫ '
EndpointNotFoundException
∫∫ ,
ex
∫∫- /
)
∫∫/ 0
{
ªª 

MessageBox
ºº 
.
ºº 
Show
ºº 
(
ºº  
Lang
ΩΩ 
.
ΩΩ )
alertConnectionErrorMessage
ΩΩ 4
,
ΩΩ4 5
Lang
ææ 
.
ææ '
alertConnectionErrorTitle
ææ 2
,
ææ2 3
MessageBoxButton
øø $
.
øø$ %
OK
øø% '
,
øø' (
MessageBoxImage
¿¿ #
.
¿¿# $
Error
¿¿$ )
)
¿¿) *
;
¿¿* +
Console
¡¡ 
.
¡¡ 
	WriteLine
¡¡ !
(
¡¡! "
$"
¡¡" $
$str
¡¡$ F
{
¡¡F G
ex
¡¡G I
.
¡¡I J
Message
¡¡J Q
}
¡¡Q R
"
¡¡R S
)
¡¡S T
;
¡¡T U
}
¬¬ 
catch
√√ 
(
√√ 
	Exception
√√ 
ex
√√ 
)
√√  
{
ƒƒ 

MessageBox
≈≈ 
.
≈≈ 
Show
≈≈ 
(
≈≈  
Lang
∆∆ 
.
∆∆ $
alertFriendSearchError
∆∆ /
,
∆∆/ 0
Lang
«« 
.
«« 
alertErrorTitle
«« (
,
««( )
MessageBoxButton
»» $
.
»»$ %
OK
»»% '
,
»»' (
MessageBoxImage
…… #
.
……# $
Error
……$ )
)
……) *
;
……* +
Console
   
.
   
	WriteLine
   !
(
  ! "
$"
  " $
$str
  $ 3
{
  3 4
ex
  4 6
.
  6 7
Message
  7 >
}
  > ?
"
  ? @
)
  @ A
;
  A B
}
ÀÀ 
}
ÃÃ 	
private
ŒŒ 
void
ŒŒ 
SendFriendRequest
ŒŒ &
(
ŒŒ& '
object
ŒŒ' -
	parameter
ŒŒ. 7
)
ŒŒ7 8
{
œœ 	
if
–– 
(
–– 
	parameter
–– 
is
–– 
UserProfileDto
–– +
userProfile
––, 7
&&
––8 :&
CanExecuteNetworkActions
––; S
(
––S T
)
––T U
)
––U V
{
—— 
try
““ 
{
”” 
Client
‘‘ 
.
‘‘ 
SendFriendRequest
‘‘ ,
(
‘‘, -
SessionManager
‘‘- ;
.
‘‘; <
Instance
‘‘< D
.
‘‘D E
CurrentUsername
‘‘E T
,
‘‘T U
userProfile
‘‘V a
.
‘‘a b
Username
‘‘b j
)
‘‘j k
;
‘‘k l
Application
’’ 
.
’’  
Current
’’  '
.
’’' (

Dispatcher
’’( 2
.
’’2 3
Invoke
’’3 9
(
’’9 :
(
’’: ;
)
’’; <
=>
’’= ?
{
÷÷ 
SearchResults
◊◊ %
.
◊◊% &
Remove
◊◊& ,
(
◊◊, -
userProfile
◊◊- 8
)
◊◊8 9
;
◊◊9 :
}
ÿÿ 
)
ÿÿ 
;
ÿÿ 

MessageBox
ŸŸ 
.
ŸŸ 
Show
ŸŸ #
(
ŸŸ# $
string
⁄⁄ 
.
⁄⁄ 
Format
⁄⁄ %
(
⁄⁄% &
Lang
⁄⁄& *
.
⁄⁄* +$
alertFriendRequestSent
⁄⁄+ A
,
⁄⁄A B
userProfile
⁄⁄C N
.
⁄⁄N O
Username
⁄⁄O W
)
⁄⁄W X
,
⁄⁄X Y
Lang
€€ 
.
€€ 
alertSuccessTitle
€€ .
,
€€. /
MessageBoxButton
‹‹ (
.
‹‹( )
OK
‹‹) +
,
‹‹+ ,
MessageBoxImage
›› '
.
››' (
Information
››( 3
)
››3 4
;
››4 5
}
ﬁﬁ 
catch
ﬂﬂ 
(
ﬂﬂ 
FaultException
ﬂﬂ %
<
ﬂﬂ% &
string
ﬂﬂ& ,
>
ﬂﬂ, -
fex
ﬂﬂ. 1
)
ﬂﬂ1 2
{
‡‡ 

MessageBox
·· 
.
·· 
Show
·· #
(
··# $
fex
‚‚ 
.
‚‚ 
Detail
‚‚ "
,
‚‚" #
Lang
„„ 
.
„„ *
alertFriendRequestErrorTitle
„„ 9
,
„„9 :
MessageBoxButton
‰‰ (
.
‰‰( )
OK
‰‰) +
,
‰‰+ ,
MessageBoxImage
ÂÂ '
.
ÂÂ' (
Warning
ÂÂ( /
)
ÂÂ/ 0
;
ÂÂ0 1
Console
ÊÊ 
.
ÊÊ 
	WriteLine
ÊÊ %
(
ÊÊ% &
$"
ÊÊ& (
$str
ÊÊ( ?
{
ÊÊ? @
fex
ÊÊ@ C
.
ÊÊC D
Detail
ÊÊD J
}
ÊÊJ K
"
ÊÊK L
)
ÊÊL M
;
ÊÊM N
}
ÁÁ 
catch
ËË 
(
ËË $
CommunicationException
ËË -
commEx
ËË. 4
)
ËË4 5
{
ÈÈ 

MessageBox
ÍÍ 
.
ÍÍ 
Show
ÍÍ #
(
ÍÍ# $
Lang
ÎÎ 
.
ÎÎ )
alertFriendRequestSendError
ÎÎ 8
,
ÎÎ8 9
Lang
ÏÏ 
.
ÏÏ *
alertFriendRequestErrorTitle
ÏÏ 9
,
ÏÏ9 :
MessageBoxButton
ÌÌ (
.
ÌÌ( )
OK
ÌÌ) +
,
ÌÌ+ ,
MessageBoxImage
ÓÓ '
.
ÓÓ' (
Error
ÓÓ( -
)
ÓÓ- .
;
ÓÓ. /
Console
ÔÔ 
.
ÔÔ 
	WriteLine
ÔÔ %
(
ÔÔ% &
$"
ÔÔ& (
$str
ÔÔ( M
{
ÔÔM N
commEx
ÔÔN T
.
ÔÔT U
Message
ÔÔU \
}
ÔÔ\ ]
"
ÔÔ] ^
)
ÔÔ^ _
;
ÔÔ_ `
}
 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ  
ex
ÒÒ! #
)
ÒÒ# $
{
ÚÚ 

MessageBox
ÛÛ 
.
ÛÛ 
Show
ÛÛ #
(
ÛÛ# $
Lang
ÙÙ 
.
ÙÙ )
alertFriendRequestSendError
ÙÙ 8
,
ÙÙ8 9
Lang
ıı 
.
ıı *
alertFriendRequestErrorTitle
ıı 9
,
ıı9 :
MessageBoxButton
ˆˆ (
.
ˆˆ( )
OK
ˆˆ) +
,
ˆˆ+ ,
MessageBoxImage
˜˜ '
.
˜˜' (
Error
˜˜( -
)
˜˜- .
;
˜˜. /
Console
¯¯ 
.
¯¯ 
	WriteLine
¯¯ %
(
¯¯% &
$"
¯¯& (
$str
¯¯( @
{
¯¯@ A
ex
¯¯A C
.
¯¯C D
Message
¯¯D K
}
¯¯K L
"
¯¯L M
)
¯¯M N
;
¯¯N O
}
˘˘ 
}
˙˙ 
else
˚˚ 
if
˚˚ 
(
˚˚ 
!
˚˚ 
(
˚˚ 
	parameter
˚˚  
is
˚˚! #
UserProfileDto
˚˚$ 2
)
˚˚2 3
)
˚˚3 4
{
¸¸ 
Console
˝˝ 
.
˝˝ 
	WriteLine
˝˝ !
(
˝˝! "
$str
˝˝" J
)
˝˝J K
;
˝˝K L
}
˛˛ 
else
ˇˇ 
if
ˇˇ 
(
ˇˇ 
!
ˇˇ &
CanExecuteNetworkActions
ˇˇ .
(
ˇˇ. /
)
ˇˇ/ 0
)
ˇˇ0 1
{
ÄÄ 
Console
ÅÅ 
.
ÅÅ 
	WriteLine
ÅÅ !
(
ÅÅ! "
$str
ÅÅ" ^
)
ÅÅ^ _
;
ÅÅ_ `
}
ÇÇ 
}
ÉÉ 	
public
ÖÖ 
void
ÖÖ 
RespondToRequest
ÖÖ $
(
ÖÖ$ %
string
ÖÖ% +
requesterUsername
ÖÖ, =
,
ÖÖ= >
bool
ÖÖ? C
accepted
ÖÖD L
)
ÖÖL M
{
ÜÜ 	
if
áá 
(
áá 
!
áá &
CanExecuteNetworkActions
áá )
(
áá) *
)
áá* +
)
áá+ ,
{
àà 
Console
ââ 
.
ââ 
	WriteLine
ââ !
(
ââ! "
$str
ââ" ]
)
ââ] ^
;
ââ^ _
return
ää 
;
ää 
}
ãã 
try
åå 
{
çç 
Client
éé 
.
éé $
RespondToFriendRequest
éé -
(
éé- .
SessionManager
éé. <
.
éé< =
Instance
éé= E
.
ééE F
CurrentUsername
ééF U
,
ééU V
requesterUsername
ééW h
,
ééh i
accepted
ééj r
)
éér s
;
éés t
Application
èè 
.
èè 
Current
èè #
.
èè# $

Dispatcher
èè$ .
.
èè. /
Invoke
èè/ 5
(
èè5 6
(
èè6 7
)
èè7 8
=>
èè9 ;
{
êê 
var
ëë 
	requestVM
ëë !
=
ëë" #
FriendRequests
ëë$ 2
.
ëë2 3
FirstOrDefault
ëë3 A
(
ëëA B
r
ëëB C
=>
ëëD F
r
ëëG H
.
ëëH I
RequesterUsername
ëëI Z
==
ëë[ ]
requesterUsername
ëë^ o
)
ëëo p
;
ëëp q
if
íí 
(
íí 
	requestVM
íí !
!=
íí" $
null
íí% )
)
íí) *
{
ìì 
FriendRequests
îî &
.
îî& '
Remove
îî' -
(
îî- .
	requestVM
îî. 7
)
îî7 8
;
îî8 9
}
ïï 
if
ññ 
(
ññ 
accepted
ññ  
&&
ññ! #
!
ññ$ %
Friends
ññ% ,
.
ññ, -
Any
ññ- 0
(
ññ0 1
f
ññ1 2
=>
ññ3 5
f
ññ6 7
.
ññ7 8
Username
ññ8 @
==
ññA C
requesterUsername
ññD U
)
ññU V
)
ññV W
{
óó 
Friends
òò 
.
òò  
Add
òò  #
(
òò# $
new
òò$ '
FriendViewModel
òò( 7
{
òò8 9
Username
òò: B
=
òòC D
requesterUsername
òòE V
,
òòV W
IsOnline
òòX `
=
òòa b
false
òòc h
}
òòi j
)
òòj k
;
òòk l
}
ôô 
}
öö 
)
öö 
;
öö 
}
õõ 
catch
úú 
(
úú $
CommunicationException
úú )
commEx
úú* 0
)
úú0 1
{
ùù 

MessageBox
ûû 
.
ûû 
Show
ûû 
(
ûû  
Lang
üü 
.
üü &
alertFriendResponseError
üü 1
,
üü1 2
Lang
†† 
.
†† 
alertErrorTitle
†† (
,
††( )
MessageBoxButton
°° $
.
°°$ %
OK
°°% '
,
°°' (
MessageBoxImage
¢¢ #
.
¢¢# $
Error
¢¢$ )
)
¢¢) *
;
¢¢* +
Console
££ 
.
££ 
	WriteLine
££ !
(
££! "
$"
££" $
$str
££$ O
{
££O P
commEx
££P V
.
££V W
Message
££W ^
}
££^ _
"
££_ `
)
££` a
;
££a b
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
¶¶ 

MessageBox
ßß 
.
ßß 
Show
ßß 
(
ßß  
Lang
®® 
.
®® &
alertFriendResponseError
®® 1
,
®®1 2
Lang
©© 
.
©© 
alertErrorTitle
©© (
,
©©( )
MessageBoxButton
™™ $
.
™™$ %
OK
™™% '
,
™™' (
MessageBoxImage
´´ #
.
´´# $
Error
´´$ )
)
´´) *
;
´´* +
Console
¨¨ 
.
¨¨ 
	WriteLine
¨¨ !
(
¨¨! "
$"
¨¨" $
$str
¨¨$ 7
{
¨¨7 8
ex
¨¨8 :
.
¨¨: ;
Message
¨¨; B
}
¨¨B C
"
¨¨C D
)
¨¨D E
;
¨¨E F
}
≠≠ 
}
ÆÆ 	
private
∞∞ 
void
∞∞ 
InviteByEmail
∞∞ "
(
∞∞" #
object
∞∞# )
obj
∞∞* -
)
∞∞- .
{
±± 	
}
≥≥ 	
private
µµ 
void
µµ 
SubscribeToEvents
µµ &
(
µµ& '
)
µµ' (
{
∂∂ 	!
SocialClientManager
∑∑ 
.
∑∑  
Instance
∑∑  (
.
∑∑( )
OnFriendRequest
∑∑) 8
+=
∑∑9 ;!
HandleFriendRequest
∑∑< O
;
∑∑O P!
SocialClientManager
∏∏ 
.
∏∏  
Instance
∏∏  (
.
∏∏( )
OnFriendResponse
∏∏) 9
+=
∏∏: <"
HandleFriendResponse
∏∏= Q
;
∏∏Q R!
SocialClientManager
ππ 
.
ππ  
Instance
ππ  (
.
ππ( )#
OnFriendStatusChanged
ππ) >
+=
ππ? A'
HandleFriendStatusChanged
ππB [
;
ππ[ \
Console
∫∫ 
.
∫∫ 
	WriteLine
∫∫ 
(
∫∫ 
$str
∫∫ P
)
∫∫P Q
;
∫∫Q R
}
ªª 	
private
ΩΩ 
void
ΩΩ #
UnsubscribeFromEvents
ΩΩ *
(
ΩΩ* +
)
ΩΩ+ ,
{
ææ 	!
SocialClientManager
øø 
.
øø  
Instance
øø  (
.
øø( )
OnFriendRequest
øø) 8
-=
øø9 ;!
HandleFriendRequest
øø< O
;
øøO P!
SocialClientManager
¿¿ 
.
¿¿  
Instance
¿¿  (
.
¿¿( )
OnFriendResponse
¿¿) 9
-=
¿¿: <"
HandleFriendResponse
¿¿= Q
;
¿¿Q R!
SocialClientManager
¡¡ 
.
¡¡  
Instance
¡¡  (
.
¡¡( )#
OnFriendStatusChanged
¡¡) >
-=
¡¡? A'
HandleFriendStatusChanged
¡¡B [
;
¡¡[ \
Console
¬¬ 
.
¬¬ 
	WriteLine
¬¬ 
(
¬¬ 
$str
¬¬ S
)
¬¬S T
;
¬¬T U
}
√√ 	
public
≈≈ 
void
≈≈ 
Dispose
≈≈ 
(
≈≈ 
)
≈≈ 
{
∆∆ 	
Dispose
«« 
(
«« 
true
«« 
)
«« 
;
«« 
GC
»» 
.
»» 
SuppressFinalize
»» 
(
»»  
this
»»  $
)
»»$ %
;
»»% &
}
…… 	
	protected
ÀÀ 
virtual
ÀÀ 
void
ÀÀ 
Dispose
ÀÀ &
(
ÀÀ& '
bool
ÀÀ' +
	disposing
ÀÀ, 5
)
ÀÀ5 6
{
ÃÃ 	
if
ÕÕ 
(
ÕÕ 
	disposing
ÕÕ 
)
ÕÕ 
{
ŒŒ #
UnsubscribeFromEvents
œœ %
(
œœ% &
)
œœ& '
;
œœ' (
}
–– 
}
—— 	
public
”” 
void
”” 
Cleanup
”” 
(
”” 
)
”” 
{
‘‘ 	
Dispose
’’ 
(
’’ 
)
’’ 
;
’’ 
}
÷÷ 	
private
ÿÿ 
void
ÿÿ !
HandleFriendRequest
ÿÿ (
(
ÿÿ( )
string
ÿÿ) /
fromUsername
ÿÿ0 <
)
ÿÿ< =
{
ŸŸ 	
Application
⁄⁄ 
.
⁄⁄ 
Current
⁄⁄ 
.
⁄⁄  

Dispatcher
⁄⁄  *
.
⁄⁄* +
Invoke
⁄⁄+ 1
(
⁄⁄1 2
(
⁄⁄2 3
)
⁄⁄3 4
=>
⁄⁄5 7
{
€€ 

MessageBox
‹‹ 
.
‹‹ 
Show
‹‹ 
(
‹‹  
string
›› 
.
›› 
Format
›› !
(
››! "
Lang
››" &
.
››& ''
alertFriendNewRequestFrom
››' @
,
››@ A
fromUsername
››B N
)
››N O
,
››O P
Lang
ﬁﬁ 
.
ﬁﬁ (
alertFriendNewRequestTitle
ﬁﬁ 3
,
ﬁﬁ3 4
MessageBoxButton
ﬂﬂ $
.
ﬂﬂ$ %
OK
ﬂﬂ% '
,
ﬂﬂ' (
MessageBoxImage
‡‡ #
.
‡‡# $
Information
‡‡$ /
)
‡‡/ 0
;
‡‡0 1
if
‚‚ 
(
‚‚ 
!
‚‚ 
FriendRequests
‚‚ #
.
‚‚# $
Any
‚‚$ '
(
‚‚' (
r
‚‚( )
=>
‚‚* ,
r
‚‚- .
.
‚‚. /
RequesterUsername
‚‚/ @
==
‚‚A C
fromUsername
‚‚D P
)
‚‚P Q
)
‚‚Q R
{
„„ 
FriendRequests
‰‰ "
.
‰‰" #
Add
‰‰# &
(
‰‰& '
new
‰‰' *$
FriendRequestViewModel
‰‰+ A
(
‰‰A B
this
‰‰B F
)
‰‰F G
{
‰‰H I
RequesterUsername
‰‰J [
=
‰‰\ ]
fromUsername
‰‰^ j
}
‰‰k l
)
‰‰l m
;
‰‰m n
}
ÂÂ 
}
ÊÊ 
)
ÊÊ 
;
ÊÊ 
}
ÁÁ 	
private
ÈÈ 
void
ÈÈ "
HandleFriendResponse
ÈÈ )
(
ÈÈ) *
string
ÈÈ* 0 
respondingUsername
ÈÈ1 C
,
ÈÈC D
bool
ÈÈE I
accepted
ÈÈJ R
)
ÈÈR S
{
ÍÍ 	
Application
ÎÎ 
.
ÎÎ 
Current
ÎÎ 
.
ÎÎ  

Dispatcher
ÎÎ  *
.
ÎÎ* +
Invoke
ÎÎ+ 1
(
ÎÎ1 2
(
ÎÎ2 3
)
ÎÎ3 4
=>
ÎÎ5 7
{
ÏÏ 
string
ÌÌ 
message
ÌÌ 
=
ÌÌ  
accepted
ÌÌ! )
?
ÓÓ 
string
ÓÓ 
.
ÓÓ 
Format
ÓÓ #
(
ÓÓ# $
Lang
ÓÓ$ (
.
ÓÓ( )(
alertFriendRequestAccepted
ÓÓ) C
,
ÓÓC D 
respondingUsername
ÓÓE W
)
ÓÓW X
:
ÔÔ 
string
ÔÔ 
.
ÔÔ 
Format
ÔÔ #
(
ÔÔ# $
Lang
ÔÔ$ (
.
ÔÔ( )(
alertFriendRequestDeclined
ÔÔ) C
,
ÔÔC D 
respondingUsername
ÔÔE W
)
ÔÔW X
;
ÔÔX Y

MessageBox
ÒÒ 
.
ÒÒ 
Show
ÒÒ 
(
ÒÒ  
message
ÚÚ 
,
ÚÚ 
Lang
ÛÛ 
.
ÛÛ -
alertFriendRequestResponseTitle
ÛÛ 8
,
ÛÛ8 9
MessageBoxButton
ÙÙ $
.
ÙÙ$ %
OK
ÙÙ% '
,
ÙÙ' (
MessageBoxImage
ıı #
.
ıı# $
Information
ıı$ /
)
ıı/ 0
;
ıı0 1
if
˜˜ 
(
˜˜ 
accepted
˜˜ 
&&
˜˜ 
!
˜˜  !
Friends
˜˜! (
.
˜˜( )
Any
˜˜) ,
(
˜˜, -
f
˜˜- .
=>
˜˜/ 1
f
˜˜2 3
.
˜˜3 4
Username
˜˜4 <
==
˜˜= ? 
respondingUsername
˜˜@ R
)
˜˜R S
)
˜˜S T
{
¯¯ 
Friends
˘˘ 
.
˘˘ 
Add
˘˘ 
(
˘˘  
new
˘˘  #
FriendViewModel
˘˘$ 3
{
˘˘4 5
Username
˘˘6 >
=
˘˘? @ 
respondingUsername
˘˘A S
,
˘˘S T
IsOnline
˘˘U ]
=
˘˘^ _
false
˘˘` e
}
˘˘f g
)
˘˘g h
;
˘˘h i
}
˙˙ 
}
˚˚ 
)
˚˚ 
;
˚˚ 
}
¸¸ 	
private
˛˛ 
void
˛˛ '
HandleFriendStatusChanged
˛˛ .
(
˛˛. /
string
˛˛/ 5
friendUsername
˛˛6 D
,
˛˛D E
string
˛˛F L
status
˛˛M S
)
˛˛S T
{
ˇˇ 	
Application
ÄÄ 
.
ÄÄ 
Current
ÄÄ 
.
ÄÄ  

Dispatcher
ÄÄ  *
.
ÄÄ* +
Invoke
ÄÄ+ 1
(
ÄÄ1 2
(
ÄÄ2 3
)
ÄÄ3 4
=>
ÄÄ5 7
{
ÅÅ 
var
ÇÇ 
friend
ÇÇ 
=
ÇÇ 
Friends
ÇÇ $
.
ÇÇ$ %
FirstOrDefault
ÇÇ% 3
(
ÇÇ3 4
f
ÇÇ4 5
=>
ÇÇ6 8
f
ÇÇ9 :
.
ÇÇ: ;
Username
ÇÇ; C
==
ÇÇD F
friendUsername
ÇÇG U
)
ÇÇU V
;
ÇÇV W
if
ÉÉ 
(
ÉÉ 
friend
ÉÉ 
!=
ÉÉ 
null
ÉÉ "
)
ÉÉ" #
{
ÑÑ 
bool
ÖÖ 
isOnline
ÖÖ !
=
ÖÖ" #
(
ÖÖ$ %
status
ÖÖ% +
==
ÖÖ, .
$str
ÖÖ/ 7
)
ÖÖ7 8
;
ÖÖ8 9
if
ÜÜ 
(
ÜÜ 
friend
ÜÜ 
.
ÜÜ 
IsOnline
ÜÜ '
!=
ÜÜ( *
isOnline
ÜÜ+ 3
)
ÜÜ3 4
{
áá 
friend
àà 
.
àà 
IsOnline
àà '
=
àà( )
isOnline
àà* 2
;
àà2 3
Console
ââ 
.
ââ  
	WriteLine
ââ  )
(
ââ) *
$"
ââ* ,
$str
ââ, 6
{
ââ6 7
friendUsername
ââ7 E
}
ââE F
$str
ââF U
{
ââU V
status
ââV \
}
ââ\ ]
$str
ââ] r
"
ââr s
)
ââs t
;
âât u
}
ää 
}
ãã 
else
åå 
{
çç 
Console
éé 
.
éé 
	WriteLine
éé %
(
éé% &
$"
éé& (
$str
éé( >
{
éé> ?
friendUsername
éé? M
}
ééM N
$str
ééN x
"
ééx y
)
ééy z
;
ééz {
}
èè 
}
êê 
)
êê 
;
êê 
}
ëë 	
~
ìì 	
FriendsViewModel
ìì	 
(
ìì 
)
ìì 
{
îî 	
Dispose
ïï 
(
ïï 
false
ïï 
)
ïï 
;
ïï 
}
ññ 	
}
óó 
public
ôô 

class
ôô 
FriendViewModel
ôô  
:
ôô! "
ViewModelBase
ôô# 0
{
öö 
public
õõ 
string
õõ 
Username
õõ 
{
õõ  
get
õõ! $
;
õõ$ %
set
õõ& )
;
õõ) *
}
õõ+ ,
private
ùù 
bool
ùù 
	_isOnline
ùù 
;
ùù 
public
ûû 
bool
ûû 
IsOnline
ûû 
{
üü 	
get
†† 
{
†† 
return
†† 
	_isOnline
†† "
;
††" #
}
††$ %
set
°° 
{
¢¢ 
if
££ 
(
££ 
	_isOnline
££ 
!=
££  
value
££! &
)
££& '
{
§§ 
	_isOnline
•• 
=
•• 
value
••  %
;
••% &
OnPropertyChanged
¶¶ %
(
¶¶% &
)
¶¶& '
;
¶¶' (
}
ßß 
}
®® 
}
©© 	
}
™™ 
public
¨¨ 

class
¨¨ $
FriendRequestViewModel
¨¨ '
:
¨¨( )
ViewModelBase
¨¨* 7
{
≠≠ 
private
ÆÆ 
readonly
ÆÆ 
FriendsViewModel
ÆÆ )
_parent
ÆÆ* 1
;
ÆÆ1 2
public
ØØ 
string
ØØ 
RequesterUsername
ØØ '
{
ØØ( )
get
ØØ* -
;
ØØ- .
set
ØØ/ 2
;
ØØ2 3
}
ØØ4 5
public
±± 
ICommand
±± 
AcceptCommand
±± %
{
±±& '
get
±±( +
;
±±+ ,
}
±±- .
public
≤≤ 
ICommand
≤≤ 
DeclineCommand
≤≤ &
{
≤≤' (
get
≤≤) ,
;
≤≤, -
}
≤≤. /
public
¥¥ $
FriendRequestViewModel
¥¥ %
(
¥¥% &
FriendsViewModel
¥¥& 6
parent
¥¥7 =
)
¥¥= >
{
µµ 	
_parent
∂∂ 
=
∂∂ 
parent
∂∂ 
??
∂∂ 
throw
∂∂  %
new
∂∂& )#
ArgumentNullException
∂∂* ?
(
∂∂? @
nameof
∂∂@ F
(
∂∂F G
parent
∂∂G M
)
∂∂M N
)
∂∂N O
;
∂∂O P
AcceptCommand
∑∑ 
=
∑∑ 
new
∑∑ 
RelayCommand
∑∑  ,
(
∑∑, -
	parameter
∑∑- 6
=>
∑∑7 9
_parent
∑∑: A
.
∑∑A B
RespondToRequest
∑∑B R
(
∑∑R S
RequesterUsername
∑∑S d
,
∑∑d e
true
∑∑f j
)
∑∑j k
)
∑∑k l
;
∑∑l m
DeclineCommand
∏∏ 
=
∏∏ 
new
∏∏  
RelayCommand
∏∏! -
(
∏∏- .
	parameter
∏∏. 7
=>
∏∏8 :
_parent
∏∏; B
.
∏∏B C
RespondToRequest
∏∏C S
(
∏∏S T
RequesterUsername
∏∏T e
,
∏∏e f
false
∏∏g l
)
∏∏l m
)
∏∏m n
;
∏∏n o
}
ππ 	
}
∫∫ 
}ªª Üe
ØC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\Dialogs\VerifyChangesByCodeViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
.+ ,
Dialogs, 3
{ 
internal 
class (
VerifyChangesByCodeViewModel /
:0 1
ViewModelBase2 ?
{ 
public 
enum 
VerificationMode $
{% &
Email' ,
,, -
Password. 6
}7 8
private 
readonly 
VerificationMode )
_mode* /
;/ 0
private 
readonly 
string 
	_username  )
;) *
private 
readonly 
string 
_payload  (
;( )
private 
readonly 
Action 
<  
string  &
>& ' 
_emailUpdateCallback( <
;< =
private 
string 
_verificationCode (
;( )
public 
string 
VerificationCode &
{ 	
get 
{ 
return 
_verificationCode (
;( )
} 
set 
{ 
if 
( 
_verificationCode %
!=& (
value) .
). /
{ 
_verificationCode   %
=  & '
value  ( -
;  - .
OnPropertyChanged!! %
(!!% &
)!!& '
;!!' (
}"" 
}## 
}$$ 	
public&& 
ICommand&& 
VerifyCommand&& %
{&&& '
get&&( +
;&&+ ,
}&&- .
public'' 
ICommand'' 
CloseCommand'' $
{''% &
get''' *
;''* +
}'', -
private)) 
static)) 
bool)) 
IsValidEmail)) (
())( )
string))) /
email))0 5
)))5 6
{** 	
if++ 
(++ 
string++ 
.++ 
IsNullOrWhiteSpace++ )
(++) *
email++* /
)++/ 0
)++0 1
{,, 
return-- 
false-- 
;-- 
}.. 
try// 
{00 
var11 
regex11 
=11 
new11 
Regex11  %
(11% &
$str11& H
,11H I
RegexOptions11J V
.11V W

IgnoreCase11W a
,11a b
TimeSpan11c k
.11k l
FromMilliseconds11l |
(11| }
$num	11} Ä
)
11Ä Å
)
11Å Ç
;
11Ç É
return22 
regex22 
.22 
IsMatch22 $
(22$ %
email22% *
)22* +
;22+ ,
}33 
catch44 
(44 &
RegexMatchTimeoutException44 -
)44- .
{55 
return66 
false66 
;66 
}77 
}88 	
public:: (
VerifyChangesByCodeViewModel:: +
(::+ ,
VerificationMode::, <
mode::= A
,::A B
string::C I
username::J R
,::R S
string::T Z
payload::[ b
,::b c
Action::d j
<::j k
string::k q
>::q r 
emailUpdateCallback	::s Ü
)
::Ü á
{;; 	
if<< 
(<< 
string<< 
.<< 
IsNullOrWhiteSpace<< )
(<<) *
username<<* 2
)<<2 3
)<<3 4
{== 
throw>> 
new>> !
ArgumentNullException>> /
(>>/ 0
nameof>>0 6
(>>6 7
username>>7 ?
)>>? @
)>>@ A
;>>A B
}?? 
if@@ 
(@@ 
string@@ 
.@@ 
IsNullOrWhiteSpace@@ )
(@@) *
payload@@* 1
)@@1 2
)@@2 3
{AA 
throwBB 
newBB !
ArgumentNullExceptionBB /
(BB/ 0
nameofBB0 6
(BB6 7
payloadBB7 >
)BB> ?
)BB? @
;BB@ A
}CC 
ifDD 
(DD 
modeDD 
==DD 
VerificationModeDD (
.DD( )
EmailDD) .
&&DD/ 1
emailUpdateCallbackDD2 E
==DDF H
nullDDI M
)DDM N
{EE 
ConsoleFF 
.FF 
	WriteLineFF !
(FF! "
$strFF" x
)FFx y
;FFy z
}GG 
ifHH 
(HH 
modeHH 
==HH 
VerificationModeHH (
.HH( )
EmailHH) .
&&HH/ 1
!HH2 3
IsValidEmailHH3 ?
(HH? @
payloadHH@ G
)HHG H
)HHH I
{II 
throwJJ 
newJJ 
ArgumentExceptionJJ +
(JJ+ ,
$strJJ, o
,JJo p
nameofJJq w
(JJw x
payloadJJx 
)	JJ Ä
)
JJÄ Å
;
JJÅ Ç
}KK 
_modeMM 
=MM 
modeMM 
;MM 
	_usernameNN 
=NN 
usernameNN  
;NN  !
_payloadOO 
=OO 
payloadOO 
;OO  
_emailUpdateCallbackPP  
=PP! "
emailUpdateCallbackPP# 6
;PP6 7
VerifyCommandRR 
=RR 
newRR 
RelayCommandRR  ,
(RR, -
ExecuteVerifyRR- :
,RR: ;
CanExecuteVerifyRR< L
)RRL M
;RRM N
CloseCommandSS 
=SS 
newSS 
RelayCommandSS +
(SS+ ,
ExecuteCloseSS, 8
)SS8 9
;SS9 :
}TT 	
privateVV 
boolVV 
CanExecuteVerifyVV %
(VV% &
objectVV& ,
objVV- 0
)VV0 1
{WW 	
returnXX 
!XX 
stringXX 
.XX 
IsNullOrWhiteSpaceXX -
(XX- .
VerificationCodeXX. >
)XX> ?
&&XX@ B
VerificationCodeYY #
.YY# $
LengthYY$ *
==YY+ -
$numYY. /
&&YY0 2
VerificationCodeZZ #
.ZZ# $
AllZZ$ '
(ZZ' (
charZZ( ,
.ZZ, -
IsDigitZZ- 4
)ZZ4 5
;ZZ5 6
}[[ 	
private]] 
async]] 
void]] 
ExecuteVerify]] (
(]]( )
object]]) /
	parameter]]0 9
)]]9 :
{^^ 	
if__ 
(__ 
!__ 
CanExecuteVerify__ !
(__! "
null__" &
)__& '
)__' (
{`` 

MessageBoxaa 
.aa 
Showaa 
(aa  
Langbb 
.bb "
alertInvalidCodeFormatbb /
,bb/ 0
Langcc 
.cc !
alertInvalidCodeTitlecc .
,cc. /
MessageBoxButtondd $
.dd$ %
OKdd% '
,dd' (
MessageBoxImageee #
.ee# $
Warningee$ +
)ee+ ,
;ee, -
returnff 
;ff 
}gg 
tryii 
{jj 
usingkk 
(kk 
varkk 
clientkk !
=kk" #
newkk$ '$
UserProfileServiceClientkk( @
(kk@ A
)kkA B
)kkB C
{ll 
OperationResultDtomm &
resultmm' -
;mm- .
ifoo 
(oo 
_modeoo 
==oo  
VerificationModeoo! 1
.oo1 2
Emailoo2 7
)oo7 8
{pp 
resultqq 
=qq  
awaitqq! &
clientqq' -
.qq- .#
ConfirmChangeEmailAsyncqq. E
(qqE F
	_usernameqqF O
,qqO P
VerificationCodeqqQ a
)qqa b
;qqb c
ifrr 
(rr 
resultrr "
.rr" #
Successrr# *
)rr* +
{ss  
_emailUpdateCallbacktt 0
?tt0 1
.tt1 2
Invokett2 8
(tt8 9
_payloadtt9 A
)ttA B
;ttB C
}uu 
}vv 
elseww 
{xx 
resultyy 
=yy  
awaityy! &
clientyy' -
.yy- .&
ConfirmChangePasswordAsyncyy. H
(yyH I
	_usernameyyI R
,yyR S
_payloadyyT \
,yy\ ]
VerificationCodeyy^ n
)yyn o
;yyo p
}zz 
if|| 
(|| 
result|| 
.|| 
Success|| &
)||& '
{}} 

MessageBox~~ "
.~~" #
Show~~# '
(~~' (
result "
." #
Message# *
,* +
Lang
ÄÄ  
.
ÄÄ  !
alertSuccessTitle
ÄÄ! 2
,
ÄÄ2 3
MessageBoxButton
ÅÅ ,
.
ÅÅ, -
OK
ÅÅ- /
,
ÅÅ/ 0
MessageBoxImage
ÇÇ +
.
ÇÇ+ ,
Information
ÇÇ, 7
)
ÇÇ7 8
;
ÇÇ8 9
ExecuteClose
ÉÉ $
(
ÉÉ$ %
	parameter
ÉÉ% .
)
ÉÉ. /
;
ÉÉ/ 0
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 

MessageBox
áá "
.
áá" #
Show
áá# '
(
áá' (
result
àà "
.
àà" #
Message
àà# *
,
àà* +
Lang
ââ  
.
ââ  !)
alertVerificationErrorTitle
ââ! <
,
ââ< =
MessageBoxButton
ää ,
.
ää, -
OK
ää- /
,
ää/ 0
MessageBoxImage
ãã +
.
ãã+ ,
Warning
ãã, 3
)
ãã3 4
;
ãã4 5
}
åå 
}
çç 
}
éé 
catch
èè 
(
èè 
FaultException
èè !

fexGeneral
èè" ,
)
èè, -
{
êê 

MessageBox
ëë 
.
ëë 
Show
ëë 
(
ëë  
Lang
íí 
.
íí %
alertServerErrorMessage
íí 0
,
íí0 1
Lang
ìì 
.
ìì 
alertErrorTitle
ìì (
,
ìì( )
MessageBoxButton
îî $
.
îî$ %
OK
îî% '
,
îî' (
MessageBoxImage
ïï #
.
ïï# $
Error
ïï$ )
)
ïï) *
;
ïï* +
Console
ññ 
.
ññ 
	WriteLine
ññ !
(
ññ! "
$"
ññ" $
$str
ññ$ J
{
ññJ K

fexGeneral
ññK U
.
ññU V
Message
ññV ]
}
ññ] ^
"
ññ^ _
)
ññ_ `
;
ññ` a
}
óó 
catch
òò 
(
òò '
EndpointNotFoundException
òò ,
ex
òò- /
)
òò/ 0
{
ôô 

MessageBox
öö 
.
öö 
Show
öö 
(
öö  
Lang
õõ 
.
õõ )
alertConnectionErrorMessage
õõ 4
,
õõ4 5
Lang
úú 
.
úú '
alertConnectionErrorTitle
úú 2
,
úú2 3
MessageBoxButton
ùù $
.
ùù$ %
OK
ùù% '
,
ùù' (
MessageBoxImage
ûû #
.
ûû# $
Error
ûû$ )
)
ûû) *
;
ûû* +
Console
üü 
.
üü 
	WriteLine
üü !
(
üü! "
$"
üü" $
$str
üü$ Q
{
üüQ R
ex
üüR T
.
üüT U
Message
üüU \
}
üü\ ]
"
üü] ^
)
üü^ _
;
üü_ `
}
†† 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
¢¢ 

MessageBox
££ 
.
££ 
Show
££ 
(
££  
Lang
§§ 
.
§§ &
alertUnknownErrorMessage
§§ 1
,
§§1 2
Lang
•• 
.
•• 
alertErrorTitle
•• (
,
••( )
MessageBoxButton
¶¶ $
.
¶¶$ %
OK
¶¶% '
,
¶¶' (
MessageBoxImage
ßß #
.
ßß# $
Error
ßß$ )
)
ßß) *
;
ßß* +
Console
®® 
.
®® 
	WriteLine
®® !
(
®®! "
$"
®®" $
$str
®®$ N
{
®®N O
ex
®®O Q
.
®®Q R
Message
®®R Y
}
®®Y Z
"
®®Z [
)
®®[ \
;
®®\ ]
}
©© 
}
™™ 	
private
¨¨ 
static
¨¨ 
void
¨¨ 
ExecuteClose
¨¨ (
(
¨¨( )
object
¨¨) /
	parameter
¨¨0 9
)
¨¨9 :
{
≠≠ 	
if
ÆÆ 
(
ÆÆ 
	parameter
ÆÆ 
is
ÆÆ 
Window
ÆÆ #
window
ÆÆ$ *
)
ÆÆ* +
{
ØØ 
window
∞∞ 
.
∞∞ 
Close
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
}
±± 
}
≤≤ 	
}
≥≥ 
}¥¥ ﬁk
ùC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\HomePages\LoginViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
	HomePages& /
{ 
public 

class 
LoginViewModel 
:  !
ViewModelBase" /
{ 
private 
string 
_usernameOrEmail '
;' (
public 
string 
UsernameOrEmail %
{ 	
get 
=> 
_usernameOrEmail #
;# $
set 
{ 
_usernameOrEmail  
=! "
value# (
;( )
OnPropertyChanged !
(! "
)" #
;# $
} 
} 	
private 
string 
	_password  
;  !
public 
string 
Password 
{   	
get!! 
=>!! 
	_password!! 
;!! 
set"" 
{## 
	_password$$ 
=$$ 
value$$ !
;$$! "
OnPropertyChanged%% !
(%%! "
)%%" #
;%%# $
CommandManager&& 
.&& &
InvalidateRequerySuggested&& 9
(&&9 :
)&&: ;
;&&; <
}'' 
}(( 	
public** 
ICommand** 
LoginCommand** $
{**% &
get**' *
;*** +
}**, -
public++ 
ICommand++ 
CloseWindowCommand++ *
{+++ ,
get++- 0
;++0 1
}++2 3
public,, 
ICommand,, !
MaximizeWindowCommand,, -
{,,. /
get,,0 3
;,,3 4
},,5 6
public-- 
ICommand-- !
MinimizeWindowCommand-- -
{--. /
get--0 3
;--3 4
}--5 6
public.. 
ICommand.. 
ReturnCommand.. %
{..& '
get..( +
;..+ ,
}..- .
public00 
LoginViewModel00 
(00 
)00 
{11 	
LoginCommand22 
=22 
new22 
RelayCommand22 +
(22+ ,
ExecuteLogin22, 8
,228 9
CanExecuteLogin22: I
)22I J
;22J K
CloseWindowCommand33 
=33  
new33! $
RelayCommand33% 1
(331 2
ExecuteCloseWindow332 D
)33D E
;33E F!
MaximizeWindowCommand44 !
=44" #
new44$ '
RelayCommand44( 4
(444 5!
ExecuteMaximizeWindow445 J
)44J K
;44K L!
MinimizeWindowCommand55 !
=55" #
new55$ '
RelayCommand55( 4
(554 5!
ExecuteMinimizeWindow555 J
)55J K
;55K L
ReturnCommand66 
=66 
new66 
RelayCommand66  ,
(66, -
ExecuteReturn66- :
)66: ;
;66; <
}77 	
private99 
bool99 
CanExecuteLogin99 $
(99$ %
object99% +
	parameter99, 5
)995 6
{:: 	
return;; 
!;; 
string;; 
.;; 
IsNullOrWhiteSpace;; -
(;;- .
UsernameOrEmail;;. =
);;= >
&&;;? A
!<< 
string<< 
.<< 
IsNullOrWhiteSpace<< -
(<<- .
Password<<. 6
)<<6 7
;<<7 8
}== 	
private?? 
async?? 
void?? 
ExecuteLogin?? '
(??' (
object??( .
	parameter??/ 8
)??8 9
{@@ 	
ifAA 
(AA 
!AA 
CanExecuteLoginAA  
(AA  !
	parameterAA! *
)AA* +
)AA+ ,
{BB 

MessageBoxCC 
.CC 
ShowCC 
(CC  
LangDD 
.DD 
alertRequiredFieldsDD ,
,DD, -
LangEE 
.EE  
alertInputErrorTitleEE -
,EE- .
MessageBoxButtonFF $
.FF$ %
OKFF% '
,FF' (
MessageBoxImageGG #
.GG# $
WarningGG$ +
)GG+ ,
;GG, -
returnHH 
;HH 
}II 
varKK 
clientKK 
=KK 
newKK '
AuthenticationServiceClientKK 8
(KK8 9
)KK9 :
;KK: ;
boolLL 
successLL 
=LL 
falseLL  
;LL  !
tryNN 
{OO 
OperationResultDtoPP "
resultPP# )
=PP* +
awaitPP, 1
clientPP2 8
.PP8 9

LoginAsyncPP9 C
(PPC D
UsernameOrEmailPPD S
,PPS T
PasswordPPU ]
)PP] ^
;PP^ _
ifRR 
(RR 
resultRR 
.RR 
SuccessRR "
)RR" #
{SS 
SessionManagerTT "
.TT" #
InstanceTT# +
.TT+ ,
StartSessionTT, 8
(TT8 9
resultTT9 ?
.TT? @
MessageTT@ G
)TTG H
;TTH I$
MatchmakingClientManagerUU ,
.UU, -

InitializeUU- 7
(UU7 8
)UU8 9
;UU9 :$
MatchmakingClientManagerVV ,
.VV, -
InstanceVV- 5
.VV5 6
ConnectVV6 =
(VV= >
SessionManagerVV> L
.VVL M
InstanceVVM U
.VVU V
CurrentUsernameVVV e
)VVe f
;VVf g
	OpenLobbyWW 
(WW 
	parameterWW '
)WW' (
;WW( )
clientXX 
.XX 
CloseXX  
(XX  !
)XX! "
;XX" #
successYY 
=YY 
trueYY "
;YY" #
}ZZ 
else[[ 
{\\ 

MessageBox]] 
.]] 
Show]] #
(]]# $
result^^ 
.^^ 
Message^^ &
,^^& '
Lang__ 
.__  
alertLoginErrorTitle__ 1
,__1 2
MessageBoxButton`` (
.``( )
OK``) +
,``+ ,
MessageBoxImageaa '
.aa' (
Erroraa( -
)aa- .
;aa. /
}bb 
}cc 
catchdd 
(dd 
FaultExceptiondd !
<dd! "
stringdd" (
>dd( )
fexdd* -
)dd- .
{ee 

MessageBoxff 
.ff 
Showff 
(ff  
fexgg 
.gg 
Detailgg 
,gg 
Langhh 
.hh  
alertLoginErrorTitlehh -
,hh- .
MessageBoxButtonii $
.ii$ %
OKii% '
,ii' (
MessageBoxImagejj #
.jj# $
Errorjj$ )
)jj) *
;jj* +
}kk 
catchll 
(ll 
FaultExceptionll !

fexGeneralll" ,
)ll, -
{mm 

MessageBoxnn 
.nn 
Shownn 
(nn  
Langoo 
.oo #
alertServerErrorMessageoo 0
,oo0 1
Langpp 
.pp 
alertErrorTitlepp (
,pp( )
MessageBoxButtonqq $
.qq$ %
OKqq% '
,qq' (
MessageBoxImagerr #
.rr# $
Errorrr$ )
)rr) *
;rr* +
Consoless 
.ss 
	WriteLiness !
(ss! "
$"ss" $
$strss$ /
{ss/ 0

fexGeneralss0 :
.ss: ;
Messagess; B
}ssB C
"ssC D
)ssD E
;ssE F
}tt 
catchuu 
(uu %
EndpointNotFoundExceptionuu ,
exuu- /
)uu/ 0
{vv 

MessageBoxww 
.ww 
Showww 
(ww  
Langxx 
.xx '
alertConnectionErrorMessagexx 4
,xx4 5
Langyy 
.yy %
alertConnectionErrorTitleyy 2
,yy2 3
MessageBoxButtonzz $
.zz$ %
OKzz% '
,zz' (
MessageBoxImage{{ #
.{{# $
Error{{$ )
){{) *
;{{* +
Console|| 
.|| 
	WriteLine|| !
(||! "
$"||" $
$str||$ 6
{||6 7
ex||7 9
.||9 :
Message||: A
}||A B
"||B C
)||C D
;||D E
}}} 
catch~~ 
(~~ 
	Exception~~ 
ex~~ 
)~~  
{ 

MessageBox
ÄÄ 
.
ÄÄ 
Show
ÄÄ 
(
ÄÄ  
Lang
ÅÅ 
.
ÅÅ &
alertUnknownErrorMessage
ÅÅ 1
,
ÅÅ1 2
Lang
ÇÇ 
.
ÇÇ 
alertErrorTitle
ÇÇ (
,
ÇÇ( )
MessageBoxButton
ÉÉ $
.
ÉÉ$ %
OK
ÉÉ% '
,
ÉÉ' (
MessageBoxImage
ÑÑ #
.
ÑÑ# $
Error
ÑÑ$ )
)
ÑÑ) *
;
ÑÑ* +
Console
ÖÖ 
.
ÖÖ 
	WriteLine
ÖÖ !
(
ÖÖ! "
$"
ÖÖ" $
$str
ÖÖ$ 3
{
ÖÖ3 4
ex
ÖÖ4 6
.
ÖÖ6 7
Message
ÖÖ7 >
}
ÖÖ> ?
"
ÖÖ? @
)
ÖÖ@ A
;
ÖÖA B
}
ÜÜ 
finally
áá 
{
àà 
if
ââ 
(
ââ 
!
ââ 
success
ââ 
&&
ââ 
client
ââ  &
.
ââ& '
State
ââ' ,
!=
ââ- / 
CommunicationState
ââ0 B
.
ââB C
Closed
ââC I
)
ââI J
{
ää 
client
ãã 
.
ãã 
Abort
ãã  
(
ãã  !
)
ãã! "
;
ãã" #
}
åå 
}
çç 
}
éé 	
private
êê 
static
êê 
void
êê 
	OpenLobby
êê %
(
êê% &
object
êê& ,
	parameter
êê- 6
)
êê6 7
{
ëë 	
if
íí 
(
íí 
	parameter
íí 
is
íí 
Window
íí #
loginWindow
íí$ /
)
íí/ 0
{
ìì 
loginWindow
îî 
.
îî 
Close
îî !
(
îî! "
)
îî" #
;
îî# $
}
ïï 
var
óó 
	lobbyView
óó 
=
óó 
new
óó 
	LobbyView
óó  )
(
óó) *
)
óó* +
;
óó+ ,
	lobbyView
òò 
.
òò 
Show
òò 
(
òò 
)
òò 
;
òò 
}
ôô 	
private
õõ 
static
õõ 
void
õõ  
ExecuteCloseWindow
õõ .
(
õõ. /
object
õõ/ 5
	parameter
õõ6 ?
)
õõ? @
{
úú 	
if
ùù 
(
ùù 
	parameter
ùù 
is
ùù 
Window
ùù #
)
ùù# $
{
ûû 
Application
üü 
.
üü 
Current
üü #
.
üü# $
Shutdown
üü$ ,
(
üü, -
)
üü- .
;
üü. /
}
†† 
}
°° 	
private
££ 
static
££ 
void
££ #
ExecuteMaximizeWindow
££ 1
(
££1 2
object
££2 8
	parameter
££9 B
)
££B C
{
§§ 	
if
•• 
(
•• 
	parameter
•• 
is
•• 
Window
•• #
window
••$ *
)
••* +
{
¶¶ 
window
ßß 
.
ßß 
WindowState
ßß "
=
ßß# $
window
ßß% +
.
ßß+ ,
WindowState
ßß, 7
==
ßß8 :
WindowState
ßß; F
.
ßßF G
	Maximized
ßßG P
?
ßßQ R
WindowState
ßßS ^
.
ßß^ _
Normal
ßß_ e
:
ßßf g
WindowState
ßßh s
.
ßßs t
	Maximized
ßßt }
;
ßß} ~
}
®® 
}
©© 	
private
´´ 
static
´´ 
void
´´ #
ExecuteMinimizeWindow
´´ 1
(
´´1 2
object
´´2 8
	parameter
´´9 B
)
´´B C
{
¨¨ 	
if
≠≠ 
(
≠≠ 
	parameter
≠≠ 
is
≠≠ 
Window
≠≠ #
window
≠≠$ *
)
≠≠* +
{
ÆÆ 
window
ØØ 
.
ØØ 
WindowState
ØØ "
=
ØØ# $
WindowState
ØØ% 0
.
ØØ0 1
	Minimized
ØØ1 :
;
ØØ: ;
}
∞∞ 
}
±± 	
private
≥≥ 
static
≥≥ 
void
≥≥ 
ExecuteReturn
≥≥ )
(
≥≥) *
object
≥≥* 0
	parameter
≥≥1 :
)
≥≥: ;
{
¥¥ 	
if
µµ 
(
µµ 
	parameter
µµ 
is
µµ 
Window
µµ #
currentWindow
µµ$ 1
)
µµ1 2
{
∂∂ 
var
∑∑ 
welcomeView
∑∑ 
=
∑∑  !
new
∑∑" %
WelcomeView
∑∑& 1
(
∑∑1 2
)
∑∑2 3
;
∑∑3 4
welcomeView
∏∏ 
.
∏∏ 
WindowState
∏∏ '
=
∏∏( )
WindowState
∏∏* 5
.
∏∏5 6
	Maximized
∏∏6 ?
;
∏∏? @
welcomeView
ππ 
.
ππ 
WindowStyle
ππ '
=
ππ( )
WindowStyle
ππ* 5
.
ππ5 6
None
ππ6 :
;
ππ: ;
welcomeView
∫∫ 
.
∫∫ 

ResizeMode
∫∫ &
=
∫∫' (

ResizeMode
∫∫) 3
.
∫∫3 4
NoResize
∫∫4 <
;
∫∫< =
welcomeView
ªª 
.
ªª 
Show
ªª  
(
ªª  !
)
ªª! "
;
ªª" #
currentWindow
ºº 
.
ºº 
Close
ºº #
(
ºº# $
)
ºº$ %
;
ºº% &
}
ΩΩ 
}
ææ 	
}
øø 
}¿¿ ˚
©C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\Dialogs\InviteByEmailViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
.+ ,
Dialogs, 3
{ 
internal		 
class		 "
InviteByEmailViewModel		 )
:		* +
ViewModelBase		, 9
{

 
} 
} ¿Ä
°C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\ConfigurationViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
{ 
public 

class "
ConfigurationViewModel '
:( )
ViewModelBase* 7
{ 
public 
ICommand 
LogOutCommand %
{& '
get( +
;+ ,
}- .
private 
bool 

_isSpanish 
;  
private 
bool 

_isEnglish 
;  
private 
string 
_configTitle #
;# $
private 
string 
_soundTitle "
;" #
private 
string 
_soundEffectsLabel )
;) *
private 
string 
_musicLabel "
;" #
private 
string 
_volumeLabel #
;# $
private 
string 
_languageTitle %
;% &
private 
string 
_spanishButtonText )
;) *
private 
string 
_englishButtonText )
;) *
private 
string 
_logoutButtonText (
;( )
public!! 
string!! 
ConfigTitle!! !
{"" 	
get## 
=>## 
_configTitle## 
;##  
set$$ 
{$$ 
_configTitle$$ 
=$$  
value$$! &
;$$& '
OnPropertyChanged$$( 9
($$9 :
nameof$$: @
($$@ A
ConfigTitle$$A L
)$$L M
)$$M N
;$$N O
}$$P Q
}%% 	
public&& 
string&& 

SoundTitle&&  
{'' 	
get(( 
=>(( 
_soundTitle(( 
;(( 
set)) 
{)) 
_soundTitle)) 
=)) 
value))  %
;))% &
OnPropertyChanged))' 8
())8 9
nameof))9 ?
())? @

SoundTitle))@ J
)))J K
)))K L
;))L M
}))N O
}** 	
public++ 
string++ 
SoundEffectsLabel++ '
{,, 	
get-- 
=>-- 
_soundEffectsLabel-- %
;--% &
set.. 
{.. 
_soundEffectsLabel.. $
=..% &
value..' ,
;.., -
OnPropertyChanged... ?
(..? @
nameof..@ F
(..F G
SoundEffectsLabel..G X
)..X Y
)..Y Z
;..Z [
}..\ ]
}// 	
public00 
string00 

MusicLabel00  
{11 	
get22 
=>22 
_musicLabel22 
;22 
set33 
{33 
_musicLabel33 
=33 
value33  %
;33% &
OnPropertyChanged33' 8
(338 9
nameof339 ?
(33? @

MusicLabel33@ J
)33J K
)33K L
;33L M
}33N O
}44 	
public55 
string55 
VolumeLabel55 !
{66 	
get77 
=>77 
_volumeLabel77 
;77  
set88 
{88 
_volumeLabel88 
=88  
value88! &
;88& '
OnPropertyChanged88( 9
(889 :
nameof88: @
(88@ A
VolumeLabel88A L
)88L M
)88M N
;88N O
}88P Q
}99 	
public:: 
string:: 
LanguageTitle:: #
{;; 	
get<< 
=><< 
_languageTitle<< !
;<<! "
set== 
{== 
_languageTitle==  
===! "
value==# (
;==( )
OnPropertyChanged==* ;
(==; <
nameof==< B
(==B C
LanguageTitle==C P
)==P Q
)==Q R
;==R S
}==T U
}>> 	
public?? 
string?? 
SpanishButtonText?? '
{@@ 	
getAA 
=>AA 
_spanishButtonTextAA %
;AA% &
setBB 
{BB 
_spanishButtonTextBB $
=BB% &
valueBB' ,
;BB, -
OnPropertyChangedBB. ?
(BB? @
nameofBB@ F
(BBF G
SpanishButtonTextBBG X
)BBX Y
)BBY Z
;BBZ [
}BB\ ]
}CC 	
publicDD 
stringDD 
EnglishButtonTextDD '
{EE 	
getFF 
=>FF 
_englishButtonTextFF %
;FF% &
setGG 
{GG 
_englishButtonTextGG $
=GG% &
valueGG' ,
;GG, -
OnPropertyChangedGG. ?
(GG? @
nameofGG@ F
(GGF G
EnglishButtonTextGGG X
)GGX Y
)GGY Z
;GGZ [
}GG\ ]
}HH 	
publicII 
stringII 
LogoutButtonTextII &
{JJ 	
getKK 
=>KK 
_logoutButtonTextKK $
;KK$ %
setLL 
{LL 
_logoutButtonTextLL #
=LL$ %
valueLL& +
;LL+ ,
OnPropertyChangedLL- >
(LL> ?
nameofLL? E
(LLE F
LogoutButtonTextLLF V
)LLV W
)LLW X
;LLX Y
}LLZ [
}MM 	
publicOO "
ConfigurationViewModelOO %
(OO% &
)OO& '
{PP 	
LogOutCommandQQ 
=QQ 
newQQ 
RelayCommandQQ  ,
(QQ, -
ExecuteLogoutQQ- :
)QQ: ;
;QQ; <
stringSS 
currentCultureSS !
=SS" #
ThreadSS$ *
.SS* +
CurrentThreadSS+ 8
.SS8 9
CurrentUICultureSS9 I
.SSI J
NameSSJ N
;SSN O
ifTT 
(TT 
currentCultureTT 
.TT 

StartsWithTT )
(TT) *
$strTT* .
)TT. /
)TT/ 0
{UU 

_isSpanishVV 
=VV 
trueVV !
;VV! "
}WW 
elseXX 
{YY 

_isEnglishZZ 
=ZZ 
trueZZ !
;ZZ! "
}[[ $
UpdateLanguageProperties\\ $
(\\$ %
)\\% &
;\\& '
}]] 	
public__ 
bool__ 
	IsSpanish__ 
{`` 	
getaa 
=>aa 

_isSpanishaa 
;aa 
setbb 
{cc 
ifdd 
(dd 
valuedd 
&&dd 
!dd 

_isSpanishdd (
)dd( )
{ee 

_isSpanishff 
=ff  
trueff! %
;ff% &

_isEnglishgg 
=gg  
falsegg! &
;gg& '
ChangeLanguageii "
(ii" #
$strii# *
)ii* +
;ii+ ,
OnPropertyChangedjj %
(jj% &
nameofjj& ,
(jj, -
	IsSpanishjj- 6
)jj6 7
)jj7 8
;jj8 9
OnPropertyChangedkk %
(kk% &
nameofkk& ,
(kk, -
	IsEnglishkk- 6
)kk6 7
)kk7 8
;kk8 9
}ll 
}mm 
}nn 	
publicpp 
boolpp 
	IsEnglishpp 
{qq 	
getrr 
=>rr 

_isEnglishrr 
;rr 
setss 
{tt 
ifuu 
(uu 
valueuu 
&&uu 
!uu 

_isEnglishuu (
)uu( )
{vv 

_isEnglishww 
=ww  
trueww! %
;ww% &

_isSpanishxx 
=xx  
falsexx! &
;xx& '
ChangeLanguagezz "
(zz" #
$strzz# *
)zz* +
;zz+ ,
OnPropertyChanged{{ %
({{% &
nameof{{& ,
({{, -
	IsEnglish{{- 6
){{6 7
){{7 8
;{{8 9
OnPropertyChanged|| %
(||% &
nameof||& ,
(||, -
	IsSpanish||- 6
)||6 7
)||7 8
;||8 9
}}} 
}~~ 
} 	
private
ÅÅ 
static
ÅÅ 
void
ÅÅ 
ChangeLanguage
ÅÅ *
(
ÅÅ* +
string
ÅÅ+ 1
cultureName
ÅÅ2 =
)
ÅÅ= >
{
ÇÇ 	
try
ÉÉ 
{
ÑÑ 
CultureInfo
ÖÖ 

newCulture
ÖÖ &
=
ÖÖ' (
new
ÖÖ) ,
CultureInfo
ÖÖ- 8
(
ÖÖ8 9
cultureName
ÖÖ9 D
)
ÖÖD E
;
ÖÖE F
Thread
áá 
.
áá 
CurrentThread
áá $
.
áá$ %
CurrentCulture
áá% 3
=
áá4 5

newCulture
áá6 @
;
áá@ A
Thread
àà 
.
àà 
CurrentThread
àà $
.
àà$ %
CurrentUICulture
àà% 5
=
àà6 7

newCulture
àà8 B
;
ààB C
Lang
ââ 
.
ââ 
Culture
ââ 
=
ââ 

newCulture
ââ )
;
ââ) *
Window
ãã  
currentLobbyWindow
ãã )
=
ãã* +
Application
ãã, 7
.
ãã7 8
Current
ãã8 ?
.
ãã? @
Windows
ãã@ G
.
ããG H
OfType
ããH N
<
ããN O
	LobbyView
ããO X
>
ããX Y
(
ããY Z
)
ããZ [
.
ãã[ \
FirstOrDefault
ãã\ j
(
ããj k
)
ããk l
;
ããl m
var
çç 
newLobbyView
çç  
=
çç! "
new
çç# &
	LobbyView
çç' 0
(
çç0 1
)
çç1 2
;
çç2 3
newLobbyView
éé 
.
éé 
Show
éé !
(
éé! "
)
éé" #
;
éé# $
if
êê 
(
êê  
currentLobbyWindow
êê &
!=
êê' )
null
êê* .
)
êê. /
{
ëë  
currentLobbyWindow
íí &
.
íí& '
Close
íí' ,
(
íí, -
)
íí- .
;
íí. /
}
ìì 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ññ 

MessageBox
óó 
.
óó 
Show
óó 
(
óó  
$"
óó  "
$str
óó" >
{
óó> ?
ex
óó? A
.
óóA B
Message
óóB I
}
óóI J
"
óóJ K
,
óóK L
$str
óóM T
,
óóT U
MessageBoxButton
óóV f
.
óóf g
OK
óóg i
,
óói j
MessageBoxImage
óók z
.
óóz {
Erroróó{ Ä
)óóÄ Å
;óóÅ Ç
}
òò 
}
ôô 	
private
õõ 
void
õõ &
UpdateLanguageProperties
õõ -
(
õõ- .
)
õõ. /
{
úú 	
ConfigTitle
ùù 
=
ùù 
Lang
ùù 
.
ùù #
configLbConfiguration
ùù 4
;
ùù4 5

SoundTitle
ûû 
=
ûû 
Lang
ûû 
.
ûû 
configLbSound
ûû +
;
ûû+ ,
SoundEffectsLabel
üü 
=
üü 
Lang
üü  $
.
üü$ %"
configLbSoundEffects
üü% 9
;
üü9 :

MusicLabel
†† 
=
†† 
Lang
†† 
.
†† 
configLbMusic
†† +
;
††+ ,
VolumeLabel
°° 
=
°° 
Lang
°° 
.
°° 
configLbVolume
°° -
;
°°- .
LanguageTitle
¢¢ 
=
¢¢ 
Lang
¢¢  
.
¢¢  !
configLbLanguage
¢¢! 1
;
¢¢1 2
SpanishButtonText
££ 
=
££ 
Lang
££  $
.
££$ %
configBtnSpanish
££% 5
;
££5 6
EnglishButtonText
§§ 
=
§§ 
Lang
§§  $
.
§§$ %
configBtnEnglish
§§% 5
;
§§5 6
LogoutButtonText
•• 
=
•• 
Lang
•• #
.
••# $
configtBtnLogOut
••$ 4
;
••4 5
}
¶¶ 	
private
®® 
static
®® 
void
®® 
ExecuteLogout
®® )
(
®®) *
object
®®* 0
	parameter
®®1 :
)
®®: ;
{
©© 	
bool
™™ "
sessionClosedLocally
™™ %
=
™™& '
false
™™( -
;
™™- .
try
´´ 
{
¨¨ 
string
≠≠ 
currentUsername
≠≠ &
=
≠≠' (
SessionManager
≠≠) 7
.
≠≠7 8
Instance
≠≠8 @
.
≠≠@ A
CurrentUsername
≠≠A P
;
≠≠P Q
if
ØØ 
(
ØØ 
!
ØØ 
string
ØØ 
.
ØØ 
IsNullOrEmpty
ØØ )
(
ØØ) *
currentUsername
ØØ* 9
)
ØØ9 :
)
ØØ: ;
{
∞∞ 
using
±± 
(
±± 
var
±± 

authClient
±± )
=
±±* +
new
±±, /)
AuthenticationServiceClient
±±0 K
(
±±K L
)
±±L M
)
±±M N
{
≤≤ 
try
≥≥ 
{
¥¥ 

authClient
µµ &
.
µµ& '
LogOut
µµ' -
(
µµ- .
currentUsername
µµ. =
)
µµ= >
;
µµ> ?
}
∂∂ 
catch
∑∑ 
(
∑∑ $
CommunicationException
∑∑ 5
commEx
∑∑6 <
)
∑∑< =
{
∏∏ 
Console
ππ #
.
ππ# $
	WriteLine
ππ$ -
(
ππ- .
$"
ππ. 0
$str
ππ0 d
{
ππd e
commEx
ππe k
.
ππk l
Message
ππl s
}
ππs t
"
ππt u
)
ππu v
;
ππv w
}
∫∫ 
}
ªª 
}
ºº 
SessionManager
ææ 
.
ææ 
Instance
ææ '
.
ææ' (
CloseSession
ææ( 4
(
ææ4 5
)
ææ5 6
;
ææ6 7"
sessionClosedLocally
øø $
=
øø% &
true
øø' +
;
øø+ ,&
MatchmakingClientManager
¿¿ (
.
¿¿( )
Instance
¿¿) 1
.
¿¿1 2

Disconnect
¿¿2 <
(
¿¿< =
)
¿¿= >
;
¿¿> ?
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
√√ 
Console
ƒƒ 
.
ƒƒ 
	WriteLine
ƒƒ !
(
ƒƒ! "
$"
ƒƒ" $
$str
ƒƒ$ R
{
ƒƒR S
ex
ƒƒS U
.
ƒƒU V
Message
ƒƒV ]
}
ƒƒ] ^
"
ƒƒ^ _
)
ƒƒ_ `
;
ƒƒ` a
if
≈≈ 
(
≈≈ 
!
≈≈ "
sessionClosedLocally
≈≈ )
)
≈≈) *
{
∆∆ 
SessionManager
«« "
.
««" #
Instance
««# +
.
««+ ,
CloseSession
««, 8
(
««8 9
)
««9 :
;
««: ;
}
»» 
}
…… 
var
ÀÀ 
mainView
ÀÀ 
=
ÀÀ 
new
ÀÀ 
MainView
ÀÀ '
(
ÀÀ' (
)
ÀÀ( )
;
ÀÀ) *
mainView
ÃÃ 
.
ÃÃ 
WindowState
ÃÃ  
=
ÃÃ! "
WindowState
ÃÃ# .
.
ÃÃ. /
	Maximized
ÃÃ/ 8
;
ÃÃ8 9
mainView
ÕÕ 
.
ÕÕ 
WindowStyle
ÕÕ  
=
ÕÕ! "
WindowStyle
ÕÕ# .
.
ÕÕ. /
None
ÕÕ/ 3
;
ÕÕ3 4
mainView
ŒŒ 
.
ŒŒ 

ResizeMode
ŒŒ 
=
ŒŒ  !

ResizeMode
ŒŒ" ,
.
ŒŒ, -
NoResize
ŒŒ- 5
;
ŒŒ5 6
mainView
œœ 
.
œœ 
Show
œœ 
(
œœ 
)
œœ 
;
œœ 
Window
——  
currentLobbyWindow
—— %
=
——& '
Application
——( 3
.
——3 4
Current
——4 ;
.
——; <
Windows
——< C
.
——C D
OfType
——D J
<
——J K
	LobbyView
——K T
>
——T U
(
——U V
)
——V W
.
——W X
FirstOrDefault
——X f
(
——f g
)
——g h
;
——h i
if
”” 
(
””  
currentLobbyWindow
”” "
!=
””# %
null
””& *
)
””* +
{
‘‘  
currentLobbyWindow
’’ "
.
’’" #
Close
’’# (
(
’’( )
)
’’) *
;
’’* +
}
÷÷ 
}
◊◊ 	
}
ÿÿ 
}ŸŸ ¯?
®C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\Dialogs\VerifyByCodeViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
.+ ,
Dialogs, 3
{ 
public 

class !
VerifyByCodeViewModel &
:' (
ViewModelBase) 6
{ 
private 
readonly 
string 

_userEmail  *
;* +
private 
string 
_verificationCode (
;( )
public 
string 
VerificationCode &
{ 	
get 
{ 
return 
_verificationCode (
;( )
} 
set 
{ 
if 
( 
_verificationCode %
!=& (
value) .
). /
{ 
_verificationCode %
=& '
value( -
;- .
OnPropertyChanged %
(% &
)& '
;' (
}   
}!! 
}"" 	
public$$ 
ICommand$$ 
VerifyCommand$$ %
{$$& '
get$$( +
;$$+ ,
}$$- .
public%% 
ICommand%% 
CloseCommand%% $
{%%% &
get%%' *
;%%* +
}%%, -
public'' !
VerifyByCodeViewModel'' $
(''$ %
string''% +
	userEmail'', 5
)''5 6
{(( 	
if)) 
()) 
string)) 
.)) 
IsNullOrWhiteSpace)) )
())) *
	userEmail))* 3
)))3 4
)))4 5
{** 
throw++ 
new++ !
ArgumentNullException++ /
(++/ 0
nameof++0 6
(++6 7
	userEmail++7 @
)++@ A
,++A B
$str++C q
)++q r
;++r s
},, 

_userEmail-- 
=-- 
	userEmail-- "
;--" #
VerifyCommand// 
=// 
new// 
RelayCommand//  ,
(//, -
ExecuteVerify//- :
,//: ;
CanExecuteVerify//< L
)//L M
;//M N
CloseCommand00 
=00 
new00 
RelayCommand00 +
(00+ ,
CloseWindow00, 7
)007 8
;008 9
}11 	
private33 
bool33 
CanExecuteVerify33 %
(33% &
object33& ,
	parameter33- 6
)336 7
{44 	
return55 
!55 
string55 
.55 
IsNullOrWhiteSpace55 -
(55- .
VerificationCode55. >
)55> ?
;55? @
}66 	
private88 
async88 
void88 
ExecuteVerify88 (
(88( )
object88) /
	parameter880 9
)889 :
{99 	
using:: 
(:: '
AuthenticationServiceClient:: .
client::/ 5
=::6 7
new::8 ;'
AuthenticationServiceClient::< W
(::W X
)::X Y
)::Y Z
{;; 
try<< 
{== 
OperationResultDto>> &
result>>' -
=>>. /
await>>0 5
client>>6 <
.>>< =
VerifyAccountAsync>>= O
(>>O P

_userEmail>>P Z
,>>Z [
VerificationCode>>\ l
)>>l m
;>>m n
if@@ 
(@@ 
result@@ 
.@@ 
Success@@ &
)@@& '
{AA 

MessageBoxBB "
.BB" #
ShowBB# '
(BB' (
LangCC  
.CC  !$
alertVerificationSuccessCC! 9
,CC9 :
LangDD  
.DD  !(
alertActivationCompleteTitleDD! =
,DD= >
MessageBoxButtonEE ,
.EE, -
OKEE- /
,EE/ 0
MessageBoxImageFF +
.FF+ ,
InformationFF, 7
)FF7 8
;FF8 9
OpenLoginWindowGG '
(GG' (
	parameterGG( 1
)GG1 2
;GG2 3
}HH 
elseII 
{JJ 

MessageBoxKK "
.KK" #
ShowKK# '
(KK' (
resultLL "
.LL" #
MessageLL# *
,LL* +
LangMM  
.MM  !'
alertVerificationErrorTitleMM! <
,MM< =
MessageBoxButtonNN ,
.NN, -
OKNN- /
,NN/ 0
MessageBoxImageOO +
.OO+ ,
WarningOO, 3
)OO3 4
;OO4 5
}PP 
}QQ 
catchRR 
(RR 
FaultExceptionRR %

fexGeneralRR& 0
)RR0 1
{SS 

MessageBoxTT 
.TT 
ShowTT #
(TT# $
LangUU 
.UU #
alertServerErrorMessageUU 4
,UU4 5
LangVV 
.VV 
alertErrorTitleVV ,
,VV, -
MessageBoxButtonWW (
.WW( )
OKWW) +
,WW+ ,
MessageBoxImageXX '
.XX' (
ErrorXX( -
)XX- .
;XX. /
ConsoleYY 
.YY 
	WriteLineYY %
(YY% &
$"YY& (
$strYY( G
{YYG H

fexGeneralYYH R
.YYR S
MessageYYS Z
}YYZ [
"YY[ \
)YY\ ]
;YY] ^
}ZZ 
catch[[ 
([[ %
EndpointNotFoundException[[ 0
ex[[1 3
)[[3 4
{\\ 

MessageBox]] 
.]] 
Show]] #
(]]# $
Lang^^ 
.^^ '
alertConnectionErrorMessage^^ 8
,^^8 9
Lang__ 
.__ %
alertConnectionErrorTitle__ 6
,__6 7
MessageBoxButton`` (
.``( )
OK``) +
,``+ ,
MessageBoxImageaa '
.aa' (
Erroraa( -
)aa- .
;aa. /
Consolebb 
.bb 
	WriteLinebb %
(bb% &
$"bb& (
$strbb( N
{bbN O
exbbO Q
.bbQ R
MessagebbR Y
}bbY Z
"bbZ [
)bb[ \
;bb\ ]
}cc 
catchdd 
(dd 
	Exceptiondd  
exdd! #
)dd# $
{ee 

MessageBoxff 
.ff 
Showff #
(ff# $
Langgg 
.gg $
alertUnknownErrorMessagegg 5
,gg5 6
Langhh 
.hh 
alertErrorTitlehh ,
,hh, -
MessageBoxButtonii (
.ii( )
OKii) +
,ii+ ,
MessageBoxImagejj '
.jj' (
Errorjj( -
)jj- .
;jj. /
Consolekk 
.kk 
	WriteLinekk %
(kk% &
$"kk& (
$strkk( K
{kkK L
exkkL N
.kkN O
MessagekkO V
}kkV W
"kkW X
)kkX Y
;kkY Z
}ll 
}mm 
}nn 	
privatepp 
staticpp 
voidpp 
OpenLoginWindowpp +
(pp+ ,
objectpp, 2
	parameterpp3 <
)pp< =
{qq 	
varrr 
	loginViewrr 
=rr 
newrr 
	LoginViewrr  )
(rr) *
)rr* +
;rr+ ,
	loginViewss 
.ss 
Showss 
(ss 
)ss 
;ss 
ifuu 
(uu 
	parameteruu 
isuu 
Windowuu #
verifyWindowuu$ 0
)uu0 1
{vv 
verifyWindowww 
.ww 
Closeww "
(ww" #
)ww# $
;ww$ %
}xx 
}yy 	
private{{ 
static{{ 
void{{ 
CloseWindow{{ '
({{' (
object{{( .
	parameter{{/ 8
){{8 9
{|| 	
if}} 
(}} 
	parameter}} 
is}} 
Window}} #
window}}$ *
)}}* +
{~~ 
window 
. 
Close 
( 
) 
; 
}
ÄÄ 
}
ÅÅ 	
}
ÇÇ 
}ÉÉ Ë9
üC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\HomePages\WelcomeViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
	HomePages& /
{ 
public		 

class		 
WelcomeViewModel		 !
:		" #
ViewModelBase		$ 1
{

 
public 
ICommand 
SignUpCommand %
{& '
get( +
;+ ,
}- .
public 
ICommand 
LoginCommand $
{% &
get' *
;* +
}, -
public 
ICommand "
ContinueAsGuestCommand .
{/ 0
get1 4
;4 5
}6 7
public 
ICommand 
CloseWindowCommand *
{+ ,
get- 0
;0 1
}2 3
public 
ICommand !
MaximizeWindowCommand -
{. /
get0 3
;3 4
}5 6
public 
ICommand !
MinimizeWindowCommand -
{. /
get0 3
;3 4
}5 6
public 
WelcomeViewModel 
(  
)  !
{ 	
SignUpCommand 
= 
new 
RelayCommand  ,
(, -
SignUp- 3
)3 4
;4 5
LoginCommand 
= 
new 
RelayCommand +
(+ ,
Login, 1
)1 2
;2 3"
ContinueAsGuestCommand "
=# $
new% (
RelayCommand) 5
(5 6
ContinueAsGuest6 E
)E F
;F G
CloseWindowCommand 
=  
new! $
RelayCommand% 1
(1 2
ExecuteCloseWindow2 D
)D E
;E F!
MaximizeWindowCommand !
=" #
new$ '
RelayCommand( 4
(4 5!
ExecuteMaximizeWindow5 J
)J K
;K L!
MinimizeWindowCommand !
=" #
new$ '
RelayCommand( 4
(4 5!
ExecuteMinimizeWindow5 J
)J K
;K L
} 	
private 
static 
void 
SignUp "
(" #
object# )
	parameter* 3
)3 4
{ 	
if 
( 
	parameter 
is 
Window #
welcomeWindow$ 1
)1 2
{ 
var   

signUpView   
=    
new  ! $

SignUpView  % /
(  / 0
)  0 1
;  1 2

signUpView!! 
.!! 
WindowState!! &
=!!' (
welcomeWindow!!) 6
.!!6 7
WindowState!!7 B
;!!B C

signUpView"" 
."" 
WindowState"" &
=""' (
WindowState"") 4
.""4 5
	Maximized""5 >
;""> ?

signUpView## 
.## 
WindowStyle## &
=##' (
WindowStyle##) 4
.##4 5
None##5 9
;##9 :

signUpView$$ 
.$$ 

ResizeMode$$ %
=$$& '

ResizeMode$$( 2
.$$2 3
NoResize$$3 ;
;$$; <

signUpView%% 
.%% 
Show%% 
(%%  
)%%  !
;%%! "
welcomeWindow&& 
.&& 
Close&& #
(&&# $
)&&$ %
;&&% &
}'' 
}(( 	
private** 
static** 
void** 
Login** !
(**! "
object**" (
	parameter**) 2
)**2 3
{++ 	
if,, 
(,, 
	parameter,, 
is,, 
Window,, #
welcomeWindow,,$ 1
),,1 2
{-- 
var.. 
	loginView.. 
=.. 
new..  #
	LoginView..$ -
(..- .
)... /
;../ 0
	loginView// 
.// 
WindowState// %
=//& '
welcomeWindow//( 5
.//5 6
WindowState//6 A
;//A B
	loginView00 
.00 
WindowState00 %
=00& '
WindowState00( 3
.003 4
	Maximized004 =
;00= >
	loginView11 
.11 
WindowStyle11 %
=11& '
WindowStyle11( 3
.113 4
None114 8
;118 9
	loginView22 
.22 

ResizeMode22 $
=22% &

ResizeMode22' 1
.221 2
NoResize222 :
;22: ;
	loginView33 
.33 
Show33 
(33 
)33  
;33  !
welcomeWindow44 
.44 
Close44 #
(44# $
)44$ %
;44% &
}55 
}66 	
private88 
static88 
void88 
ContinueAsGuest88 +
(88+ ,
object88, 2
	parameter883 <
)88< =
{99 	
var:: 
	lobbyView:: 
=:: 
new:: 
	LobbyView::  )
(::) *
)::* +
;::+ ,
	lobbyView;; 
.;; 
Show;; 
(;; 
);; 
;;; 
if== 
(== 
	parameter== 
is== 
Window== #
welcomeWindow==$ 1
)==1 2
{>> 
welcomeWindow?? 
.?? 
Close?? #
(??# $
)??$ %
;??% &
}@@ 
}AA 	
privateCC 
staticCC 
voidCC 
ExecuteCloseWindowCC .
(CC. /
objectCC/ 5
	parameterCC6 ?
)CC? @
{DD 	
ifEE 
(EE 
	parameterEE 
isEE 
WindowEE #
)EE# $
{FF 
ApplicationGG 
.GG 
CurrentGG #
.GG# $
ShutdownGG$ ,
(GG, -
)GG- .
;GG. /
}HH 
}II 	
privateKK 
staticKK 
voidKK !
ExecuteMaximizeWindowKK 1
(KK1 2
objectKK2 8
	parameterKK9 B
)KKB C
{LL 	
ifMM 
(MM 
	parameterMM 
isMM 
WindowMM #
windowMM$ *
)MM* +
{NN 
windowOO 
.OO 
WindowStateOO "
=OO# $
windowOO% +
.OO+ ,
WindowStateOO, 7
==OO8 :
WindowStateOO; F
.OOF G
	MaximizedOOG P
?OOQ R
WindowStateOOS ^
.OO^ _
NormalOO_ e
:OOf g
WindowStateOOh s
.OOs t
	MaximizedOOt }
;OO} ~
}PP 
}QQ 	
privateSS 
staticSS 
voidSS !
ExecuteMinimizeWindowSS 1
(SS1 2
objectSS2 8
	parameterSS9 B
)SSB C
{TT 	
ifUU 
(UU 
	parameterUU 
isUU 
WindowUU #
windowUU$ *
)UU* +
{VV 
windowWW 
.WW 
WindowStateWW "
=WW# $
WindowStateWW% 0
.WW0 1
	MinimizedWW1 :
;WW: ;
}XX 
}YY 	
}ZZ 
}[[ ◊?
ßC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\Dialogs\ChangeEmailViewModel.cs
	namespace

 	
GuessMyMessClient


 
.

 
	ViewModel

 %
.

% &
Lobby

& +
.

+ ,
Dialogs

, 3
{ 
internal 
class  
ChangeEmailViewModel '
:( )
ViewModelBase* 7
{ 
private 
readonly 
string 
	_username  )
;) *
private 
readonly 
Action 
<  
string  &
>& ' 
_emailUpdateCallback( <
;< =
private 
string 
	_newEmail  
;  !
public 
string 
NewEmail 
{ 	
get 
{ 
return 
	_newEmail  
;  !
} 
set 
{ 
if 
( 
	_newEmail 
!=  
value! &
)& '
{ 
	_newEmail 
= 
value  %
;% &
OnPropertyChanged %
(% &
)& '
;' (
} 
} 
}   	
public"" 
ICommand"" 
ConfirmCommand"" &
{""' (
get"") ,
;"", -
}"". /
public## 
ICommand## 
CloseCommand## $
{##% &
get##' *
;##* +
}##, -
public%%  
ChangeEmailViewModel%% #
(%%# $
string%%$ *
username%%+ 3
,%%3 4
Action%%5 ;
<%%; <
string%%< B
>%%B C
emailUpdateCallback%%D W
)%%W X
{&& 	
	_username'' 
='' 
username''  
;''  ! 
_emailUpdateCallback((  
=((! "
emailUpdateCallback((# 6
;((6 7
ConfirmCommand)) 
=)) 
new))  
RelayCommand))! -
())- .
ExecuteConfirm)). <
,))< =
CanExecuteConfirm))> O
)))O P
;))P Q
CloseCommand** 
=** 
new** 
RelayCommand** +
(**+ ,
ExecuteClose**, 8
)**8 9
;**9 :
}++ 	
private-- 
bool-- 
CanExecuteConfirm-- &
(--& '
object--' -
obj--. 1
)--1 2
{.. 	
return// 
!// 
string// 
.// 
IsNullOrWhiteSpace// -
(//- .
NewEmail//. 6
)//6 7
&&//8 :
NewEmail//; C
.//C D
Contains//D L
(//L M
$str//M P
)//P Q
;//Q R
}00 	
private22 
async22 
void22 
ExecuteConfirm22 )
(22) *
object22* 0
	parameter221 :
)22: ;
{33 	
try44 
{55 
using66 
(66 
var66 
client66 !
=66" #
new66$ '$
UserProfileServiceClient66( @
(66@ A
)66A B
)66B C
{77 
var88 
result88 
=88  
await88! &
client88' -
.88- .#
RequestChangeEmailAsync88. E
(88E F
	_username88F O
,88O P
NewEmail88Q Y
)88Y Z
;88Z [
if99 
(99 
result99 
.99 
Success99 &
)99' (
{:: 

MessageBox;; "
.;;" #
Show;;# '
(;;' (
result<< "
.<<" #
Message<<# *
,<<* +
Lang==  
.==  !
alertCodeSentTitle==! 3
,==3 4
MessageBoxButton>> ,
.>>, -
OK>>- /
,>>/ 0
MessageBoxImage?? +
.??+ ,
Information??, 7
)??7 8
;??8 9
varAA 
verifyVMAA $
=AA% &
newAA' *(
VerifyChangesByCodeViewModelAA+ G
(AAG H(
VerifyChangesByCodeViewModelBB 8
.BB8 9
VerificationModeBB9 I
.BBI J
EmailBBJ O
,BBO P
	_usernameCC %
,CC% &
NewEmailDD $
,DD$ % 
_emailUpdateCallbackEE 0
)FF 
;FF 
varHH 

verifyViewHH &
=HH' (
newHH) ,#
VerifyChangesByCodeViewHH- D
{HHE F
DataContextHHG R
=HHS T
verifyVMHHU ]
}HH^ _
;HH_ `
ExecuteCloseJJ $
(JJ$ %
	parameterJJ% .
)JJ. /
;JJ/ 0

verifyViewKK "
.KK" #

ShowDialogKK# -
(KK- .
)KK. /
;KK/ 0
}LL 
elseMM 
{NN 

MessageBoxOO "
.OO" #
ShowOO# '
(OO' (
resultPP "
.PP" #
MessagePP# *
,PP* +
LangQQ  
.QQ  !
alertErrorTitleQQ! 0
,QQ0 1
MessageBoxButtonRR ,
.RR, -
OKRR- /
,RR/ 0
MessageBoxImageSS +
.SS+ ,
WarningSS, 3
)SS3 4
;SS4 5
}TT 
}UU 
}VV 
catchWW 
(WW 
FaultExceptionWW !

fexGeneralWW" ,
)WW, -
{XX 

MessageBoxYY 
.YY 
ShowYY 
(YY  
LangZZ 
.ZZ #
alertServerErrorMessageZZ 0
,ZZ0 1
Lang[[ 
.[[ 
alertErrorTitle[[ (
,[[( )
MessageBoxButton\\ $
.\\$ %
OK\\% '
,\\' (
MessageBoxImage]] #
.]]# $
Error]]$ )
)]]) *
;]]* +
Console^^ 
.^^ 
	WriteLine^^ !
(^^! "
$"^^" $
$str^^$ G
{^^G H

fexGeneral^^H R
.^^R S
Message^^S Z
}^^Z [
"^^[ \
)^^\ ]
;^^] ^
}__ 
catch`` 
(`` %
EndpointNotFoundException`` ,
ex``- /
)``/ 0
{aa 

MessageBoxbb 
.bb 
Showbb 
(bb  
Langcc 
.cc '
alertConnectionErrorMessagecc 4
,cc4 5
Langdd 
.dd %
alertConnectionErrorTitledd 2
,dd2 3
MessageBoxButtonee $
.ee$ %
OKee% '
,ee' (
MessageBoxImageff #
.ff# $
Errorff$ )
)ff) *
;ff* +
Consolegg 
.gg 
	WriteLinegg !
(gg! "
$"gg" $
$strgg$ N
{ggN O
exggO Q
.ggQ R
MessageggR Y
}ggY Z
"ggZ [
)gg[ \
;gg\ ]
}hh 
catchii 
(ii 
	Exceptionii 
exii 
)ii  
{jj 

MessageBoxkk 
.kk 
Showkk 
(kk  
Langll 
.ll $
alertUnknownErrorMessagell 1
,ll1 2
Langmm 
.mm 
alertErrorTitlemm (
,mm( )
MessageBoxButtonnn $
.nn$ %
OKnn% '
,nn' (
MessageBoxImageoo #
.oo# $
Erroroo$ )
)oo) *
;oo* +
Consolepp 
.pp 
	WriteLinepp !
(pp! "
$"pp" $
$strpp$ K
{ppK L
exppL N
.ppN O
MessageppO V
}ppV W
"ppW X
)ppX Y
;ppY Z
}qq 
}rr 	
privatett 
statictt 
voidtt 
ExecuteClosett (
(tt( )
objecttt) /
	parametertt0 9
)tt9 :
{uu 	
ifvv 
(vv 
	parametervv 
isvv 
Windowvv #
windowvv$ *
)vv* +
{ww 
windowxx 
.xx 
Closexx 
(xx 
)xx 
;xx 
}yy 
}zz 	
}{{ 
}|| †n
†C:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\ViewModel\Lobby\SelectAvatarViewModel.cs
	namespace 	
GuessMyMessClient
 
. 
	ViewModel %
.% &
Lobby& +
{ 
public 

class !
SelectAvatarViewModel &
:' (
ViewModelBase) 6
{ 
private 
readonly 
int 
_currentAvatarId -
;- .
public 
event 
Action 
< 
AvatarModel '
>' (
AvatarSelected) 7
;7 8
private  
ObservableCollection $
<$ %
AvatarModel% 0
>0 1
_availableAvatars2 C
;C D
public  
ObservableCollection #
<# $
AvatarModel$ /
>/ 0
AvailableAvatars1 A
{ 	
get 
{ 
return 
_availableAvatars (
;( )
} 
set 
{   
if!! 
(!! 
_availableAvatars!! %
!=!!& (
value!!) .
)!!. /
{"" 
_availableAvatars## %
=##& '
value##( -
;##- .
OnPropertyChanged$$ %
($$% &
)$$& '
;$$' (
}%% 
}&& 
}'' 	
private)) 
AvatarModel)) 
_selectedAvatar)) +
;))+ ,
public** 
AvatarModel** 
SelectedAvatar** )
{++ 	
get,, 
{-- 
return.. 
_selectedAvatar.. &
;..& '
}// 
set00 
{11 
if22 
(22 
_selectedAvatar22 #
!=22$ &
value22' ,
)22, -
{33 
if44 
(44 
_selectedAvatar44 '
!=44( *
null44+ /
)44/ 0
{55 
_selectedAvatar66 '
.66' (

IsSelected66( 2
=663 4
false665 :
;66: ;
}77 
_selectedAvatar99 #
=99$ %
value99& +
;99+ ,
if;; 
(;; 
_selectedAvatar;; '
!=;;( *
null;;+ /
);;/ 0
{<< 
_selectedAvatar== '
.==' (

IsSelected==( 2
===3 4
true==5 9
;==9 :
}>> 
OnPropertyChanged?? %
(??% &
)??& '
;??' (
}@@ 
}AA 
}BB 	
publicDD 
ICommandDD #
ConfirmSelectionCommandDD /
{DD0 1
getDD2 5
;DD5 6
}DD7 8
publicEE 
ICommandEE 
CloseCommandEE $
{EE% &
getEE' *
;EE* +
}EE, -
publicFF 
ICommandFF #
SelectAvatarItemCommandFF /
{FF0 1
getFF2 5
;FF5 6
}FF7 8
publicHH !
SelectAvatarViewModelHH $
(HH$ %
intHH% (
currentAvatarIdHH) 8
=HH9 :
$numHH; <
)HH< =
{II 	
_currentAvatarIdJJ 
=JJ 
currentAvatarIdJJ .
;JJ. /
AvailableAvatarsKK 
=KK 
newKK " 
ObservableCollectionKK# 7
<KK7 8
AvatarModelKK8 C
>KKC D
(KKD E
)KKE F
;KKF G#
ConfirmSelectionCommandMM #
=MM$ %
newMM& )
RelayCommandMM* 6
(MM6 7#
ExecuteConfirmSelectionMM7 N
,MMN O&
CanExecuteConfirmSelectionMMP j
)MMj k
;MMk l
CloseCommandNN 
=NN 
newNN 
RelayCommandNN +
(NN+ ,
CloseWindowNN, 7
)NN7 8
;NN8 9#
SelectAvatarItemCommandOO #
=OO$ %
newOO& )
RelayCommandOO* 6
(OO6 7#
ExecuteSelectAvatarItemOO7 N
)OON O
;OOO P
ifQQ 
(QQ 
!QQ 
DesignerPropertiesQQ #
.QQ# $
GetIsInDesignModeQQ$ 5
(QQ5 6
newQQ6 9
DependencyObjectQQ: J
(QQJ K
)QQK L
)QQL M
)QQM N
{RR 
LoadAvatarsSS 
(SS 
)SS 
;SS 
}TT 
}UU 	
privateWW 
asyncWW 
TaskWW 
LoadAvatarsWW &
(WW& '
)WW' (
{XX 	
awaitYY 
LoadAvatarsAsyncYY "
(YY" #
)YY# $
;YY$ %
}ZZ 	
private\\ 
async\\ 
Task\\ 
LoadAvatarsAsync\\ +
(\\+ ,
)\\, -
{]] 	
using^^ 
(^^ 
var^^ 
client^^ 
=^^ 
new^^  #$
UserProfileServiceClient^^$ <
(^^< =
)^^= >
)^^> ?
{__ 
try`` 
{aa 
varbb 
serverAvatarsbb %
=bb& '
awaitbb( -
clientbb. 4
.bb4 5$
GetAvailableAvatarsAsyncbb5 M
(bbM N
)bbN O
;bbO P
vardd 
tempAvatarsdd #
=dd$ %
newdd& )
Listdd* .
<dd. /
AvatarModeldd/ :
>dd: ;
(dd; <
)dd< =
;dd= >
ifee 
(ee 
serverAvatarsee %
!=ee& (
nullee) -
)ee- .
{ff 
foreachgg 
(gg  !
vargg! $
	avatarDtogg% .
ingg/ 1
serverAvatarsgg2 ?
)gg? @
{hh 
tempAvatarsii '
.ii' (
Addii( +
(ii+ ,
newii, /
AvatarModelii0 ;
{jj 
Idkk  "
=kk# $
	avatarDtokk% .
.kk. /
IdAvatarkk/ 7
,kk7 8
Namell  $
=ll% &
	avatarDtoll' 0
.ll0 1

AvatarNamell1 ;
,ll; <
	ImageDatamm  )
=mm* +
	avatarDtomm, 5
.mm5 6

AvatarDatamm6 @
,mm@ A
ImageSourcenn  +
=nn, -
ConvertByteToImagenn. @
(nn@ A
	avatarDtonnA J
.nnJ K

AvatarDatannK U
)nnU V
}oo 
)oo 
;oo 
}pp 
}qq 
AvailableAvatarsss $
=ss% &
newss' * 
ObservableCollectionss+ ?
<ss? @
AvatarModelss@ K
>ssK L
(ssL M
tempAvatarsssM X
)ssX Y
;ssY Z
SelectedAvataruu "
=uu# $
AvailableAvatarsuu% 5
.uu5 6
FirstOrDefaultuu6 D
(uuD E
auuE F
=>uuG I
auuJ K
.uuK L
IduuL N
==uuO Q
_currentAvatarIduuR b
)uub c
??vv% '
AvailableAvatarsvv( 8
.vv8 9
FirstOrDefaultvv9 G
(vvG H
)vvH I
;vvI J
}ww 
catchxx 
(xx 
FaultExceptionxx %

fexGeneralxx& 0
)xx0 1
{yy 

MessageBoxzz 
.zz 
Showzz #
(zz# $
Lang{{ 
.{{ &
alertAvatarLoadServerError{{ 7
,{{7 8
Lang|| 
.|| 
alertErrorTitle|| ,
,||, -
MessageBoxButton}} (
.}}( )
OK}}) +
,}}+ ,
MessageBoxImage~~ '
.~~' (
Error~~( -
)~~- .
;~~. /
Console 
. 
	WriteLine %
(% &
$"& (
$str( C
{C D

fexGeneralD N
.N O
MessageO V
}V W
"W X
)X Y
;Y Z
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ '
EndpointNotFoundException
ÅÅ 0
ex
ÅÅ1 3
)
ÅÅ3 4
{
ÇÇ 

MessageBox
ÉÉ 
.
ÉÉ 
Show
ÉÉ #
(
ÉÉ# $
Lang
ÑÑ 
.
ÑÑ )
alertConnectionErrorMessage
ÑÑ 8
,
ÑÑ8 9
Lang
ÖÖ 
.
ÖÖ '
alertConnectionErrorTitle
ÖÖ 6
,
ÖÖ6 7
MessageBoxButton
ÜÜ (
.
ÜÜ( )
OK
ÜÜ) +
,
ÜÜ+ ,
MessageBoxImage
áá '
.
áá' (
Error
áá( -
)
áá- .
;
áá. /
Console
àà 
.
àà 
	WriteLine
àà %
(
àà% &
$"
àà& (
$str
àà( J
{
ààJ K
ex
ààK M
.
ààM N
Message
ààN U
}
ààU V
"
ààV W
)
ààW X
;
ààX Y
}
ââ 
catch
ää 
(
ää 
	Exception
ää  
ex
ää! #
)
ää# $
{
ãã 

MessageBox
åå 
.
åå 
Show
åå #
(
åå# $
Lang
çç 
.
çç )
alertAvatarLoadUnknownError
çç 8
,
çç8 9
Lang
éé 
.
éé 
alertErrorTitle
éé ,
,
éé, -
MessageBoxButton
èè (
.
èè( )
OK
èè) +
,
èè+ ,
MessageBoxImage
êê '
.
êê' (
Error
êê( -
)
êê- .
;
êê. /
Console
ëë 
.
ëë 
	WriteLine
ëë %
(
ëë% &
$"
ëë& (
$str
ëë( J
{
ëëJ K
ex
ëëK M
.
ëëM N
Message
ëëN U
}
ëëU V
"
ëëV W
)
ëëW X
;
ëëX Y
}
íí 
}
ìì 
}
îî 	
private
ññ 
void
ññ %
ExecuteSelectAvatarItem
ññ ,
(
ññ, -
object
ññ- 3
	parameter
ññ4 =
)
ññ= >
{
óó 	
if
òò 
(
òò 
	parameter
òò 
is
òò 
AvatarModel
òò (
avatar
òò) /
)
òò/ 0
{
ôô 
SelectedAvatar
öö 
=
öö  
avatar
öö! '
;
öö' (
}
õõ 
}
úú 	
private
ûû 
bool
ûû (
CanExecuteConfirmSelection
ûû /
(
ûû/ 0
object
ûû0 6
	parameter
ûû7 @
)
ûû@ A
{
üü 	
return
†† 
SelectedAvatar
†† !
!=
††" $
null
††% )
;
††) *
}
°° 	
private
££ 
void
££ %
ExecuteConfirmSelection
££ ,
(
££, -
object
££- 3
	parameter
££4 =
)
££= >
{
§§ 	
AvatarSelected
•• 
?
•• 
.
•• 
Invoke
•• "
(
••" #
SelectedAvatar
••# 1
)
••1 2
;
••2 3
CloseWindow
¶¶ 
(
¶¶ 
	parameter
¶¶ !
)
¶¶! "
;
¶¶" #
}
ßß 	
private
©© 
void
©© 
CloseWindow
©©  
(
©©  !
object
©©! '
	parameter
©©( 1
)
©©1 2
{
™™ 	
if
´´ 
(
´´ 
	parameter
´´ 
is
´´ 
Window
´´ #
window
´´$ *
)
´´* +
{
¨¨ 
window
≠≠ 
.
≠≠ 
Close
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
}
ÆÆ 
else
ØØ 
{
∞∞ 
var
±± 
activeWindow
±±  
=
±±! "
Application
±±# .
.
±±. /
Current
±±/ 6
.
±±6 7
Windows
±±7 >
.
±±> ?
OfType
±±? E
<
±±E F
Window
±±F L
>
±±L M
(
±±M N
)
±±N O
.
±±O P
FirstOrDefault
±±P ^
(
±±^ _
w
±±_ `
=>
±±a c
w
±±d e
.
±±e f
DataContext
±±f q
==
±±r t
this
±±u y
)
±±y z
;
±±z {
activeWindow
≤≤ 
?
≤≤ 
.
≤≤ 
Close
≤≤ #
(
≤≤# $
)
≤≤$ %
;
≤≤% &
}
≥≥ 
}
¥¥ 	
public
∂∂ 
static
∂∂ 
BitmapImage
∂∂ ! 
ConvertByteToImage
∂∂" 4
(
∂∂4 5
byte
∂∂5 9
[
∂∂9 :
]
∂∂: ;

imageBytes
∂∂< F
)
∂∂F G
{
∑∑ 	
if
∏∏ 
(
∏∏ 

imageBytes
∏∏ 
==
∏∏ 
null
∏∏ "
||
∏∏# %

imageBytes
∏∏& 0
.
∏∏0 1
Length
∏∏1 7
==
∏∏8 :
$num
∏∏; <
)
∏∏< =
{
ππ 
return
∫∫ 
null
∫∫ 
;
∫∫ 
}
ªª 
var
ΩΩ 
image
ΩΩ 
=
ΩΩ 
new
ΩΩ 
BitmapImage
ΩΩ '
(
ΩΩ' (
)
ΩΩ( )
;
ΩΩ) *
using
ææ 
(
ææ 
var
ææ 
mem
ææ 
=
ææ 
new
ææ  
MemoryStream
ææ! -
(
ææ- .

imageBytes
ææ. 8
)
ææ8 9
)
ææ9 :
{
øø 
mem
¿¿ 
.
¿¿ 
Position
¿¿ 
=
¿¿ 
$num
¿¿  
;
¿¿  !
image
¡¡ 
.
¡¡ 
	BeginInit
¡¡ 
(
¡¡  
)
¡¡  !
;
¡¡! "
image
¬¬ 
.
¬¬ 
CreateOptions
¬¬ #
=
¬¬$ %!
BitmapCreateOptions
¬¬& 9
.
¬¬9 :!
PreservePixelFormat
¬¬: M
;
¬¬M N
image
√√ 
.
√√ 
CacheOption
√√ !
=
√√" #
BitmapCacheOption
√√$ 5
.
√√5 6
OnLoad
√√6 <
;
√√< =
image
ƒƒ 
.
ƒƒ 
	UriSource
ƒƒ 
=
ƒƒ  !
null
ƒƒ" &
;
ƒƒ& '
image
≈≈ 
.
≈≈ 
StreamSource
≈≈ "
=
≈≈# $
mem
≈≈% (
;
≈≈( )
image
∆∆ 
.
∆∆ 
EndInit
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆  
}
«« 
image
»» 
.
»» 
Freeze
»» 
(
»» 
)
»» 
;
»» 
return
…… 
image
…… 
;
…… 
}
   	
}
ÀÀ 
}ÃÃ »
åC:\Users\Gabriela\Desktop\Rodrigo\5¬∞Semestre\Tecnolog√≠asParaLaConstruccion\GuessMyMessClientProyect\GuessMyMessClient\Model\AvatarModel.cs
	namespace		 	
GuessMyMessClient		
 
.		 
Model		 !
{

 
public 

class 
AvatarModel 
: 
ViewModelBase ,
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
byte 
[ 
] 
	ImageData 
{  !
get" %
;% &
set' *
;* +
}, -
public 
BitmapImage 
ImageSource &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
private 
bool 
_isSelected  
;  !
public 
bool 

IsSelected 
{ 	
get 
=> 
_isSelected 
; 
set 
{ 
_isSelected 
= 
value  %
;% &
OnPropertyChanged' 8
(8 9
)9 :
;: ;
}< =
} 	
} 
} 